import{j as o,a as C,F as ue}from"./@emotion-63839449.js";import{r as c}from"./react-4fd50329.js";import{I as $,l as D,b1 as ye,b0 as ge,an as ve,at as De,K as z}from"./index-c2ded735.js";import"./react-redux-896b353b.js";import"./lodash-88fe09e6.js";import"./moment-a468e1f9.js";import"./file-saver-40cf32a9.js";import"./@firebase-43527ee1.js";import{g as Fe,s as we}from"./buildingTemplate-dc865780.js";import{B as G}from"./index-881eef42.js";import{P as e}from"./prop-types-1172f4d5.js";import{a as be}from"./index-b17d22e5.js";import{I as H,b,R as K}from"./antd-f9eae174.js";import{u as Ce,d as Ie}from"./react-router-a4308f7b.js";import"./hoist-non-react-statics-23d96a9a.js";import"./react-is-e8e5dbb3.js";import"./@babel-b64fd0f9.js";import"./stylis-79144faa.js";import"./classnames-4ba1ba1a.js";import"./redux-10bbab4c.js";import"./react-router-dom-2a8f5f6d.js";import"./history-a1882333.js";import"./resolve-pathname-e210f2ac.js";import"./tiny-invariant-dd7d57d2.js";import"./react-dom-40621ea0.js";import"./scheduler-765c72db.js";import"./@redux-saga-8bafe09b.js";import"./redux-logger-e1c9ca90.js";import"./dompurify-8e338605.js";import"./query-string-f5cca1e7.js";import"./decode-uri-component-4138e85d.js";import"./split-on-first-4f1167c8.js";import"./filter-obj-2ed190f4.js";import"./oidc-client-7da0eaf7.js";import"./firebase-878887a2.js";import"./rc-pagination-c1e6a0ac.js";import"./rc-picker-2e3d5fe5.js";import"./rc-util-0bc219f3.js";import"./rc-trigger-570b13ec.js";import"./rc-motion-ae889c42.js";import"./rc-align-e5d7b12e.js";import"./dom-align-ecb06dd6.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./rc-resize-observer-b9ad4e29.js";import"./@ant-design-cba9d434.js";import"./@ctrl-fb5a5473.js";import"./rc-tabs-dfd19a56.js";import"./rc-dropdown-5378dd0a.js";import"./rc-menu-b15ebfe9.js";import"./rc-overflow-6be96612.js";import"./rc-select-564caf01.js";import"./rc-virtual-list-8a7b82a6.js";import"./rc-collapse-11b7d3c4.js";import"./shallowequal-4542d6f7.js";import"./rc-drawer-317f0b4d.js";import"./@rc-component-5a112e55.js";import"./rc-field-form-ef5549aa.js";import"./async-validator-dee29e8b.js";import"./scroll-into-view-if-needed-6b992d05.js";import"./compute-scroll-into-view-183f845a.js";import"./rc-image-e0357917.js";import"./rc-dialog-b1d1f07b.js";import"./rc-input-number-8bc068f7.js";import"./rc-rate-c64cf0d5.js";import"./rc-steps-2d1924c7.js";import"./rc-switch-b4e96de7.js";import"./rc-table-191ecc42.js";import"./rc-checkbox-018e8052.js";import"./rc-tree-67773537.js";import"./rc-tree-select-cb7eccc3.js";import"./copy-to-clipboard-64585c8c.js";import"./toggle-selection-93f4ad84.js";import"./rc-textarea-d01adcbb.js";import"./rc-input-02c2c2ba.js";import"./rc-upload-3ab0f08a.js";import"./rc-notification-d13dc43b.js";import"./rc-progress-4f1a7096.js";import"./rc-tooltip-08fa4217.js";import"./use-sync-external-store-5d1b6592.js";import"./idb-cdd1a92f.js";import"./path-to-regexp-ef8d5544.js";import"./account-86ffff50.js";import"./index-687ba9e6.js";import"./index-43183512.js";import"./libphonenumber-js-0d5a9c92.js";import"./react-infinite-scroll-component-e33646cb.js";const N=d=>{const{isShow:p,src:n,hideModal:m}=d;return o(be,{footer:null,open:p,onCancel:m,children:o(H,{src:n,height:"auto",style:{width:"100%",height:"auto",objectFit:"contain"},preview:!1})})};N.propTypes={isShow:e.bool,src:e.string,hideModal:e.func};N.defaultProps={isShow:!1,src:"",hideModal:()=>{}};function j(d){const{name:p,src:n,onClickUpdate:m,onClickView:f,isSelected:h,templatePermissionWrite:S}=d;return o(ue,{children:C("figure",{className:"upload__item",style:{textAlign:"center"},children:[C("label",{htmlFor:p,children:[o(H,{style:{maxWidth:"300px",border:`${h?"4px solid #3487cb":"1px solid #ddd"}`},src:n,width:"100%",height:"150px",preview:!1}),o("figcaption",{children:p})]}),C("div",{style:{height:"150px",display:"flex",justifyContent:"center",gap:"16px",alignItems:"center",position:"absolute",top:"0",left:"0",right:"0",bottom:"0"},children:[S?o($,{name:"icon-edit-outlined",style:{fontSize:"20px"},onClick:m,title:D.update}):null,o($,{name:"icon-eye-outlined",style:{fontSize:"20px"},onClick:f,title:D.illustration})]})]})})}j.propTypes={name:e.string,src:e.string,onClickUpdate:e.func,onClickView:e.func,isSelected:e.bool,templatePermissionWrite:e.bool};j.defaultProps={name:"",src:"",onClickUpdate:()=>{},onClickView:()=>{},isSelected:!1,templatePermissionWrite:!1};function F(d){const{title:p,options:n,selected:m,showFormDetail:f,showFormUpdate:h,templatePermissionWrite:S}=d,w=a=>()=>{f(a)},I=a=>()=>{h(a)};return C("div",{style:{textAlign:"center"},children:[o("div",{children:o("h2",{children:p})}),o(K,{gutter:[12,12],children:n.map(a=>o(b,{span:"24",children:o(j,{name:a.name,src:a.image,onClickUpdate:I(a.name),onClickView:w(a.image),isSelected:m?m.name===a.name:!1,templatePermissionWrite:S},a.name)},a.name))})]})}F.propTypes={title:e.string,options:e.arrayOf(e.any),selected:e.objectOf(e.any),showFormDetail:e.func,showFormUpdate:e.func,templatePermissionWrite:e.bool};F.defaultProps={title:"",options:[],selected:void 0,showFormDetail:()=>{},showFormUpdate:()=>{},templatePermissionWrite:!1};const L=d=>{const{invoiceSelected:p,receiptSelected:n,paySlipSelected:m,cardSelected:f,invoiceData:h,receiptData:S,paySlipData:w,cardData:I,formDetail:a,showFormDetail:u,hideFormDetail:P,showFormUpdate:y,showFormConfirmSelect:g,isFetching:x,templatePermissionWrite:v,smsInvoiceSelected:O,smsInvoiceData:U}=d;return x?o(ye,{width:"50px",height:"50px",isLoading:x}):C(G,{style:{flex:0},children:[o(G.Content,{children:C(K,{gutter:[12,48],children:[o(b,{span:"12",style:{textAlign:"center"},children:o(F,{title:D.label.invoice,selected:p,options:h,showFormDetail:u,type:"invoice",showFormUpdate:y,showFormConfirmSelect:g,templatePermissionWrite:v})}),o(b,{span:"12",style:{textAlign:"center"},children:o(F,{title:D.label.sms_invoice,selected:O,options:U,showFormDetail:u,type:"invoice",showFormUpdate:y,showFormConfirmSelect:g,templatePermissionWrite:v})}),o(b,{span:"12",children:o(F,{title:D.label.receipt,selected:n,options:S,showFormDetail:u,type:"receipt",showFormUpdate:y,showFormConfirmSelect:g,templatePermissionWrite:v})}),o(b,{span:"12",children:o(F,{title:D.label.pay_slip,selected:m,options:w,showFormDetail:u,type:"paySlip",showFormUpdate:y,showFormConfirmSelect:g,templatePermissionWrite:v})}),o(b,{span:"12",children:o(F,{title:D.label.card,selected:f,options:I,showFormDetail:u,type:"card",showFormUpdate:y,showFormConfirmSelect:g,templatePermissionWrite:v})})]})}),a.isShow&&o(N,{isShow:a.isShow,hideModal:P,src:a.data})]})};L.propTypes={invoiceSelected:e.objectOf(e.any),smsInvoiceSelected:e.objectOf(e.any),receiptSelected:e.objectOf(e.any),paySlipSelected:e.objectOf(e.any),cardSelected:e.objectOf(e.any),invoiceData:e.arrayOf(e.any),smsInvoiceData:e.arrayOf(e.any),receiptData:e.arrayOf(e.any),paySlipData:e.arrayOf(e.any),cardData:e.arrayOf(e.any),formDetail:e.objectOf(e.any),showFormDetail:e.func,hideFormDetail:e.func,showFormUpdate:e.func,showFormConfirmSelect:e.func,isFetching:e.bool,templatePermissionWrite:e.bool};L.defaultProps={invoiceSelected:void 0,smsInvoiceSelected:void 0,receiptSelected:void 0,paySlipSelected:void 0,cardSelected:void 0,invoiceData:[],smsInvoiceData:[],receiptData:[],paySlipData:[],cardData:[],formDetail:void 0,showFormDetail:()=>{},hideFormDetail:()=>{},showFormUpdate:()=>{},showFormConfirmSelect:()=>{},isFetching:!1,templatePermissionWrite:!1};function ro(){const d=Ce(),p=Ie(),{idBuilding:n}=d,{getPermissionByModuleCode:m}=ge(),[f,h]=c.useState({isFetching:!1}),[S,w]=c.useState({isFetching:!1,code:void 0,codeLanguage:void 0}),[I,a]=c.useState([]),[u,P]=c.useState([]),[y,g]=c.useState([]),[x,v]=c.useState([]),[O,U]=c.useState([]),[q,J]=c.useState({}),[Q,X]=c.useState({}),[Y,Z]=c.useState({}),[A,B]=c.useState({}),[ee,te]=c.useState({}),k=m(ve),oe=(k==null?void 0:k[De])??!1,[ie,ae,re]=z(),[se,ce,ne]=z();c.useEffect(()=>{(async()=>{var V,_,R;h({isFetching:!0});const l=await Fe({idBuilding:n}),{invoice:T=[],payslip:W=[],receipt:M=[],card:E=[]}=l.data,me=T.find(t=>t.isSelected),de=(_=(V=l==null?void 0:l.data)==null?void 0:V["sms-invoice"])==null?void 0:_.find(t=>t.isSelected),Se=W.find(t=>t.isSelected),he=M.find(t=>t.isSelected),fe=E.find(t=>t.isSelected);J(me),a(T.sort((t,i)=>{var r,s;return Number(((r=t==null?void 0:t.name)==null?void 0:r.replace("invoice-template-",""))??0)-Number(((s=i==null?void 0:i.name)==null?void 0:s.replace("invoice-template-",""))??0)})),X(de),P((R=l==null?void 0:l.data)==null?void 0:R["sms-invoice"].sort((t,i)=>{var r,s;return Number(((r=t==null?void 0:t.name)==null?void 0:r.replace("sms-invoice-template-",""))??0)-Number(((s=i==null?void 0:i.name)==null?void 0:s.replace("sms-invoice-template-",""))??0)})),B(Se),v(W.sort((t,i)=>{var r,s;return Number(((r=t==null?void 0:t.name)==null?void 0:r.replace("payslip-template-",""))??0)-Number(((s=i==null?void 0:i.name)==null?void 0:s.replace("payslip-template-",""))??0)})),Z(he),g(M.sort((t,i)=>{var r,s;return Number(((r=t==null?void 0:t.name)==null?void 0:r.replace("receipt-template-",""))??0)-Number(((s=i==null?void 0:i.name)==null?void 0:s.replace("receipt-template-",""))??0)})),te(fe),U(E.sort((t,i)=>{var r,s;return Number(((r=t==null?void 0:t.name)==null?void 0:r.replace("card-template-",""))??0)-Number(((s=i==null?void 0:i.name)==null?void 0:s.replace("card-template-",""))??0)})),h({isFetching:!1})})()},[]);async function le(l){w({isFetching:!0,code:void 0,codeLanguage:void 0});const T=await we({templates:[l],idBuilding:n});w({isFetching:!1,code:T.code,codeLanguage:T.codeLanguage})}const pe={idBuilding:n,invoiceSelected:q,smsInvoiceSelected:Q,receiptSelected:Y,paySlipSelected:A,cardSelected:ee,invoiceData:I,smsInvoiceData:u,receiptData:y,paySlipData:x,cardData:O,showFormUpdate:l=>{p.push(`/buildings/${n}/configs-templates/${l}`)},formDetail:ie,showFormDetail:ae,hideFormDetail:re,onClickSave:le,formConfirmSelect:se,showFormConfirmSelect:ce,hideFormConfirmSelect:ne,isFetching:f.isFetching,isFetchingTemplateSave:S.isFetching,codeTemplateSave:S.code,codeLanguageTemplateSave:S.codeLanguage,templatePermissionWrite:oe};return o(L,{...pe})}export{ro as default};
