import{j as s,a as R,u as tt,c as de,b as st,F as Ie}from"./@emotion-63839449.js";import{d as at,P as K,Q as Ae,T as Gt,w as jt,l as me,D as Fe,a as Se,C as Dt,j as zt}from"./index-b17d22e5.js";import{l as le}from"./lodash-88fe09e6.js";import{h as E}from"./moment-a468e1f9.js";import{l as r,by as nt,a9 as V,s as j,b0 as Wt,K as ue,aP as ot,ax as Kt,at as je,bv as Qt,ar as Xt,ag as De,aN as Zt,g as it,t as Jt,gw as es,gx as ts,a1 as rt,gk as ss,I as U,gy as as,a as ve,b1 as Oe,gz as ns,gA as os,D as dt,x as He,S as ie,gB as is,gC as rs,gD as ds,dk as cs,a3 as ls,dq as us,a5 as ps,gE as gs,gn as ms,gF as fs,gG as hs,n as xs,gH as Ss}from"./index-c2ded735.js";import"./file-saver-40cf32a9.js";import{r as p}from"./react-4fd50329.js";import{P as A}from"./prop-types-1172f4d5.js";import{F as W,u as _e}from"./index-687ba9e6.js";import"./react-redux-896b353b.js";import"./@firebase-43527ee1.js";import{u as vs,d as _s}from"./react-router-a4308f7b.js";import{L as ws}from"./react-router-dom-2a8f5f6d.js";import{B as fe}from"./index-881eef42.js";import{B as re,w as oe,L as ys,g as ze,T as te,r as We,D as Te,K as ct,b as se,j as lt,R as he,I as we,A as Ls,h as Rs,E as Ke,q as Cs,S as bs,n as Es,P as Ms}from"./antd-f9eae174.js";import{I as xe,S as P}from"./index-43183512.js";import{M as As,a as ye,b as ut,c as Hs,d as Ts,e as Ps,f as Is}from"./chat-dae5776c.js";import{I as Fs}from"./react-infinite-scroll-component-e33646cb.js";import"./parser-56b7e8bd.js";import{P as Os}from"./parse-6fcf23d5.js";import{g as Ns}from"./department-807891d3.js";import{g as ks}from"./staff-2880022d.js";import{e as qs}from"./exportExcel-837be6ed.js";import{u as Ys}from"./useQuery-d54d310a.js";import{g as Bs}from"./helpDeskType-5f91feef.js";import"./hoist-non-react-statics-23d96a9a.js";import"./react-is-e8e5dbb3.js";import"./@babel-b64fd0f9.js";import"./stylis-79144faa.js";import"./account-86ffff50.js";import"./libphonenumber-js-0d5a9c92.js";import"./classnames-4ba1ba1a.js";import"./redux-10bbab4c.js";import"./react-dom-40621ea0.js";import"./scheduler-765c72db.js";import"./@redux-saga-8bafe09b.js";import"./redux-logger-e1c9ca90.js";import"./dompurify-8e338605.js";import"./query-string-f5cca1e7.js";import"./decode-uri-component-4138e85d.js";import"./split-on-first-4f1167c8.js";import"./filter-obj-2ed190f4.js";import"./oidc-client-7da0eaf7.js";import"./firebase-878887a2.js";import"./history-a1882333.js";import"./resolve-pathname-e210f2ac.js";import"./tiny-invariant-dd7d57d2.js";import"./rc-pagination-c1e6a0ac.js";import"./rc-picker-2e3d5fe5.js";import"./rc-util-0bc219f3.js";import"./rc-trigger-570b13ec.js";import"./rc-motion-ae889c42.js";import"./rc-align-e5d7b12e.js";import"./dom-align-ecb06dd6.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./rc-resize-observer-b9ad4e29.js";import"./@ant-design-cba9d434.js";import"./@ctrl-fb5a5473.js";import"./rc-tabs-dfd19a56.js";import"./rc-dropdown-5378dd0a.js";import"./rc-menu-b15ebfe9.js";import"./rc-overflow-6be96612.js";import"./rc-select-564caf01.js";import"./rc-virtual-list-8a7b82a6.js";import"./rc-collapse-11b7d3c4.js";import"./shallowequal-4542d6f7.js";import"./rc-drawer-317f0b4d.js";import"./@rc-component-5a112e55.js";import"./rc-field-form-ef5549aa.js";import"./async-validator-dee29e8b.js";import"./scroll-into-view-if-needed-6b992d05.js";import"./compute-scroll-into-view-183f845a.js";import"./rc-image-e0357917.js";import"./rc-dialog-b1d1f07b.js";import"./rc-input-number-8bc068f7.js";import"./rc-rate-c64cf0d5.js";import"./rc-steps-2d1924c7.js";import"./rc-switch-b4e96de7.js";import"./rc-table-191ecc42.js";import"./rc-checkbox-018e8052.js";import"./rc-tree-67773537.js";import"./rc-tree-select-cb7eccc3.js";import"./copy-to-clipboard-64585c8c.js";import"./toggle-selection-93f4ad84.js";import"./rc-textarea-d01adcbb.js";import"./rc-input-02c2c2ba.js";import"./rc-upload-3ab0f08a.js";import"./rc-notification-d13dc43b.js";import"./rc-progress-4f1a7096.js";import"./rc-tooltip-08fa4217.js";import"./use-sync-external-store-5d1b6592.js";import"./idb-cdd1a92f.js";import"./path-to-regexp-ef8d5544.js";import"./xlsx-0fb7ed70.js";const Ne={code:void 0,title:void 0,unitId:void 0,labelId:"",helpDeskTypeId:"",ratedStatus:"",expiredStatus:"",messageStatus:"",createdAt:[]},k="NEW",Z="APPROVED",Q="COMPLETED",pe="RATED",pt=[{value:k,label:r.waiting_approve,color:"#f50",icon:"minus-circle"},{value:Z,label:r.processing,color:"#0530AD",icon:"sync-alt"},{value:Q,label:r.complete,color:"#87d068",icon:"check"},{value:pe,label:r.complete,color:"#87d068",icon:"check"}],gt="NOTICE_HELPDESK_EST_COMPLETE_TIME",mt="NOTICE_HELPDESK_COMPLETED",ft="HELPDESK_RATED",z=nt(pt,"value"),ht="NOT_STARTED",xt="IN_PROGRESS",Us="ON_HOLD",$s="COMPLETED",Vs="CANCELLED",Gs=[{value:ht,label:r.not_start,color:"default"},{value:xt,label:r.in_progress,color:"processing"},{value:Us,label:r.on_hold,color:"warning"},{value:$s,label:r.completed,color:"success"},{value:Vs,label:r.canceled,color:"error"}],Qe=nt(Gs,"value"),St="EXPIRED",vt="NOT_EXPIRED",Ce=[{id:St,name:r.expired1},{id:vt,name:r.not_expired}],_t="RATED",wt="NOT_RATED",be=[{id:wt,name:r.not_rated},{id:_t,name:r.rated}],yt="UNREAD",Ee=[{id:yt,name:r.label.unread}],Le="createdAt-desc",B=p.createContext({idBuilding:0,apartments:[],setApartments:()=>{},getApartmentStatus:{isFetching:!1},setGetApartmentStatus:()=>{},filter:{...Ne},setFilter:()=>{},tableData:{records:[],totalRecord:0},setTableData:()=>{},status:k,setStatus:()=>{},getListHelpDeskStatus:{isFetching:!1},setGetListHelpDeskStatus:()=>{},listLabel:[],setListLabel:()=>{},formFilter:void 0,helpDeskPermissionApprove:!1,helpDeskPermissionWrite:!1,helpDeskTypePermissionRead:!1,taskPermissionRead:!1,taskPermissionWrite:!1,taskPermissionExport:!1,tablePagination:{current:V,limit:j},setTablePagination:()=>{},getsStatus:{isFetching:!1},setGetsStatus:()=>{},visibleRequestListOverlay:{data:{},flag:!1},setVisibleRequestListOverlay:()=>{},getListRequestStatus:{isFetching:!1},setGetListRequestStatus:()=>{},listRequest:[],setListRequest:()=>{},listHelpDeskType:[],setListHelpDeskType:()=>{},drawerHelpDeskInfo:{isShow:!1,data:{}},sortString:Le,setSortString:()=>{},showDrawerHelpDeskInfo:()=>{},hideDrawerHelpDeskInfo:()=>{},modalCompleteHelpDesk:{isShow:!1,data:{}},showModalCompleteHelpDesk:()=>{},hideModalCompleteHelpDesk:()=>{},modalAddRequest:{isShow:!1,data:{}},showModalAddRequest:()=>{},hideModalAddRequest:()=>{},modalApproveHelpDesk:void 0,showModalApproveHelpDesk:()=>{},hideModalApproveHelpDesk:()=>{},modalExportHelpDesk:void 0,showModalExportHelpDesk:()=>{},hideModalExportHelpDesk:()=>{}}),ke=({children:e})=>{const{idBuilding:a}=vs(),[t]=W.useForm(),[n,d]=p.useState({...Ne}),[c,m]=p.useState(k),[u,l]=p.useState({records:[],totalRecord:0}),[f,g]=p.useState([]),[i,v]=p.useState([]),[x,w]=p.useState(Le),[h,C]=p.useState({isFetching:!1}),[y,H]=p.useState({data:{},flag:!1}),{getPermissionByModuleCode:M}=Wt(),[L,S,o]=ue(),[_,T,F]=ue(),[I,q,O]=ue(),[ee,Y,D]=ue(),[b,N,G]=ue(),[$,X]=p.useState({current:V,limit:j}),[ce,Mt]=p.useState({isFetching:!1}),[At,Ht]=p.useState([]),[Tt,Pt]=p.useState([]),[It,Ft]=p.useState({isFetching:!1}),[Ot,Nt]=p.useState({isFetching:!1}),J=M(ot),kt=(J==null?void 0:J[Kt])??!1,qt=(J==null?void 0:J[je])??!1,Yt=(J==null?void 0:J[Qt])??!1,Re=M(Xt),Bt=(Re==null?void 0:Re[De])??!1,ne=M(Zt),Ut=(ne==null?void 0:ne[De])??!1,$t=(ne==null?void 0:ne[je])??!1,Vt={idBuilding:a,apartments:At,setApartments:Ht,formFilter:t,filter:n,setFilter:d,status:c,setStatus:m,tableData:u,setTableData:l,getListHelpDeskStatus:h,setGetListHelpDeskStatus:C,listLabel:f,setListLabel:g,helpDeskPermissionApprove:kt,helpDeskPermissionWrite:qt,helpDeskTypePermissionRead:Bt,taskPermissionRead:Ut,taskPermissionWrite:$t,taskPermissionExport:Yt,tablePagination:$,setTablePagination:X,getsStatus:ce,setGetsStatus:Mt,getApartmentStatus:It,setGetApartmentStatus:Ft,visibleRequestListOverlay:y,setVisibleRequestListOverlay:H,getListRequestStatus:Ot,setGetListRequestStatus:Nt,listRequest:Tt,setListRequest:Pt,listHelpDeskType:i,setListHelpDeskType:v,drawerHelpDeskInfo:L,sortString:x,setSortString:w,showDrawerHelpDeskInfo:S,hideDrawerHelpDeskInfo:o,modalCompleteHelpDesk:_,showModalCompleteHelpDesk:T,hideModalCompleteHelpDesk:F,modalAddRequest:I,showModalAddRequest:q,hideModalAddRequest:O,modalApproveHelpDesk:ee,showModalApproveHelpDesk:Y,hideModalApproveHelpDesk:D,modalExportHelpDesk:b,showModalExportHelpDesk:N,hideModalExportHelpDesk:G};return s(B.Provider,{value:Vt,children:e})};ke.propTypes={children:A.node};ke.defaultProps={children:s("div",{})};const js=ke,Lt=(e,a)=>{var n,d,c,m,u,l,f,g,i,v,x,w,h,C;let t=!1;return(e==null?void 0:e.status)===Z&&(t=E(e==null?void 0:e.estCompleteAt).isBefore(E(),"minutes")),[Q,pe].includes(e==null?void 0:e.status)&&(t=E(e==null?void 0:e.estCompleteAt).isBefore(E(e==null?void 0:e.completedAt),"minutes")),{...e,id:e.id,key:e.id,code:e.code,images:e.images,createdAt:e.createdAt?E(e.createdAt).format("DD/MM/YYYY HH:mm"):"",approvedAt:e.approvedAt?E(e.approvedAt).format("DD/MM/YYYY HH:mm"):"",completedAt:e.completedAt?E(e.completedAt).format("DD/MM/YYYY HH:mm"):"",estCompleteAt:e.estCompleteAt?E(e.estCompleteAt).format("DD/MM/YYYY HH:mm"):"",idRoom:e.roomId,status:e.status,title:e.title,unit:{id:(n=e==null?void 0:e.unit)==null?void 0:n.id,name:(d=e==null?void 0:e.unit)==null?void 0:d.name},resident:{id:((c=e==null?void 0:e.resident)==null?void 0:c.id)||e.residentId,name:a?"***":(m=e==null?void 0:e.resident)==null?void 0:m.fullName},residentName:a?"***":(u=e==null?void 0:e.resident)==null?void 0:u.fullName,approverName:a?"***":((l=e==null?void 0:e.approved)==null?void 0:l.fullName)??"",unitName:(f=e==null?void 0:e.unit)==null?void 0:f.name,idUser:e==null?void 0:e.userId,isHaveNewMessage:!1,label:e==null?void 0:e.label,helpDeskType:it()===Jt?(i=(g=e==null?void 0:e.helpDeskType)==null?void 0:g.name)==null?void 0:i.vi:(x=(v=e==null?void 0:e.helpDeskType)==null?void 0:v.name)==null?void 0:x.en,ratingPoint:(e==null?void 0:e.ratingPoint)||void 0,ratingComment:(e==null?void 0:e.ratingComment)||void 0,ratingAt:e!=null&&e.ratingAt?E(e.ratingAt).format("DD/MM/YYYY HH:mm"):"",isExpired:t,statusLabel:e.status?(w=z[e.status])==null?void 0:w.label:"",statusColor:e.status?(h=z[e.status])==null?void 0:h.color:"",numberUnfinishedTask:e!=null&&e.requests?(C=e==null?void 0:e.requests)==null?void 0:C.length:0}},Rt=async({idBuilding:e,filter:a,page:t,limit:n,isUserCs:d})=>{try{const{unitId:c,status:m,labelId:u,code:l,title:f,sort:g,ratedStatus:i,expiredStatus:v,helpDeskTypeId:x,messageStatus:w,createdAt:h}=a,C=i===_t?!0:i===wt?!1:void 0,y=v===St?!0:v===vt?!1:void 0,H=h==null?void 0:h[0],M=h==null?void 0:h[1],L=await es({idBuilding:e,filter:{unitId:c||void 0,code:l||void 0,status:m||"",labelId:u||void 0,title:f||void 0,sort:g||void 0,isStatusHelpDeskRated:C,isExpired:y,helpDeskTypeId:x||void 0,isUnread:w===yt||void 0,from:H?E(H).toDate():void 0,to:M?E(M).toDate():void 0},page:t,limit:n});return{code:L.code,codeLanguage:L.codeLanguage,data:L.data.map(S=>Lt(S,d)),totalRecord:L.totalRecord}}catch(c){return{code:c.code,codeLanguage:c.codeLanguage,data:[],totalRecord:0}}},Ds=e=>({id:e.roomId,isHaveNewMessage:!!e.unread,unReadNumber:Number(e.unread||0)}),zs=async(e,a)=>{try{const t=await ts(e,a);return{code:t.code,codeLanguage:t.codeLanguage,data:t.data.reduce((n,d)=>{const c=Ds(d);return n[c.id]={unReadNumber:c.unReadNumber},n},{})}}catch(t){return{code:t.code,codeLanguage:t.codeLanguage,data:{}}}},ae=()=>{const{setTableData:e,setGetListHelpDeskStatus:a}=p.useContext(B),{isUserCs:t}=rt();return[async({filter:d,limit:c,page:m,idBuilding:u,sort:l=Le})=>{var x,w;a({isFetching:!0});const f=await Rt({filter:{...d,sort:l},idBuilding:u,limit:c,page:m,isUserCs:t}),g=f.data.map(h=>h.idRoom),i=await zs(u,g),v=[...f.data];for(let h=0;h<v.length;h+=1)v[h].unReadNumber=((w=i==null?void 0:i.data[(x=v[h])==null?void 0:x.idRoom])==null?void 0:w.unReadNumber)||0;return e({records:v??[],totalRecord:f==null?void 0:f.totalRecord}),a({isFetching:!1}),f}]},Ws=()=>{const{filter:e,idBuilding:a,setTablePagination:t,status:n,setStatus:d}=p.useContext(B),[c]=ae(),m=async u=>{u!==n&&(t({current:V,limit:j}),d(u),await c({filter:{...e,status:u},limit:j,page:V,idBuilding:a}))};return{tabs:pt.filter(u=>u.value!==pe),onTabChange:m,activeKey:n}},Ks=()=>{const{tabs:e,activeKey:a,onTabChange:t}=Ws();return s(K.Tabs,{activeKey:a,onTabChange:at(t,200),tabs:e})},Qs=e=>({id:e.id,code:e.code,status:e.progressStatus}),qe=async(e,a)=>{try{const t=await ss({filter:{helpDeskId:a},idBuilding:e});return{code:t.code,codeLanguage:t.codeLanguage,data:t.data.map(n=>Qs(n))}}catch(t){return{code:t.code,codeLanguage:t.codeLanguage,data:[]}}},Xs=()=>{const{idBuilding:e,visibleRequestListOverlay:a,showModalAddRequest:t,setVisibleRequestListOverlay:n,getListRequestStatus:d,setGetListRequestStatus:c,listRequest:m,setListRequest:u}=p.useContext(B),{id:l,status:f}=a==null?void 0:a.data;p.useEffect(()=>{(async()=>{c({isFetching:!0});const i=await qe(e,l);u(i.data),c({isFetching:!1})})()},[]);const g=()=>{t(),n({...a,flag:!1})};return{isFetchingListRequest:d.isFetching,idBuilding:e,helpDeskStatus:f,listRequest:m,handleShowModalAddRequest:g}};var Zs={name:"1x7lxj3",styles:"width:300px;min-height:180px;max-height:300px;box-shadow:0 3px 6px -4px rgb(0 0 0 / 12%), 0 6px 16px 0 rgb(0 0 0 / 8%), 0 9px 28px 8px rgb(0 0 0 / 5%);border-radius:2px"},Js={name:"82a6rk",styles:"flex:1"};const Ct=()=>{const{isFetchingListRequest:e,idBuilding:a,helpDeskStatus:t,listRequest:n,handleShowModalAddRequest:d}=Xs();return s(ys,{css:Zs,children:R(fe,{css:Js,children:[R(fe.Header,{children:[s("h3",{children:r.task_list}),t===Z?s(re,{onClick:d,block:!0,type:"primary",icon:s(U,{name:"plus"}),children:r.add}):null]}),s(fe.Content,{scrollY:!0,children:s(Ae,{loading:e,dataSource:e?[]:n,renderItem:c=>R("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:6},children:[s(ws,{target:"_blank",to:`/buildings/${a}/task/${c.id}`,children:c.code}),s(oe,{color:Qe[c.status].color,children:Qe[c.status].label})]})})})]})})},ea=async(e,a,t)=>{try{const d=await as(e,a,{labelId:t||null});return{code:d.code,codeLanguage:d.codeLanguage}}catch(n){return{code:n.code,codeLanguage:n.codeLanguage}}},ta=()=>{const{layoutScrollRef:e}=p.useContext(ve),a=tt(),{idBuilding:t,tableData:n,setTableData:d,filter:c,showModalCompleteHelpDesk:m,tablePagination:u,status:l,setTablePagination:f,showDrawerHelpDeskInfo:g,listLabel:i,visibleRequestListOverlay:v,setVisibleRequestListOverlay:x,getListHelpDeskStatus:w,helpDeskPermissionApprove:h,taskPermissionRead:C,showModalApproveHelpDesk:y,helpDeskTypePermissionRead:H,setSortString:M}=p.useContext(B),[L]=ae(),[S,o]=p.useState({isFetching:!1,code:void 0,codeLanguage:void 0});_e(S.code,S.codeLanguage,{message:r.success,description:r.update_label_help_desk_success});const _=async b=>{const N=[...n==null?void 0:n.records];for(let G=0;G<N.length;G+=1)if(N[G].id===b.id){N[G].unReadNumber=0;break}d({records:N??[],totalRecord:n==null?void 0:n.totalRecord}),g(b)},T=b=>{m({id:b==null?void 0:b.id})},F=(b,N)=>{x({flag:b,data:N})},I=async(b,N,G)=>{let{current:$,limit:X}=u;b!==$&&($=b),N!==X&&(X=N,$=V),f({current:$,limit:X}),await L({filter:{...c,status:l},limit:X,page:$,idBuilding:t,sort:G})},q={pageSize:u.limit,defaultCurrent:V,current:u.current,total:n==null?void 0:n.totalRecord,showQuickJumper:!0,showSizeChanger:!0},O={offsetScroll:a.offsetScrollX,getContainer:()=>e.current},ee=async(b,N)=>{const G=Number(b);o({isFetching:!0,code:void 0,codeLanguage:void 0});const $=await ea(t,N==null?void 0:N.id,G);await L({filter:{...c,status:l},limit:u.limit,page:u.current,idBuilding:t}),o({isFetching:!1,code:$.code,codeLanguage:$.codeLanguage})},Y=async(b,N,G)=>{const{field:$,order:X}=G;let ce=Le;$&&X&&(ce=$&&X?`${$}-${X==="ascend"?"asc":"desc"}`:void 0,M(ce)),I(b.current,b.pageSize,ce)},D=b=>{y(b)};return{status:l,helpDeskTablePagination:q,handleVisibleRequestListOverlay:F,sticky:O,handleShowHelpDeskInfo:_,dataSource:n==null?void 0:n.records,listLabel:i,handleShowModalCompleteHelpDesk:T,onClickMenuItem:ee,loading:w==null?void 0:w.isFetching,isShowListRequestDropDown:v==null?void 0:v.flag,helpDeskPermissionApprove:h,taskPermissionRead:C,onTableChange:Y,handleShowModalApproveHelpDesk:D,tablePagination:u,helpDeskTypePermissionRead:H}};var sa={name:"6wlkoz",styles:".unSendMessage{background-color:#f0f5fe;&>.ant-table-cell-row-hover{background-color:#f0f5fe!important;}& .ant-table-cell-fix-left-last,& .ant-table-cell-fix-right-first{background-color:#f0f5fe;}}"},aa={name:"1xz4zz1",styles:"display:flex;justify-content:space-between;gap:8px"},na={name:"1vhvufq",styles:"width:calc(100% - 22px);max-width:140px"},oa={name:"1vhvufq",styles:"width:calc(100% - 22px);max-width:140px"},ia={name:"18ghf8r",styles:"cursor:pointer;display:flex;justify-content:space-between"},ra={name:"o2d6zf",styles:"display:flex;flex-direction:row;align-items:center;justify-content:center"};const da=()=>{const{status:e,handleShowHelpDeskInfo:a,handleVisibleRequestListOverlay:t,dataSource:n,listLabel:d,helpDeskTablePagination:c,sticky:m,handleShowModalCompleteHelpDesk:u,onClickMenuItem:l,isShowListRequestDropDown:f,loading:g,helpDeskPermissionApprove:i,taskPermissionRead:v,onTableChange:x,handleShowModalApproveHelpDesk:w,tablePagination:h,helpDeskTypePermissionRead:C}=ta(),y=de(re,{target:"evub3ld0"})({name:"192s9p1",styles:"display:flex;flex-direction:row;justify-content:center;align-items:center"}),H=p.useMemo(()=>S=>s(ze,{onClick:({key:o})=>l(o,S),style:{maxWidth:"200px"},children:d==null?void 0:d.map((o,_)=>{var T;return s(ze.Item,{children:R("div",{css:aa,children:[((T=o==null?void 0:o.title)==null?void 0:T.length)>=20?s(te,{placement:"top",title:o==null?void 0:o.title,children:s(oe,{color:(o==null?void 0:o.color)??"default",css:na,children:le.truncate(o.title,{length:20})})}):s(oe,{color:(o==null?void 0:o.color)??"default",css:oa,children:o.title}),s(U,{css:F=>{var I;return{visibility:((I=S==null?void 0:S.label)==null?void 0:I.id)===o.id?"visible":"hidden",color:F.color.primary}},name:"icon-check-outlined"})]})},o==null?void 0:o.id)})}),[d,e,h]),M=[{title:r.help_desk_code,key:"code",dataIndex:"code",width:180,fixed:"left",render:(S,o)=>s("div",{children:R(re,{type:"link",onClick:()=>a(o),style:{display:"flex",alignItems:"center",gap:Number(o==null?void 0:o.unReadNumber)<100?"10px":"12px"},children:[s(We,{count:o!=null&&o.unReadNumber?s("div",{style:{fontSize:"10px",background:"red",borderRadius:"100%",color:"white",padding:"2px 4px",border:"1px solid #ffffff"},children:Number(o==null?void 0:o.unReadNumber)<100?o==null?void 0:o.unReadNumber:"99+"}):null,offset:[-2,6],size:"small",children:s(U,{name:"icon-chat-outlined",css:_=>({fontSize:"20px",color:_.color.primary})})}),o==null?void 0:o.code]})})},e!==k?{title:r.expired_status,key:"expiredStatus",width:140,render:(S,o)=>s(oe,{color:o!=null&&o.isExpired?"error":"default",children:o!=null&&o.isExpired?r.expired:r.not_expired})}:null,{title:r.content,key:"title",dataIndex:"title",width:300,render:(S,o)=>s(te,{placement:"topLeft",title:S,children:le.truncate(S,{length:120})})},{title:r.unit,key:"unitName",dataIndex:"unitName",width:150,render:(S,o)=>s(te,{placement:"topLeft",title:S,children:le.truncate(S,{length:120})})},{title:r.resident,key:"residentName",dataIndex:"residentName",width:150},{title:r.label1,key:"label",dataIndex:"label",width:200,render:(S,o)=>{var _,T;return i||o!=null&&o.label?s(Te,{trigger:["click"],disabled:!i,dropdownRender:()=>H(o),allowClear:!0,children:R(oe,{css:ia,color:((_=o==null?void 0:o.label)==null?void 0:_.color)??"default",children:[o!=null&&o.label?le.truncate((T=o==null?void 0:o.label)==null?void 0:T.title,{length:20}):r.update_label_help_desk,s(U,{name:"icon-arrow-down-outlined"})]})}):null}},C?{title:r.help_desk_type,key:"helpDeskType",dataIndex:"helpDeskType",width:200}:null,{title:r.label.created_at,key:"createdAt",dataIndex:"createdAt",width:150,sorter:!0},e!==k?{title:r.deadline,key:"estCompleteAt",dataIndex:"estCompleteAt",width:150,sorter:!0}:null,e!==k?{title:r.label.approval_date,key:"approvedAt",dataIndex:"approvedAt",width:150}:null,e!==k?{title:r.approver,key:"approverName",dataIndex:"approverName",width:150}:null,e===Q?{title:r.label.finish_day,key:"completedAt",dataIndex:"completedAt",width:150}:null,e===Q?{title:r.label.rating,key:"ratingPoint",dataIndex:"ratingPoint",width:150,render:(S,o)=>o!=null&&o.ratingPoint?s(ct,{allowHalf:!0,disabled:!0,defaultValue:Number(o==null?void 0:o.ratingPoint)}):null}:null,e===Q?{title:r.rating_comment,key:"ratingComment",dataIndex:"ratingComment",width:250,render:(S,o)=>s(te,{placement:"topLeft",title:S,children:le.truncate(S,{length:120})})}:null,{title:r.action,key:"action",dataIndex:"action",width:150,align:"center",fixed:"right",render:(S,o)=>R(se,{css:ra,children:[Z!=null&&Z.includes(e)&&i?s(U,{title:r.complete,onClick:()=>u(o),name:"icon-check-outlined",css:_=>({marginRight:_.margin.sm,fontSize:_.iconSize})}):null,!(k!=null&&k.includes(e))&&v?s(We,{count:o!=null&&o.numberUnfinishedTask?s("div",{style:{fontSize:"10px",background:"red",borderRadius:"100%",color:"white",padding:"2px 4px",border:"1px solid #ffffff"},children:Number(o==null?void 0:o.numberUnfinishedTask)<100?o==null?void 0:o.numberUnfinishedTask:"99+"}):null,offset:[-2,6],size:"small",children:s(te,{title:r.task,children:s(Te,{trigger:["click"],onOpenChange:_=>t(_,o),dropdownRender:()=>f?s(Ct,{}):"",children:s(y,{shape:"circle",icon:s(U,{name:"icon-list-alt-outlined"})})})})}):null,k!=null&&k.includes(e)&&i?s(U,{title:r.accept,onClick:()=>w(o),name:"icon-check-outlined",css:_=>({marginRight:_.margin.sm,fontSize:_.iconSize})}):null]})}].filter(Boolean),L={x:M.reduce((S,o)=>o+S.width,0),scrollToFirstRowOnChange:!0};return s(Gt,{columns:M,loading:g,dataSource:n,rowKey:"key",sticky:m,scroll:L,pagination:c,rowClassName:S=>S!=null&&S.unReadNumber?"unSendMessage":"",css:sa,onChange:x,locale:{triggerAsc:r.click_to_sort,triggerDesc:r.ascending_order,cancelSort:r.descending_order}})},ge=p.createContext({messages:[],setMessages:()=>{},helpDeskDetailInfo:{},setHelpDeskDetailInfo:()=>{}}),Ye=({children:e})=>{const[a,t]=p.useState([]),[n,d]=p.useState({}),c={messages:a,setMessages:t,helpDeskDetailInfo:n,setHelpDeskDetailInfo:d};return s(ge.Provider,{value:c,children:e})};Ye.propTypes={children:A.node};Ye.defaultProps={children:s("div",{})};const ca=()=>{const{showModalCompleteHelpDesk:e,setVisibleRequestListOverlay:a,visibleRequestListOverlay:t,taskPermissionRead:n,helpDeskPermissionApprove:d}=p.useContext(B),{helpDeskDetailInfo:c}=p.useContext(ge),m=g=>{e(g)},u=(g,i)=>{a({flag:g,data:i})},l=p.useMemo(()=>(c==null?void 0:c.status)===Z,[c==null?void 0:c.status]),f=p.useMemo(()=>c.status===k,[c==null?void 0:c.status]);return{helpDesk:c,handleShowModalCompleteHelpDesk:m,handleVisibleRequestListOverlay:u,isShowListRequestDropDown:t==null?void 0:t.flag,taskPermissionRead:n,helpDeskPermissionApprove:d,isStatusHelpDeskApproved:l,isStatusHelpDeskNew:f}},Xe=de(re,{target:"e1st1ko90"})({name:"192s9p1",styles:"display:flex;flex-direction:row;justify-content:center;align-items:center"});var la={name:"sa5vmw",styles:"width:100%;display:flex;flex-direction:column;justify-content:center;position:relative"},ua={name:"1ce4si3",styles:"font-size:12px;min-height:1.5em;margin-top:8px"};const pa=()=>{var h,C;const{helpDesk:e,handleShowModalCompleteHelpDesk:a,handleVisibleRequestListOverlay:t,isShowListRequestDropDown:n,taskPermissionRead:d,helpDeskPermissionApprove:c,isStatusHelpDeskNew:m,isStatusHelpDeskApproved:u}=ca(),{status:l,title:f,code:g,unit:i,estCompleteAt:v,label:x,helpDeskType:w}=e;return s(he,{gutter:[12,0],style:{borderLeft:`6px solid ${(h=z==null?void 0:z[l])==null?void 0:h.color}`},children:R(se,{flex:"1 0 0",css:la,children:[R("div",{children:[R("h4",{css:y=>({color:y.color.link,wordBreak:"keep-all",margin:0,fontWeight:y.fontWeight.bold,display:"flex",gap:"8px",paddingRight:"80px",flexDirection:"column"}),children:[R("div",{children:[g," - ",i==null?void 0:i.name]}),s("div",{children:x?s(oe,{color:(x==null?void 0:x.color)??"default",children:x==null?void 0:x.title}):null})]}),s("div",{css:ua,children:w??""}),R("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",position:"absolute",top:0,right:0},children:[u&&c?s(te,{title:r.complete,children:s(Xe,{css:y=>({marginRight:y.margin.sm}),shape:"circle",icon:s(U,{name:"icon-check-outlined"}),onClick:()=>{a(e)}})}):null,!m&&d?s(te,{title:r.task,children:s(Te,{trigger:["click"],onOpenChange:y=>t(y,e),dropdownRender:()=>n?s(Ct,{}):"",children:s(Xe,{shape:"circle",icon:s(U,{name:"icon-list-alt-outlined"})})})}):null]})]}),R("div",{children:[s(lt,{style:{marginTop:"4px",marginBottom:"6px"}}),s("p",{css:y=>({whiteSpace:"normal",overflow:"hidden",textOverflow:"ellipsis",width:"100%",color:y.textColor,margin:`${y.margin.xss}px 0 0 0`}),children:f||"-"}),R("h5",{css:y=>({color:y.disabledColor,margin:`${y.margin.xss}px 0 0 0`}),children:[r.deadline,": ",v??"-"]}),R("h5",{css:y=>({color:y.disabledColor,margin:0}),children:[r.label.status,":"," ",s("span",{css:y=>{var H;return{color:`${(H=z==null?void 0:z[l])==null?void 0:H.color}`,margin:0,fontWeight:"bold"}},children:(C=z==null?void 0:z[l])==null?void 0:C.label})]})]})]})})};var ga={name:"m8bbtt",styles:"height:100px;width:112px;position:relative;&:hover .image-remove-icon{display:block;}"},ma={name:"16t7yfy",styles:"z-index:1;position:absolute;top:-13px;right:-8px;display:none;line-height:0;cursor:pointer;background-color:#42c39a;padding:1px 5px 0;border-radius:50%"};const Be=({onInputMessageChange:e,handleSendMessage:a,message:t,mediaList:n,handleRemoveMedia:d,handleUploadMedia:c,loadingMediaList:m,sendMessageBoxRef:u,onFocusSendMessageBox:l})=>{const f=()=>{a()},g=i=>{!i.shiftKey&&(i.key==="Enter"||i.keyCode===13)&&(i.preventDefault(),a())};return R("div",{children:[s(xe.TextArea,{ref:u,onChange:e,css:i=>st("border:0px;border-top-left-radius:",i.borderRadius,"px;border-top-right-radius:",i.borderRadius,"px;&:focus{outline:0;box-shadow:none;}",""),autoSize:{minRows:2,maxRows:6},onKeyUp:g,onPressEnter:g,onFocus:l,placeholder:r.message,value:t,maxLength:As}),n.length?s(he,{gutter:[12,12],css:i=>({padding:i.padding.xs}),children:n.map((i,v)=>{var x,w;return R(se,{css:ga,children:[s(Oe,{isLoading:i.status==="uploading"}),s("div",{className:"image-remove-icon",css:ma,children:s(U,{name:"icon-close-outlined",onClick:()=>d(i)})}),s(we,{css:h=>({borderRadius:h.borderRadius,border:`1px solid ${h.borderColor}`}),height:"100%",width:"100%",src:((w=(x=i==null?void 0:i.response)==null?void 0:x.data)==null?void 0:w.url)??null,placeholder:!0})]},v)})}):null,R("div",{css:i=>({display:"flex",flexDirection:"row",justifyContent:"flex-end",alignItems:"center",padding:`${i.padding.xss}px ${i.padding.sm}px`,borderTop:`1px solid ${i.borderColor}`}),children:[s(jt,{accept:"image/*",showUploadList:!1,fileList:n,multiple:!0,onChange:c,module:ot,children:s(U,{css:i=>({fontSize:i.iconSize}),name:"icon-attachment-outlined",title:r.attachments})}),s(U,{css:i=>({marginLeft:i.margin.xs,fontSize:i.iconSize}),name:"icon-send-outlined",onClick:f,disabled:m,title:r.send})]})]})};Be.propTypes={onInputMessageChange:A.func,handleSendMessage:A.func,message:A.string,mediaList:A.arrayOf(A.objectOf(A.any)),handleRemoveMedia:A.func,handleUploadMedia:A.func,loadingMediaList:A.bool,sendMessageBoxRef:A.oneOfType([A.func,A.shape({current:A.instanceOf(Element)})]),onFocusSendMessageBox:A.func};Be.defaultProps={onInputMessageChange:()=>{},handleSendMessage:()=>{},message:"",mediaList:[],handleRemoveMedia:()=>{},handleUploadMedia:()=>{},loadingMediaList:!1,sendMessageBoxRef:()=>{},onFocusSendMessageBox:()=>{}};const Ze=async(e,a,t)=>{try{const{content:n,images:d,messageType:c,deviceToken:m}=t,u=await ns({idBuilding:e,idRoom:a,content:n,images:d,messageType:c,deviceToken:m});return{code:u.code,codeLanguage:u.codeLanguage}}catch(n){return{code:n.code,codeLanguage:n.codeLanguage}}},Pe=async(e,a)=>{try{const t=await os(e,a);return{code:t.code,codeLanguage:t.codeLanguage}}catch(t){return{code:t.code,codeLanguage:t.codeLanguage}}},fa=()=>{const{currentUser:e}=p.useContext(ve),{tableData:a,helpDeskPermissionApprove:t,helpDeskPermissionWrite:n,showModalApproveHelpDesk:d,idBuilding:c}=p.useContext(B),{setMessages:m,messages:u,helpDeskDetailInfo:l}=p.useContext(ge),[f,g]=p.useState(""),[i,v]=p.useState([]),[x,w]=p.useState(!1),h=p.useRef(null);p.useEffect(()=>{h&&h.current&&h.current.focus({cursor:"end"})},[l]);const C=async()=>{if(!x&&![k,Q,pe].includes(l==null?void 0:l.status)){const I=await dt(),q=new Date;let O,ee;const Y=[...u];if(f&&(O={id:q.getTime(),createdAt:q,content:f,images:[],type:ye,deviceToken:localStorage.getItem(He)||I,idSender:e.id,loading:!0,error:!1},Y.push(O),g("")),i.length&&(ee={id:q.getTime(),createdAt:q,content:"",images:i.map(D=>{var b,N;return((N=(b=D==null?void 0:D.response)==null?void 0:b.data)==null?void 0:N.url)??void 0}).filter(Boolean),type:ut,deviceToken:localStorage.getItem(He)||I,idSender:e.id,loading:!0,error:!1},Y.push(ee),v([])),m(Y),O){const D=await Ze(c,l==null?void 0:l.idRoom,O);Pe(c,l==null?void 0:l.roomId);for(let b=0;b<Y.length;b+=1)if(Y[b].id===O.id){Y[b].loading=!1,ie.includes(D.code)||(Y[b].error=!0);break}}if(ee){const D=await Ze(c,l==null?void 0:l.idRoom,ee);for(let b=0;b<Y.length;b+=1)if(Y[b].id===O.id){Y[b].loading=!1,ie.includes(D.code)||(Y[b].error=!0);break}}m(Y)}},y=({fileList:I})=>{const q=I.filter(O=>O.status!=="done").length!==0;w(q),h.current.focus(),v(I)},H=I=>{const q=i.filter(O=>O.uid!==I.uid);v(q)},M=I=>{const q=I.target.value;g(q)},L=async()=>{if(l!=null&&l.isHaveNewMessage){const I=await Pe(c,l==null?void 0:l.roomId);if(ie.includes(I.code)){const q=[...a];for(let O=0;O<q.length;O+=1)if(q[O].id===(l==null?void 0:l.id)){q[O].isHaveNewMessage=!1;break}}}},S=()=>{d(l)},o=p.useMemo(()=>(l==null?void 0:l.status)===Q,[l==null?void 0:l.status]),_=p.useMemo(()=>(l==null?void 0:l.status)===pe,[l==null?void 0:l.status]),T=p.useMemo(()=>(l==null?void 0:l.status)===Z,[l==null?void 0:l.status]),F=p.useMemo(()=>l.status===k,[l==null?void 0:l.status]);return{helpDeskPermissionApprove:t,helpDeskPermissionWrite:n,loadingMediaList:x,sendMessageBoxRef:h,message:f,mediaList:i,onInputMessageChange:M,handleSendMessage:C,handleRemoveMedia:H,handleUploadMedia:y,onFocusSendMessageBox:L,handleShowModalApproveHelpDesk:S,isStatusHelpDeskApproved:T,isStatusHelpDeskCompleted:o,isStatusHelpDeskRated:_,isStatusHelpDeskNew:F}};var ha={name:"9rl5lb",styles:"top:0;left:0;position:absolute;width:100%;height:100%;display:flex;justify-content:center;align-items:center;z-index:1;background-color:rgba(255,255,255,0.7);flex-direction:column;gap:12px"};const Ue=({handleShowModalApproveHelpDesk:e})=>R("div",{css:ha,children:[s(Ls,{message:r.you_need_to_confirm_reflection_to_directly_communicate_with_residents,type:"warning",showIcon:!0}),s(re,{type:"primary",icon:s(U,{name:"check"}),onClick:e,children:r.accept})]});Ue.propTypes={handleShowModalApproveHelpDesk:A.func};Ue.defaultProps={handleShowModalApproveHelpDesk:()=>{}};const xa=()=>{const{helpDeskPermissionWrite:e,helpDeskPermissionApprove:a,loadingMediaList:t,sendMessageBoxRef:n,message:d,mediaList:c,onInputMessageChange:m,handleSendMessage:u,handleRemoveMedia:l,handleUploadMedia:f,onFocusSendMessageBox:g,handleShowModalApproveHelpDesk:i,isStatusHelpDeskApproved:v,isStatusHelpDeskNew:x}=fa();return R("div",{css:w=>({border:v||x?"1px solid #ddd":"",borderRadius:w.margin.xss,position:"relative",minHeight:v?88:x?110:0}),children:[v&&e?s(Be,{onInputMessageChange:m,handleSendMessage:u,message:d,mediaList:c,handleRemoveMedia:l,handleUploadMedia:f,loadingMediaList:t,sendMessageBoxRef:n,onFocusSendMessageBox:g}):null,x&&a?s(Ue,{handleShowModalApproveHelpDesk:i}):null]})},Sa=e=>{var a,t,n;return{id:e.id,key:e.id,name:(e==null?void 0:e.fullName)??"",avatar:e.avatar,type:e.type,unit:{id:(a=e==null?void 0:e.unit)==null?void 0:a.id,name:((t=e==null?void 0:e.unit)==null?void 0:t.name)??""},unitName:((n=e==null?void 0:e.unit)==null?void 0:n.name)??"",idUser:e.userId,role:e.role}},va=async(e,a)=>{try{const t=await is(e,a);return{code:t.code,codeLanguage:t.codeLanguage,data:t.data.reduce((n,d)=>(n[d.userId]=Sa(d),n),{})}}catch(t){return{code:t.code,codeLanguage:t.codeLanguage,data:{}}}},bt=e=>{var a,t,n,d,c,m,u;return{key:e.id||e.objectId,id:e.id||e.objectId,content:e.content,createdAt:e.createdAt,deviceToken:e.deviceToken,images:((a=e==null?void 0:e.extraData)==null?void 0:a.images)??[],idHelpDesk:((n=(t=e==null?void 0:e.extraData)==null?void 0:t.helpDesk)==null?void 0:n.id)??0,ratingPoint:((c=(d=e==null?void 0:e.extraData)==null?void 0:d.helpDesk)==null?void 0:c.ratingPoint)??0,ratingComment:((u=(m=e==null?void 0:e.extraData)==null?void 0:m.helpDesk)==null?void 0:u.ratingComment)??"",isRead:e.isRead,idMessage:e.messageId,readUserIds:e.readUserIds,idRoom:e.roomId,idSender:e.senderId,type:e.type,idUnit:e.unitId||e.cyUnitId,loading:!1,success:!0}},Je=async({idBuilding:e,idRoom:a,page:t,limit:n})=>{try{const d=await rs({idBuilding:e,idRoom:a,offset:t,limit:n});return{code:d.code,codeLanguage:d.codeLanguage,data:d.data.map(c=>bt(c))}}catch(d){return{code:d.code,codeLanguage:d.codeLanguage,data:[]}}},_a=()=>{const{currentUser:e}=p.useContext(ve),{idBuilding:a,hideDrawerHelpDeskInfo:t}=p.useContext(B),{setMessages:n,messages:d,helpDeskDetailInfo:c}=p.useContext(ge),{isUserCs:m}=rt(),[u,l]=p.useState({}),[f,g]=p.useState({isFetching:!1}),[i,v]=p.useState({isFetching:!1}),[x,w]=p.useState(!1),[h,C]=p.useState(),y=async M=>{const L=new Os.Query("Message");L.equalTo("cyUnitGroupId",Number(a)),L.equalTo("roomId",M);const S=await L.subscribe(),o=await dt();return S.on("create",_=>{const T=_.toJSON();T.deviceToken!==(localStorage.getItem(He)||o)&&C(bt(T))}),S};p.useEffect(()=>{let M;return l([]),n([]),(async()=>{g({isFetching:!0}),v({isFetching:!0});const{unitId:L,idRoom:S}=c;if(S&&L){M=await y(S);const[o,_]=await Promise.all([va(a,L),Je({idBuilding:a,idRoom:S,limit:j,page:V-1}),Pe(a,S)]);l((o==null?void 0:o.data)||[]),n([..._.data]),_.data.length>0?w(!1):w(!0),g({isFetching:!1}),v({isFetching:!1})}})(),()=>{M&&M.unsubscribe()}},[c]),p.useEffect(()=>{if(h){const M=[...d];let L=!1;for(let S=0;S<M.length;S+=1)if(M[S].id===h.id){L=!0;break}L||(M.push(h),n(M))}},[h]);const H=async()=>{if(!i.isFetching){v({isFetching:!0});const{idRoom:M}=c,L=await Je({idBuilding:a,idRoom:M,limit:j,page:d.length+1});L.data.length>0?(n([...L.data,...d]),w(!1)):w(!0),v({isFetching:!1})}};return{hideDrawerHelpDeskInfo:t,isFetchingListMessage:i.isFetching,isFetchingListMember:f.isFetching,isEndOfListMessage:x,members:u,messages:d,handleHelpDeskMessagesLoadMore:H,currentUserId:e.id,isUserCs:m}},et=(e,a)=>{const t=e==null?void 0:e.type,n=e==null?void 0:e.name;return t===Ts&&n||t===Ps?a?"***":n:r.label.deleted_account},wa=de("span",{target:"eugqsdo3"})(({position:e,theme:a})=>({backgroundColor:e==="left"?"#F1F0F0":"#d3ebff",color:e==="left"?"#4A4A4A":"#FFFFF",borderRadius:10,borderTopRightRadius:e==="left"?10:0,borderTopLeftRadius:e==="left"?0:10,borderBottomLeftRadius:10,borderBottomRightRadius:10,padding:"12px",width:"fit-content",wordBreak:"break-word",whiteSpace:"pre-wrap",lineHeight:"1.5"}),""),ya=de("div",{target:"eugqsdo2"})(({position:e})=>({display:"flex",flexDirection:e==="left"?"row":"row-reverse",flex:"2"}),""),La=de("div",{target:"eugqsdo1"})(({position:e})=>({alignItems:e==="left"?"flex-start":"flex-end",margin:e==="left"?"0 0 0 15px":"0 15px 0 0",display:"flex",flexDirection:"column",maxWidth:"80%"}),""),Ra=de(we,{target:"eugqsdo0"})(({position:e})=>({width:"auto",height:"120px",objectFit:"cover",border:"1px solid #ddd",borderRadius:"3px",marginLeft:e==="right"?"6px":"0",marginRight:e==="left"?"6px":"0",marginBottom:"6px",minWidth:"100px"}),""),$e=({position:e,currentMember:a,message:t,isUserCs:n})=>R(ya,{position:e,children:[e==="left"&&s("div",{children:s(Rs,{src:Hs(a==null?void 0:a.avatar,36,36)||"/assets/images/default-avatar.jpg",width:"36px",height:"36px"})}),R(La,{position:e,children:[e==="left"&&R("small",{children:[et(a,n),", ",E(t.createdAt).format("HH:mm")]}),e==="right"&&R("small",{children:[et(a,n),",",E(t.createdAt).format("HH:mm")]}),t.type===ut?s("div",{css:st({display:"flex",flexDirection:e==="left"?"row":"row-reverse",flexWrap:"wrap"},"",""),children:s(we.PreviewGroup,{children:t.images.map(d=>s(Ra,{placeholder:!0,fallback:"/assets/images/image-error.png",position:e,src:d},d))})}):R(Ie,{children:[s(wa,{position:e,children:t.content}),t.loading?s(Oe,{onlyIcon:!0,isLoading:!0,width:"11px",height:"11px"}):null,t.success?null:s(U,{style:{fontSize:11,color:"red",marginTop:3},name:"exclamation-circle"})]})]})]});var Ca={name:"a2p2in",styles:"margin-bottom:12px;& .anticon{font-size:30px;}"},ba={name:"x29ui6",styles:"margin:0px 25%;padding:12px 24px;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center"},Ea={name:"i4e3kr",styles:"padding:0px 100px;width:100%"};const Ve=({message:e,currentUserId:a})=>{var l,f;const{type:t,content:n,senderId:d,ratingPoint:c,ratingComment:m}=e;let u="";if(t===gt){const g=((l=n.match(/\$\{(.+)\}/))==null?void 0:l[1])||null;a===d?u=`${r.you_have_approved_and_set_the_estimated_task_completion_time_on}: ${g?E(g).format("DD/MM/YYYY HH:mm"):""}`:u=`${r.pm_has_approved_and_set_the_estimated_task_completion_time_on}: ${g?E(g).format("DD/MM/YYYY HH:mm"):""}`}if(t===mt){const g=((f=n.match(/\$\{(.+)\}/))==null?void 0:f[1])||null;a===d?u=`${r.you_have_marked_task_as_complete_on}: ${g?E(g).format("DD/MM/YYYY HH:mm"):""}`:u=`${r.pm_has_marked_task_as_complete_on}: ${g?E(g).format("DD/MM/YYYY HH:mm"):""}`}return t===ft?R("div",{css:ba,children:[s(ct,{css:Ca,value:c,disabled:!0}),s("h4",{children:m})]}):s("div",{css:Ea,children:s("h5",{css:g=>({color:"rgba(0,0,0,0.5)",textAlign:"center",fontWeight:g.fontWeight.bold}),children:u})})},Ge=({currentUserId:e,currentMember:a,item:t,position:n,type:d,isUserCs:c})=>d===ye?s($e,{position:n,currentMember:a,message:t,isUserCs:c}):s(Ve,{message:t,currentUserId:e});$e.propTypes={position:A.string,currentMember:A.objectOf(A.any),message:A.objectOf(A.any),isUserCs:A.bool};$e.defaultProps={position:"left",currentMember:void 0,message:{createdAt:new Date,content:"",type:"",images:[],loading:!1,success:!0},isUserCs:!1};Ve.propTypes={message:A.objectOf(A.any),currentUserId:A.number};Ve.defaultProps={message:void 0,currentUserId:0};Ge.propTypes={currentUserId:A.number,currentMember:A.objectOf(A.any),item:A.objectOf(A.any),position:A.string,type:A.string,isUserCs:A.bool};Ge.defaultProps={currentUserId:0,currentMember:void 0,item:void 0,position:"left",type:ye,isUserCs:!1};var Ma={name:"79azp8",styles:"display:flex;flex-direction:column-reverse"},Aa={name:"ti75j2",styles:"margin:0"};const Ha=()=>{const{isFetchingListMessage:e,isFetchingListMember:a,isEndOfListMessage:t,currentUserId:n,isUserCs:d,members:c,messages:m,handleHelpDeskMessagesLoadMore:u}=_a();return R(Fs,{dataLength:m.length,next:u,css:Ma,inverse:!0,hasMore:!t,scrollableTarget:"scrollableListMessage",children:[!e&&!a&&s(Ie,{children:m.length>0?s(Ae,{split:!1,dataSource:m,renderItem:(l,f)=>{const{type:g,idSender:i}=l,v=c[i],x=f===0?void 0:m[f-1],w=!x||x&&E(x.createdAt).startOf("day").diff(E(l.createdAt).startOf("day"))?E(l.createdAt).format("DD/MM/YYYY"):null;let h="right",C=ye;return[mt,gt,ft].includes(g)?(h="center",C=Is):n!==i&&(h="left"),R("div",{children:[w?s(lt,{style:{margin:0},children:s("h5",{css:Aa,children:w})}):null,s(Ae.Item,{style:{padding:"10px 0px"},children:s(Ge,{currentUserId:n,currentMember:v,item:l,position:h,type:C,isUserCs:d})},f)]},l.id)}}):s(Ke,{image:Ke.PRESENTED_IMAGE_SIMPLE,style:{width:"100%",justifyContent:"center"}})}),e||a?s(Oe,{isLoading:e||a}):null]})},Ta=async({idBuilding:e,idHelpDesk:a})=>{try{const t=await ds({idBuilding:e,idHelpDesk:a});return{code:t==null?void 0:t.code,codeLanguage:t==null?void 0:t.codeLanguage,data:t!=null&&t.data?Lt(t==null?void 0:t.data):{}}}catch({code:t,codeLanguage:n}){return{code:t,codeLanguage:n,data:{}}}},Pa=()=>{const{hideDrawerHelpDeskInfo:e,drawerHelpDeskInfo:a,idBuilding:t}=p.useContext(B),{setHelpDeskDetailInfo:n}=p.useContext(ge),d=_s();return p.useEffect(()=>{(async()=>{var u;const m=await Ta({idBuilding:t,idHelpDesk:(u=a==null?void 0:a.data)==null?void 0:u.id});n((m==null?void 0:m.data)??{})})()},[]),{onClose:()=>{e();const m=d.location.pathname;d.push(m)}}};var Ia={name:"xb2hok",styles:".ant-drawer-body{padding:10px 24px;}"},Fa={name:"6v2dj9",styles:"flex-direction:column-reverse"};const Oa=()=>{const{onClose:e}=Pa();return s(Cs,{title:r.chat,placement:"right",open:!0,width:560,onClose:e,css:Ia,children:s(K.Wrapper,{children:R(K.Container,{children:[s(K.Header,{borderBottom:!0,children:s(pa,{})}),s(fe.Content,{id:"scrollableListMessage",scrollY:!0,css:Fa,children:s(Ha,{})}),s(K.Footer,{children:s(xa,{})})]})})})},Na=()=>s(Ye,{children:s(Oa,{})}),ka=e=>({id:e.id,name:e.name}),Et=async({filter:e,limit:a,page:t,idBuilding:n})=>{try{const d=await cs({filter:e,limit:a,page:t,idBuilding:n});return{code:d.code,codeLanguage:d.codeLanguage,data:d.data.map(c=>ka(c))}}catch(d){return{code:d.code,codeLanguage:d.codeLanguage,data:[]}}},qa=()=>{const{formFilter:e,apartments:a,setGetApartmentStatus:t,idBuilding:n,setApartments:d,getApartmentStatus:c,listLabel:m,status:u,setFilter:l,setTablePagination:f,listHelpDeskType:g,helpDeskTypePermissionRead:i,sortString:v}=p.useContext(B),[x]=ae();return{onSearch:async C=>{l(C),f({current:V,limit:j}),await x({filter:{...C,status:u},limit:j,page:V,idBuilding:n,sort:v})},defaultFilter:Ne,formFilter:e,apartments:a,handleSearchApartment:async C=>{t({isFetching:!0});const y=await Et({idBuilding:n,limit:j,page:V,filter:{name:C||void 0}});d(y==null?void 0:y.data),t({isFetching:!1})},isFetchingApartment:c==null?void 0:c.isFetching,labels:m,statusHelpDesk:u,listHelpDeskType:g,helpDeskTypePermissionRead:i}},Ya=()=>{const{onSearch:e,defaultFilter:a,formFilter:t,apartments:n,handleSearchApartment:d,isFetchingApartment:c,labels:m,statusHelpDesk:u,listHelpDeskType:l,helpDeskTypePermissionRead:f}=qa(),g=p.useMemo(()=>[{label:r.code,key:"code",component:s(xe,{placeholder:r.code,allowClear:!0,fluid:"true"}),visible:!0},{label:r.title,key:"title",component:s(xe,{placeholder:r.title,allowClear:!0,fluid:"true"}),visible:!0},{label:r.unit,key:"unitId",component:s(P,{allowClear:!0,showSearch:!0,placeholder:r.label.select_apartment,filterOption:!1,loading:c,onSearch:at(d),style:{width:"100%"},getPopupContainer:i=>i.parentNode,dropdownRender:i=>c?s("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},children:s(bs,{})}):i,children:n==null?void 0:n.map(({id:i,name:v})=>s(P.Option,{value:i,children:v},i))}),visible:!0},{label:r.label1,key:"labelId",component:R(P,{placeholder:r.label1,fluid:"true",getPopupContainer:i=>i.parentNode,children:[s(P.Option,{value:"",children:r.all_label},"labelId_0"),m==null?void 0:m.map(i=>s(P.Option,{value:i.id,children:i.title},i.id))]}),visible:!0},f?{label:r.help_desk_type,key:"helpDeskTypeId",component:R(P,{placeholder:r.help_desk_type,fluid:"true",getPopupContainer:i=>i.parentNode,children:[s(P.Option,{value:"",children:r.all_help_desk_type},"helpDeskTypeId_0"),l==null?void 0:l.map(i=>s(P.Option,{value:i==null?void 0:i.id,children:i==null?void 0:i.name},i==null?void 0:i.id))]}),visible:!0}:null,u===Q?{label:r.rated_status,key:"ratedStatus",component:R(P,{placeholder:r.rated_status,fluid:"true",getPopupContainer:i=>i.parentNode,children:[s(P.Option,{value:"",children:r.all_status},"ratedStatus_0"),be==null?void 0:be.map(i=>s(P.Option,{value:i.id,children:i.name},i.id))]}),visible:!0}:null,[Q,Z].includes(u)?{label:r.expired_status,key:"expiredStatus",component:R(P,{placeholder:r.expired_status,fluid:"true",getPopupContainer:i=>i.parentNode,children:[s(P.Option,{value:"",children:r.all_status},"expiredStatus_0"),Ce==null?void 0:Ce.map(i=>s(P.Option,{value:i.id,children:i.name},i.id))]}),visible:!0}:null,u===Z?{label:r.message_status,key:"messageStatus",component:R(P,{placeholder:r.expired_status,fluid:"true",getPopupContainer:i=>i.parentNode,children:[s(P.Option,{value:"",children:r.all_status},"messageStatus_0"),Ee==null?void 0:Ee.map(i=>s(P.Option,{value:i.id,children:i.name},i.id))]}),visible:!0}:null,{label:r.created_at,key:"createdAt",component:s(Fe.RangePicker,{placeholder:[me,me],fluid:"true",format:[me,me],getPopupContainer:i=>i.parentNode}),visible:!0}].filter(Boolean),[n,c,m,u,f]);return s(K.FilterBox,{defaultFilter:a,filters:g,onSearch:e,formData:t})},Ba=()=>{const{tableData:e,showModalExportHelpDesk:a,taskPermissionExport:t}=p.useContext(B),n=async()=>{a()},d=e==null?void 0:e.totalRecord;return{handleExportListHelpDesk:n,totalRecord:d,taskPermissionExport:t}},Ua=()=>{const{handleExportListHelpDesk:e,totalRecord:a,taskPermissionExport:t}=Ba(),n=ls(),d=[t?s(re,{css:c=>({marginRight:c.margin.xs}),type:"primary",onClick:()=>{n({action:us,label:ps}),e()},icon:s(U,{name:"icon-download-outlined"}),children:r.export},"export"):null].filter(Boolean);return s(K.ActionBox,{total:a,actions:d})},$a=async(e,a,t)=>{try{const n=await gs(e,a);return{code:n.code,codeLanguage:n.codeLanguage}}catch(n){return{code:n.code,codeLanguage:n.codeLanguage}}},Va=()=>{const{modalCompleteHelpDesk:e,hideModalCompleteHelpDesk:a,idBuilding:t,filter:n,status:d,hideDrawerHelpDeskInfo:c}=p.useContext(B),{id:m}=e==null?void 0:e.data,[u]=ae(),[l,f]=p.useState({isFetching:!1,code:void 0,codeLanguage:void 0}),[g,i]=p.useState(3),[v,x]=p.useState(!0),[w,h]=p.useState([]),[C,y]=p.useState({isFetching:!1});p.useEffect(()=>{(async()=>{var S;y({isFetching:!0});const L=await qe(t,m);h(((S=L==null?void 0:L.data)==null?void 0:S.filter(o=>[ht,xt].includes(o.status)))??[]),y({isFetching:!1})})()},[]),p.useEffect(()=>{g>0?(setTimeout(()=>i(g-1),1e3),x(!0)):(i(""),x(!1))},[g]),_e(l.code,l.codeLanguage,{message:r.success,description:r.complete_help_desk_success},()=>{a()});const H=async()=>{f({isFetching:!0,code:void 0,codeLanguage:void 0});const L=await $a(t,m);ie.includes(L.code)&&(await u({filter:{...n,status:d},limit:j,page:V,idBuilding:t}),c()),f({isFetching:!1,code:L.code,codeLanguage:L.codeLanguage})},M=()=>{a()};return{isFetchingCompleteHelpDesk:l.isFetching,handleConfirm:H,handleCancel:M,timeCancelRequest:g,disableCancel:v,listRequest:w,getListRequestStatus:C}},Ga=()=>{const{isFetchingCompleteHelpDesk:e,handleConfirm:a,handleCancel:t,timeCancelRequest:n,disableCancel:d,listRequest:c}=Va();return s(Se,{title:r.complete,okText:n>0?`(${n}) ${r.accept}`:`${r.accept}`,cancelText:r.cancel,confirmLoading:e,onOk:a,onCancel:t,open:!0,closable:t,okButtonProps:{disabled:d},children:c.length?r.you_have_unfinished_work_do_you_want_to_confirm_completion_of_reflection.replace("{item}",c.length):r.do_you_want_to_mark_this_help_desk_as_complete})},ja=e=>({id:e.id,name:e.name}),Da=async e=>{try{const a=await Ns(e,!0);return{code:a.code,codeLanguage:a.codeLanguage,data:a.data.map(t=>ja(t))}}catch(a){return{code:a.code,codeLanguage:a.codeLanguage,data:[]}}},za=e=>{var a;return{id:e.id,name:e.fullName,departments:((a=e==null?void 0:e.departments)==null?void 0:a.map(t=>t.id))??[]}},Wa=async e=>{try{const a=await ks(e);return{code:a.code,codeLanguage:a.codeLanguage,data:a.data.map(t=>za(t))}}catch(a){return{code:a.code,codeLanguage:a.codeLanguage,data:[]}}},Ka=async(e,a)=>{const{expiryDate:t,department:n,receiver:d,content:c,attachments:m,helpDeskId:u,apartmentId:l,residentId:f}=a,g={description:c,departmentId:n,receiverId:d,dueDate:E(t).toDate(),attachments:m,helpDeskId:u,unitId:l,residentId:f};try{const i=await ms(e,g);return{code:i.code,codeLanguage:i.codeLanguage}}catch(i){return{code:i.code,codeLanguage:i.codeLanguage}}},Qa=()=>{const{idBuilding:e,hideModalAddRequest:a,visibleRequestListOverlay:t,setGetListRequestStatus:n,setListRequest:d,filter:c,tablePagination:m}=p.useContext(B),[u]=ae(),[l,f]=p.useState({isFetching:!1,records:[]}),[g,i]=p.useState({isFetching:!1,records:[]}),[v,x]=p.useState({isFetching:!1,code:void 0,codeLanguage:void 0}),[w]=W.useForm(),{title:h,images:C,id:y,unit:H,resident:M}=t==null?void 0:t.data;_e(v.code,v.codeLanguage,{message:r.success,description:r.add_data_success},()=>{a()}),p.useEffect(()=>{(async()=>{f({isFetching:!0,records:[]}),i({isFetching:!0,records:[]});const[T,F]=await Promise.all([Da(e),Wa(e)]);f({isFetching:!1,records:Array.isArray(T==null?void 0:T.data)?T==null?void 0:T.data:[]}),i({isFetching:!1,records:Array.isArray(F==null?void 0:F.data)?F==null?void 0:F.data:[]})})()},[]);const L=async(T,F)=>{T.department&&w.setFieldsValue({receiver:void 0})},S=async()=>{if(await w.validateFields()){x({isFetching:!0,code:void 0,codeLanguage:void 0});const F=await Ka(e,{...w.getFieldsValue(),attachments:C,helpDeskId:y,apartmentId:H.id,residentId:M.id});if(ie.includes(F.code)){n({isFetching:!0});const I=await qe(e,y);d(I.data),n({isFetching:!1}),await u({filter:{...c,status},limit:m.limit,page:m.current,idBuilding:e})}x({isFetching:!1,code:F.code,codeLanguage:F.codeLanguage})}};return{loading:v.isFetching,formAddRequest:w,initialValues:{expiryDate:void 0,department:void 0,receiver:void 0,content:h,requestByResident:!1,apartment:void 0,resident:void 0},department:l,receiver:g,onFinish:S,onValuesChange:L,hideModalAddRequest:a,attachments:C}},Xa=()=>{const e=tt(),{hideModalAddRequest:a,formAddRequest:t,initialValues:n,onValuesChange:d,loading:c,department:m,receiver:u,onFinish:l,attachments:f}=Qa();return s(Se,{title:r.add_request,open:!0,onOk:l,onCancel:a,confirmLoading:c,okText:r.confirm,cancelText:r.cancel,okBtnProps:{loading:c,disabled:c},children:s(W,{layout:"vertical",name:"form_add_request",form:t,initialValues:n,onValuesChange:d,children:R(he,{gutter:[e.margin.xs,0],children:[s(se,{span:24,children:s(W.Item,{name:"expiryDate",rules:[{validator:(g,i)=>i?i&&E(i).isBefore(E().startOf("day"))?Promise.reject(new Error(`${r.min_due_date}: ${E().format("DD/MM/YYYY")}`)):i&&E(i).isBefore(E(),"minutes")?Promise.reject(new Error(`${r.min_due_date}: ${E().format("DD/MM/YYYY HH:mm")}`)):Promise.resolve():Promise.reject(new Error(r.data_require))}],label:r.expiry_date,children:s(Fe,{showTime:!0,disabledDate:g=>E(g).isBefore(E().startOf("day")),format:"DD/MM/YYYY HH:mm",placeholder:"DD/MM/YYYY HH:mm",fluid:!0,allowClear:!1})})}),s(se,{span:12,children:s(W.Item,{name:"department",rules:[{required:!0}],label:r.department,children:s(P,{loading:m.isFetching,placeholder:r.department,fluid:!0,children:m.records.map(({id:g,name:i})=>s(P.Option,{value:g,children:i},g))})})}),s(se,{span:12,children:s(W.Item,{noStyle:!0,shouldUpdate:(g,i)=>g.department!==i.department,children:({getFieldValue:g})=>{var i,v;return s(W.Item,{name:"receiver",rules:[{required:!0}],label:r.receiver,children:s(P,{loading:u.isFetching,placeholder:r.receiver,fluid:!0,children:((v=(i=u==null?void 0:u.records)==null?void 0:i.filter(x=>x==null?void 0:x.departments.includes(Number(g("department")))))==null?void 0:v.map(({id:x,name:w})=>s(P.Option,{value:x,children:w},x)))??[]})})}})}),s(se,{span:24,children:s(W.Item,{name:"content",rules:[{required:!0}],label:r.content,children:s(xe.TextArea,{rows:"3",placeholder:r.content})})}),f.length>0?s(he,{gutter:[e.margin.xs,e.margin.xs],children:f.map((g,i)=>s(Dt,{centerVertical:!0,centerHorizontal:!0,flex:"1 0 150px",style:{height:150},children:s(we,{style:{width:"150px",height:"150px",objectFit:"contain"},src:g})},i))}):null]})})})},Za=async(e,a,t)=>{try{const{estCompleteAt:n,labelId:d=null}=t,c={estCompleteAt:E(n).toDate(),labelId:d||null},m=await fs(e,a,c);return{code:m.code,codeLanguage:m.codeLanguage}}catch(n){return{code:n.code,codeLanguage:n.codeLanguage}}},Ja=()=>{const{filter:e,idBuilding:a,hideModalApproveHelpDesk:t,modalApproveHelpDesk:n,hideDrawerHelpDeskInfo:d,status:c}=p.useContext(B),[m]=ae(),[u,l]=p.useState({isFetching:!1,code:void 0,codeLanguage:void 0}),[f]=W.useForm(),{id:g,labelId:i}=n==null?void 0:n.data;_e(u.code,u.codeLanguage,{message:r.success,description:r.approve_help_desk_success},()=>{t()});const v=async()=>{if(await f.validateFields()){l({isFetching:!0,code:void 0,codeLanguage:void 0});const C={estCompleteAt:f.getFieldValue("estCompleteAt"),labelId:i},y=await Za(a,g,C);ie.includes(y.code)&&(await m({filter:{...e,status:c},limit:j,page:V,idBuilding:a}),d()),l({isFetching:!1,code:y.code,codeLanguage:y.codeLanguage})}},x=()=>{t()};return[u.isFetching,f,v,x]},en=()=>{const[e,a,t,n]=Ja();return R(Se,{title:`${r.confirm}?`,okText:r.accept,cancelText:r.cancel,confirmLoading:e,onOk:t,onCancel:n,open:!0,closable:n,okButtonProps:{disabled:e,loading:e},children:[r.do_you_want_to_approve_this_help_desk,"?",s(W,{form:a,name:"formConfirmApprove",layout:"vertical",children:s(W.Item,{rules:[{required:!0},{validator:async(d,c)=>E(c).isBefore(E(),"minutes")?Promise.reject(new Error(`${r.min_due_date}: ${E().format("DD/MM/YYYY HH:mm")}`)):Promise.resolve()}],name:"estCompleteAt",label:r.deadline,children:s(Fe,{showTime:!0,fluid:"true",format:"DD/MM/YYYY HH:mm",placeholder:"DD/MM/YYYY HH:mm",disabledDate:d=>E(d).isBefore(E().startOf("day"))})})})]})},Me=100,tn=["#",r.help_desk_code,r.status1,r.content,r.unit,r.resident,r.label1,r.help_desk_type,r.label.created_at],sn=()=>{const{hideModalExportHelpDesk:e,tableData:a,filter:t,idBuilding:n,status:d}=p.useContext(B),[c,m]=p.useState({isFetching:!1}),[u,l]=p.useState(0),f=async()=>{var C,y;m({isFetching:!0}),l(0);const g=[];let i=1;const v=a==null?void 0:a.totalRecord,x=Math.floor(v/Me)+1;let w=0;for(await hs({idBuilding:n,filter:{...t,onlyLogging:!0},status:d});i<=x;){const H=await Rt({filter:{...t,status:d},idBuilding:n,limit:Me,page:i});if(H.data.length>0){const M=g.length;for(let S=0;S<H.data.length;S+=1){const o=H.data[S],_=[M+S+1];_.push((o==null?void 0:o.code)??""),_.push((o==null?void 0:o.statusLabel)??""),d!==k&&_.push(o!=null&&o.isExpired?r.expired:r.not_expired),_.push((o==null?void 0:o.title)??""),_.push(((C=o==null?void 0:o.unit)==null?void 0:C.name)??""),_.push((o==null?void 0:o.residentName)??""),_.push(((y=o==null?void 0:o.label)==null?void 0:y.title)??""),_.push((o==null?void 0:o.helpDeskType)??""),_.push((o==null?void 0:o.createdAt)??""),k!==d&&(_.push((o==null?void 0:o.estCompleteAt)??""),_.push((o==null?void 0:o.approvedAt)??""),_.push((o==null?void 0:o.approverName)??"")),d===Q&&(_.push((o==null?void 0:o.completedAt)??""),_.push((o==null?void 0:o.ratingPoint)??""),_.push((o==null?void 0:o.ratingComment)??"")),g.push(_)}i+=1;const L=Me/v*100;w+=L,l(Math.round(w))}else{i=0;break}}const h=[...tn];d!==k&&(h.splice(3,0,r.expired_status),h.push(r.deadline),h.push(r.label.approval_date),h.push(r.approver)),d===Q&&(h.push(r.label.finish_day),h.push(r.label.rating),h.push(r.rating_comment)),g.unshift(h),qs(g,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8",r.help_desk_info_xlsx,".xlsx"),m({isFetching:!1}),Es.success({message:r.success,description:r.export_data_success}),e()};return p.useEffect(()=>{f()},[]),{isFetchingExport:c.isFetching,percent:u}},an=()=>{const{isFetchingExport:e,percent:a}=sn();return s(Se,{open:!0,okText:r.export,cancelText:r.cancel,okButtonProps:{isFetchingExport:e,disabled:e},footer:null,closable:!1,children:s(Ms,{strokeColor:{from:"#108ee9",to:"#87d068"},percent:a,status:"active"})})},nn=e=>{var n;const a=it();return{id:e==null?void 0:e.id,key:e==null?void 0:e.id,name:(e==null?void 0:e.name[a])||((n=e==null?void 0:e.name)==null?void 0:n.vn)||""}},on=async({idBuilding:e,filter:a})=>{const{name:t}=a;try{const{code:n,codeLanguage:d,data:c,totalRecord:m}=await Bs({filter:{name:t||void 0},idBuilding:e});return{code:n,codeLanguage:d,data:c.map(u=>nn(u)),totalRecord:m}}catch({code:n,codeLanguage:d}){return{code:n,codeLanguage:d,data:[],totalRecord:0}}},rn=()=>{const{setTitlePage:e,setVisibleFilterBox:a,setVisibleSearchBox:t}=p.useContext(ve),{drawerHelpDeskInfo:n,showDrawerHelpDeskInfo:d,modalCompleteHelpDesk:c,setListLabel:m,filter:u,tablePagination:l,idBuilding:f,status:g,setApartments:i,setGetApartmentStatus:v,modalAddRequest:x,modalApproveHelpDesk:w,modalExportHelpDesk:h,setListHelpDeskType:C,helpDeskTypePermissionRead:y}=p.useContext(B),{queryParams:H}=Ys(),[M]=ae(),{labelData:L}=zt(),S=H.get("helpDeskId");return p.useEffect(()=>(e(r.help_desk),a(!1),t(!0),(async()=>{v({isFetching:!0});const[o,_]=await Promise.all([Et({idBuilding:f,limit:j,page:V,filter:{name:void 0}}),y?on({idBuilding:f,filter:{name:void 0}}):null,M({filter:{...u,status:g},limit:l.limit,page:l.current,idBuilding:f})]);_!=null&&_.data&&C((_==null?void 0:_.data)||[]),i((o==null?void 0:o.data)||[]),v({isFetching:!1})})(),()=>{a(!1),t(!1)}),[]),p.useEffect(()=>{const o=L==null?void 0:L.filter(_=>[xs,Ss].includes(_==null?void 0:_.type));m(o)},[L]),p.useEffect(()=>{S&&d({id:S})},[S]),{isShowDrawerHelpDeskInfo:n==null?void 0:n.isShow,isShowCompleteHelpDesk:c==null?void 0:c.isShow,isShowModalAddRequest:x==null?void 0:x.isShow,isShowApproveHelpDesk:w==null?void 0:w.isShow,isShowModalExportHelpDesk:h==null?void 0:h.isShow}},dn=()=>{const{isShowDrawerHelpDeskInfo:e,isShowCompleteHelpDesk:a,isShowModalAddRequest:t,isShowApproveHelpDesk:n,isShowModalExportHelpDesk:d}=rn();return R(Ie,{children:[R(K.Wrapper,{children:[s(Ya,{}),R(K.Container,{children:[s(K.Header,{children:s(Ua,{})}),R(K.Content,{children:[s(Ks,{}),s(da,{})]})]})]}),e?s(Na,{}):null,a?s(Ga,{}):null,t?s(Xa,{}):null,n?s(en,{}):null,d?s(an,{}):null]})},Qo=()=>s(js,{children:s(dn,{})});export{Qo as default};
