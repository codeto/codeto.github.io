import{j as r,a as h,u as St,F as Yt}from"./@emotion-63839449.js";import"./lodash-88fe09e6.js";import{h as _}from"./moment-a468e1f9.js";import{l as c,by as G,a9 as A,s as D,i as Y,e4 as $,M as x,j as V,A as H,X as P,eT as xt,S as ft,I as it,a as K,c6 as B,fO as Pt,cp as Ft}from"./index-c2ded735.js";import"./file-saver-40cf32a9.js";import{o as pt,P as y,D as ht,M as ut}from"./index-b17d22e5.js";import{r as g}from"./react-4fd50329.js";import"./react-redux-896b353b.js";import{u as yt}from"./useTableCheckbox-753d19b2.js";import"./@firebase-43527ee1.js";import{P as Rt}from"./prop-types-1172f4d5.js";import{u as I}from"./react-router-a4308f7b.js";import{u as Tt,F as It}from"./index-687ba9e6.js";import{B as ct,T as _t,w as mt,b as gt,g as Nt,R as Lt}from"./antd-f9eae174.js";import{S as v,I as Ot}from"./index-43183512.js";import{d as k}from"./downloadFileFromUrl-79614833.js";import"./hoist-non-react-statics-23d96a9a.js";import"./react-is-e8e5dbb3.js";import"./@babel-b64fd0f9.js";import"./stylis-79144faa.js";import"./classnames-4ba1ba1a.js";import"./redux-10bbab4c.js";import"./react-router-dom-2a8f5f6d.js";import"./history-a1882333.js";import"./resolve-pathname-e210f2ac.js";import"./tiny-invariant-dd7d57d2.js";import"./react-dom-40621ea0.js";import"./scheduler-765c72db.js";import"./@redux-saga-8bafe09b.js";import"./redux-logger-e1c9ca90.js";import"./dompurify-8e338605.js";import"./query-string-f5cca1e7.js";import"./decode-uri-component-4138e85d.js";import"./split-on-first-4f1167c8.js";import"./filter-obj-2ed190f4.js";import"./oidc-client-7da0eaf7.js";import"./firebase-878887a2.js";import"./rc-pagination-c1e6a0ac.js";import"./rc-picker-2e3d5fe5.js";import"./rc-util-0bc219f3.js";import"./rc-trigger-570b13ec.js";import"./rc-motion-ae889c42.js";import"./rc-align-e5d7b12e.js";import"./dom-align-ecb06dd6.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./rc-resize-observer-b9ad4e29.js";import"./@ant-design-cba9d434.js";import"./@ctrl-fb5a5473.js";import"./rc-tabs-dfd19a56.js";import"./rc-dropdown-5378dd0a.js";import"./rc-menu-b15ebfe9.js";import"./rc-overflow-6be96612.js";import"./rc-select-564caf01.js";import"./rc-virtual-list-8a7b82a6.js";import"./rc-collapse-11b7d3c4.js";import"./shallowequal-4542d6f7.js";import"./rc-drawer-317f0b4d.js";import"./@rc-component-5a112e55.js";import"./rc-field-form-ef5549aa.js";import"./async-validator-dee29e8b.js";import"./scroll-into-view-if-needed-6b992d05.js";import"./compute-scroll-into-view-183f845a.js";import"./rc-image-e0357917.js";import"./rc-dialog-b1d1f07b.js";import"./rc-input-number-8bc068f7.js";import"./rc-rate-c64cf0d5.js";import"./rc-steps-2d1924c7.js";import"./rc-switch-b4e96de7.js";import"./rc-table-191ecc42.js";import"./rc-checkbox-018e8052.js";import"./rc-tree-67773537.js";import"./rc-tree-select-cb7eccc3.js";import"./copy-to-clipboard-64585c8c.js";import"./toggle-selection-93f4ad84.js";import"./rc-textarea-d01adcbb.js";import"./rc-input-02c2c2ba.js";import"./rc-upload-3ab0f08a.js";import"./rc-notification-d13dc43b.js";import"./rc-progress-4f1a7096.js";import"./rc-tooltip-08fa4217.js";import"./use-sync-external-store-5d1b6592.js";import"./idb-cdd1a92f.js";import"./path-to-regexp-ef8d5544.js";import"./account-86ffff50.js";import"./index-881eef42.js";import"./libphonenumber-js-0d5a9c92.js";import"./react-infinite-scroll-component-e33646cb.js";const W={feeNotificationMonth:_(),syncStatus:"",apartment:[]},At="NEW",bt="SYNCED",Mt="CHANGED",tt="ERROR",kt=[{label:c.success,value:bt},{label:c.fail,value:tt}],Dt=[{label:c.synced,value:bt},{label:c.out_of_sync,value:At},{label:c.changed,value:Mt}],Ut=G(Dt,"value"),Ct=G(kt,"value"),Bt={...Ut,[tt]:{label:c.out_of_sync,value:tt}},et="WATER",ot="ELECTRIC",at="MANAGEMENT",nt="PARKING",Gt=[{label:c.water,value:et},{label:c.electric,value:ot},{label:c.management_fee,value:at},{label:c.parking,value:nt}],L=g.createContext({isShowSyncData:!1,idBuilding:0,formFilter:void 0,getListApartment:{isFetching:!1},setGetListApartment:()=>{},filter:{...W},setFilter:()=>{},tableData:{records:[],totalRecord:0},setTableData:()=>{},tableSelection:{isSelectAllItem:!1,isShowQuestionSelectAll:!1,selectedRowsCache:[],selectedRowKeysCache:[],selectedRowKeys:[],byId:{}},resetDataTableSelection:()=>{},onSelectRow:()=>{},onSelectAllRowOfPage:()=>{},selectAllRowComponent:()=>{},tablePagination:{current:A,limit:D},setTablePagination:()=>{}}),lt=({children:t})=>{const{idBuilding:e}=I(),[a,n]=g.useState({isFetching:!1}),[o,i]=g.useState({...W}),[u,m]=g.useState({records:[],totalRecord:0}),[d,s,l,f,S]=yt({dataRows:u.records,rowKey:"id",totalRows:u.totalRecord}),[p,b]=g.useState({current:A,limit:D}),T={isShowSyncData:!0,idBuilding:e,getListApartment:a,setGetListApartment:n,filter:o,setFilter:i,tableData:u,setTableData:m,tableSelection:d,resetDataTableSelection:s,onSelectRow:l,onSelectAllRowOfPage:f,selectAllRowComponent:S,tablePagination:p,setTablePagination:b};return r(L.Provider,{value:T,children:t})};lt.propTypes={children:Rt.node};lt.defaultProps={children:r("div",{})};const X=`${xt}/bills-service/v1`,$t=`${X}/unit/invoices`,Vt=`${X}/receipts/sync-fast`,Ht=`${X}/fast/sync/fee-notice`,Kt=`${X}/fast/sync/receipt`,Wt=`${V}/unit-group/fast/export-mapping`,Xt=`${V}/unit/fast/export-mapping`,Jt=`${V}/resident/fast/export-mapping`,jt=`${V}/service/fast/export-mapping`;async function Qt({idBuilding:t,filter:e,page:a,limit:n}){const o={[P]:t},i={...e,page:a,limit:n};return await Y({type:H,payload:{apiUrl:$t,method:x.GET,options:{headers:o,params:i}}})}async function qt({idBuilding:t,createdFor:e,isAll:a,filter:n,unitIds:o}){const i={[P]:t};return await Y({type:H,payload:{apiUrl:Ht,method:x.POST,body:{createdFor:e,isAll:a,unitIds:o,filter:n},options:{headers:i}}})}async function zt({idBuilding:t,filter:e,page:a,limit:n}){const o={[P]:t},i={...e,page:a,limit:n};return await Y({type:H,payload:{apiUrl:Vt,method:x.GET,options:{headers:o,params:i}}})}async function Zt({idBuilding:t,isAll:e,filter:a,idReceipts:n}){const o={[P]:t};return await Y({type:H,payload:{apiUrl:Kt,method:x.POST,body:{isAll:e,receiptIds:n,filter:a},options:{headers:o}}})}async function te(t){const e={[P]:t};return await Y({type:$,payload:{apiUrl:Wt,method:x.GET,options:{headers:e}}})}async function ee(t){const e={[P]:t};return await Y({type:$,payload:{apiUrl:Xt,method:x.GET,options:{headers:e}}})}async function oe(t){const e={[P]:t};return await Y({type:$,payload:{apiUrl:Jt,method:x.GET,options:{headers:e}}})}async function ae(t){const e={[P]:t};return await Y({type:$,payload:{apiUrl:jt,method:x.GET,options:{headers:e}}})}const ne=t=>{var u,m,d,s,l,f,S,p;const e=((u=t==null?void 0:t.bill)==null?void 0:u[et])??0,a=((m=t==null?void 0:t.bill)==null?void 0:m[ot])??0,n=((d=t==null?void 0:t.bill)==null?void 0:d[at])??0,o=((s=t==null?void 0:t.bill)==null?void 0:s[nt])??0,i=((l=t==null?void 0:t.fastFeeNotice)==null?void 0:l.syncHistory)??[];return{id:t==null?void 0:t.id,key:t==null?void 0:t.id,name:(t==null?void 0:t.name)??"",status:((f=t==null?void 0:t.fastFeeNotice)==null?void 0:f.status)??At,lastUpdated:((S=i==null?void 0:i[0])==null?void 0:S.createdAt)??null,syncHistory:((p=t==null?void 0:t.fastFeeNotice)==null?void 0:p.syncHistory)??[],[et]:e,[ot]:a,[at]:n,[nt]:o,total:e+a+n+o}},J=async({filter:t,idBuilding:e,limit:a,page:n})=>{try{const{feeNotificationMonth:o,syncStatus:i,apartment:u}=t,m=await Qt({filter:{createdFor:o?_(o).format("YYYYMM"):void 0,syncStatus:i||void 0,unit:u||void 0},idBuilding:e,limit:a,page:n});return{code:m.code,codeLanguage:m.codeLanguage,data:m.data.map(d=>ne(d)),totalRecord:m.totalRecord}}catch(o){return{code:o.code,codeLanguage:o.codeLanguage,data:[],totalRecord:0}}},se=async({idBuilding:t,idApartments:e,isAll:a,filter:n})=>{try{const{feeNotificationMonth:o,syncStatus:i,apartment:u}=n,m=await qt({filter:a?{syncStatus:i||void 0,unit:u||void 0}:void 0,idBuilding:t,createdFor:o?_(o).format("YYYYMM"):void 0,unitIds:a?[]:e,isAll:a});return{code:m.code,codeLanguage:m.codeLanguage}}catch(o){return{code:o.code,codeLanguage:o.codeLanguage}}},ie=()=>{const{idBuilding:t,isShowSyncData:e,selectAllRowComponent:a,resetDataTableSelection:n,setGetListApartment:o,filter:i,tablePagination:u,tableSelection:m,setTableData:d}=g.useContext(L),{isSelectAllItem:s,selectedRowKeysCache:l}=m,[f,S]=g.useState({code:void 0,codeLanguage:void 0,isFetching:!1});Tt(f.code,f.codeLanguage,{message:c.success,description:c.sync_data_success});const p=()=>{pt({onCancel:()=>{S({isFetching:!1,code:void 0,codeLanguage:void 0})},isAll:s,onOk:async()=>{S({isFetching:!0,code:void 0,codeLanguage:void 0});const R=await se({filter:i,idApartments:l,idBuilding:t,isAll:s});if(S({isFetching:!1,code:R.code,codeLanguage:R.codeLanguage}),ft.includes(R.code)){n(),o({isFetching:!0});const T=await J({filter:{...i},idBuilding:t,limit:u.limit,page:u.current});return d({records:T.data,totalRecord:T.totalRecord}),o({isFetching:!1}),Promise.resolve()}return Promise.reject()},questionText:c.do_you_want_to_sync_data_invoice,totalItem:l.length})},b=!s&&l.length===0;return[e,b,a,p]};function ce(){const[t,e,a,n]=ie(),o=[t?r(ct,{disabled:e,type:"primary",icon:r(it,{name:"icon-sync-outlined"}),onClick:n,children:c.sync_data},"sync"):null];return r(y.ActionBox,{actions:o,total:a()})}const le=()=>{const{idBuilding:t,setGetListApartment:e,setTableData:a,setTablePagination:n,setFilter:o}=g.useContext(L),[i]=It.useForm();return[async m=>{o({...m}),e({isFetching:!0}),n({limit:D,current:A});const d=await J({filter:{...m},idBuilding:t,limit:D,page:A});a({records:d.data,totalRecord:d.totalRecord}),e({isFetching:!1})},i]},re=()=>{const[t,e]=le(),a=g.useMemo(()=>[{label:c.fee_notification_month,key:"feeNotificationMonth",component:r(ht,{placeholder:"MM/YYYY",fluid:"true",format:"MM/YYYY",picker:"month"}),visible:!0},{label:c.status1,key:"syncStatus",component:h(v,{fluid:!0,children:[r(v.Option,{value:"",children:c.all_status},"service_0"),Dt.map(({label:n,value:o})=>r(v.Option,{value:o,children:n},o))]}),visible:!0},{label:c.unit,key:"apartment",component:r(Ot,{placeholder:c.unit,fluid:!0}),visible:!0}],[]);return r(y.FilterBox,{defaultFilter:W,filters:a,formData:e,onSearch:t})},de=()=>{const{idBuilding:t,filter:e,tableData:a,tablePagination:n,tableSelection:o,setTableData:i,setGetListApartment:u,setTablePagination:m,onSelectRow:d,onSelectAllRowOfPage:s,getListApartment:l}=g.useContext(L),f=St(),{layoutScrollRef:S}=g.useContext(K),p=async(F,w)=>{let{limit:C,current:E}=n;E!==F?E=F:C!==w&&(E=A,C=w),m({current:E,limit:C}),u({isFetching:!0});const dt=await J({filter:{...e},idBuilding:t,limit:C,page:E});i({records:dt.data,totalRecord:dt.totalRecord}),u({isFetching:!1})},{selectedRowKeys:b}=o,R=a.records,T=F=>F.inactiveAt?"disabled":"",q={current:n.current,pageSize:n.limit,total:a.totalRecord,showQuickJumper:!0,showSizeChanger:!0,onChange:p},z={offsetScroll:f.offsetScrollX,getContainer:()=>S.current},Z={scrollToFirstRowOnChange:!0},M={selectedRowKeys:b,onSelect:d,onSelectAll:s,fixed:!0};return[l.isFetching,R,T,M,q,Z,z]};function ue(){const[t,e,a,n,o,i,u]=de(),m=s=>r("div",{children:s.map((l,f)=>{var S,p;return h("p",{children:[l!=null&&l.createdAt?_(l.createdAt).format("DD/MM/YYYY HH:mm"):null," -"," ",((p=Ct[((S=l==null?void 0:l.data)==null?void 0:S.status)??""])==null?void 0:p.label)??""]},f)})}),d=[{title:c.unit,key:"name",dataIndex:"name",fixed:"left",width:150},{title:c.status1,key:"status",dataIndex:"status",width:150,render:s=>{var l;return((l=Bt[s])==null?void 0:l.label)??""}},{title:c.last_sync_data,key:"lastSyncDataResult",width:150,render:(s,l)=>l.lastUpdated?r(_t,{title:m(l.syncHistory),children:_(l.lastUpdated).format("DD/MM/YYYY")}):null},...Gt.map(s=>({title:s.label,key:s.value,dataIndex:s.value,width:150,align:"right",render:l=>B(l)})),{title:c.total,key:"total",dataIndex:"total",width:150,align:"right",render:s=>B(s)}];return r(y.Table,{columns:d,dataSource:e,loading:t,pagination:o,rowClassName:a,rowSelection:n,scroll:{...i,x:d.reduce((s,l)=>s+l.width,0)},sticky:u})}const me=()=>{const{idBuilding:t,setTableData:e,setGetListApartment:a}=g.useContext(L);return g.useEffect(()=>{(async()=>{a({isFetching:!0});const n=await J({filter:{...W},idBuilding:t,limit:D,page:A});e({records:n.data,totalRecord:n.totalRecord}),a({isFetching:!1})})()},[]),[]},ge=()=>(me(),h(y.Wrapper,{children:[r(re,{}),h(y.Container,{children:[r(y.Header,{children:r(ce,{})}),r(y.Content,{children:r(ue,{})})]})]})),Se=()=>r(lt,{children:r(ge,{})}),j={receiptType:"",syncStatus:"",paymentAt:[]},vt="NEW",wt="SYNCED",fe="CHANGED",st="ERROR",pe=[{label:c.success,value:wt},{label:c.fail,value:st}],Et=[{label:c.synced,value:wt},{label:c.out_of_sync,value:vt},{label:c.changed,value:fe}],he=G(Et,"value");G(pe,"value");const ye={...he,[st]:{label:c.out_of_sync,value:st}},O=g.createContext({isShowSyncData:!1,idBuilding:0,formFilter:void 0,getDataStatus:{isFetching:!1},setGetDataStatus:()=>{},filter:{...j},setFilter:()=>{},tableData:{records:[],totalRecord:0},setTableData:()=>{},tableSelection:{isSelectAllItem:!1,isShowQuestionSelectAll:!1,selectedRowsCache:[],selectedRowKeysCache:[],selectedRowKeys:[],byId:{}},resetDataTableSelection:()=>{},onSelectRow:()=>{},onSelectAllRowOfPage:()=>{},selectAllRowComponent:()=>{},tablePagination:{current:A,limit:D},setTablePagination:()=>{}}),rt=({children:t})=>{const{idBuilding:e}=I(),[a,n]=g.useState({isFetching:!1}),[o,i]=g.useState({...j}),[u,m]=g.useState({records:[],totalRecord:0}),[d,s,l,f,S]=yt({dataRows:u.records,rowKey:"id",totalRows:u.totalRecord}),[p,b]=g.useState({current:A,limit:D}),T={isShowSyncData:!0,idBuilding:e,getDataStatus:a,setGetDataStatus:n,filter:o,setFilter:i,tableData:u,setTableData:m,tableSelection:d,resetDataTableSelection:s,onSelectRow:l,onSelectAllRowOfPage:f,selectAllRowComponent:S,tablePagination:p,setTablePagination:b};return r(O.Provider,{value:T,children:t})};rt.propTypes={children:Rt.node};rt.defaultProps={children:r("div",{})};const Re=t=>{var a,n,o,i,u;const e=((a=t==null?void 0:t.FastReceipt)==null?void 0:a.syncHistories)??[];return{id:t==null?void 0:t.id,key:t==null?void 0:t.id,receiptCode:(t==null?void 0:t.code)??"",status:((n=t==null?void 0:t.FastReceipt)==null?void 0:n.status)??vt,lastUpdated:((o=e==null?void 0:e[0])==null?void 0:o.createdAt)??null,syncHistory:e,apartment:((i=t==null?void 0:t.Unit)==null?void 0:i.name)??"",dateOfPayment:t==null?void 0:t.createdAt,content:(t==null?void 0:t.content)??"",note:(t==null?void 0:t.note)??"",fund:((u=t==null?void 0:t.Fund)==null?void 0:u.name)??"",paymentMethod:t==null?void 0:t.paymentMethod,unitAccount:t==null?void 0:t.unitAccount,unitAccountPayment:(t==null?void 0:t.unitAccountPayment)??0,netRevenue:(t==null?void 0:t.netRevenue)??0}},Q=async({filter:t,idBuilding:e,limit:a,page:n})=>{try{const{syncStatus:o,paymentAt:i,receiptType:u}=t,m=i!=null&&i[0]?_(i[0]).startOf("day").format("DD/MM/YYYY"):void 0,d=i!=null&&i[1]?_(i[1]).endOf("day").format("DD/MM/YYYY"):void 0,s=await zt({filter:{fastSyncStatus:o||void 0,type:u||void 0,createdAtFrom:m,createdAtTo:d},idBuilding:e,limit:a,page:n});return{code:s.code,codeLanguage:s.codeLanguage,data:s.data.map(l=>Re(l)),totalRecord:s.totalRecord}}catch(o){return{code:o.code,codeLanguage:o.codeLanguage,data:[],totalRecord:0}}},Te=()=>{const{idBuilding:t}=I(),{setGetDataStatus:e,setFilter:a,formFilter:n,setTablePagination:o,resetDataTableSelection:i,setTableData:u}=g.useContext(O);return[async d=>{e({isFetching:!0}),a(d),o({limit:D,current:A}),i();const s=await Q({filter:{...d},idBuilding:t,limit:D,page:A});u({records:s.data,totalRecord:s.totalRecord}),e({isFetching:!1})},n]},_e=()=>{const[t,e]=Te(),a=g.useMemo(()=>[{label:c.label.receipt_type,key:"receiptType",component:h(v,{fluid:!0,children:[r(v.Option,{value:"",children:c.all_type},"receipt_type_0"),Pt.map(({id:n,name:o})=>r(v.Option,{value:n,children:o},n))]}),visible:!0},{label:c.label.date_of_payment,key:"paymentAt",component:r(ht.RangePicker,{placeholder:[c.label.from_date,c.label.to_date],fluid:"true",format:["DD/MM/YYYY","DD/MM/YYYY"]}),visible:!0},{label:c.status1,key:"syncStatus",component:h(v,{fluid:!0,children:[r(v.Option,{value:"",children:c.all_status},"service_0"),Et.map(({label:n,value:o})=>r(v.Option,{value:o,children:n},o))]}),visible:!0}],[]);return r(y.FilterBox,{defaultFilter:j,filters:a,formData:e,onSearch:t})},Ae=async({idBuilding:t,idReceipts:e,isAll:a,filter:n})=>{try{const{syncStatus:o,paymentAt:i,receiptType:u}=n,m=i!=null&&i[0]?_(i[0]).startOf("day").format("DD/MM/YYYY"):void 0,d=i!=null&&i[1]?_(i[1]).endOf("day").format("DD/MM/YYYY"):void 0,s=await Zt({filter:a?{fastSyncStatus:o||void 0,type:u||void 0,createdAtFrom:m,createdAtTo:d}:void 0,idBuilding:t,idReceipts:a?[]:e,isAll:a});return{code:s.code,codeLanguage:s.codeLanguage}}catch(o){return{code:o.code,codeLanguage:o.codeLanguage}}},be=()=>{const{idBuilding:t,isShowSyncData:e,selectAllRowComponent:a,resetDataTableSelection:n,setGetDataStatus:o,filter:i,tablePagination:u,tableSelection:m,setTableData:d}=g.useContext(O),{isSelectAllItem:s,selectedRowKeysCache:l}=m,[f,S]=g.useState({code:void 0,codeLanguage:void 0,isFetching:!1});Tt(f.code,f.codeLanguage,{message:c.success,description:c.sync_data_success});const p=()=>{pt({onCancel:()=>{S({isFetching:!1,code:void 0,codeLanguage:void 0})},isAll:s,onOk:async()=>{S({isFetching:!0,code:void 0,codeLanguage:void 0});const R=await Ae({filter:i,idReceipts:l,idBuilding:t,isAll:s});if(S({isFetching:!1,code:R.code,codeLanguage:R.codeLanguage}),ft.includes(R.code)){n(),o({isFetching:!0});const T=await Q({filter:{...i},idBuilding:t,limit:u.limit,page:u.current});return d({records:T.data,totalRecord:T.totalRecord}),o({isFetching:!1}),Promise.resolve()}return Promise.reject()},questionText:c.do_you_want_to_sync_data_receipt,totalItem:l.length})},b=!s&&l.length===0;return[e,b,a,p]};function De(){const[t,e,a,n]=be(),o=[t?r(ct,{disabled:e,type:"primary",icon:r(it,{name:"icon-sync-outlined"}),onClick:n,children:c.sync_data},"sync"):null];return r(y.ActionBox,{actions:o,total:a()})}const Ce=()=>{const{layoutScrollRef:t}=g.useContext(K),{idBuilding:e}=I(),{filter:a,tableData:n,tablePagination:o,getDataStatus:i,setGetDataStatus:u,setTablePagination:m,setTableData:d,tableSelection:s,onSelectAllRowOfPage:l,onSelectRow:f}=g.useContext(O),S=St(),{selectedRowKeys:p}=s,b=n.records,R=async(M,F)=>{let{current:w,limit:C}=o;w!==M?w=M:C!==F&&(w=A,C=F),u({isFetching:!0}),m({limit:C,current:w});const E=await Q({filter:{...a},idBuilding:e,limit:C,page:w});d({records:E.data,totalRecord:E.totalRecord}),u({isFetching:!1})},T={current:o.current,pageSize:o.limit,total:n.totalRecord,showQuickJumper:!0,showSizeChanger:!0,onChange:R},q={offsetScroll:S.offsetScrollX,getContainer:()=>t.current},z={scrollToFirstRowOnChange:!0},Z={selectedRowKeys:p,onSelect:f,onSelectAll:l,fixed:!0};return[i.isFetching,b,T,z,q,Z]};function ve(){const[t,e,a,n,o,i]=Ce(),u=d=>r("div",{children:d.map((s,l)=>{var f,S;return h("p",{children:[s!=null&&s.createdAt?_(s.createdAt).format("DD/MM/YYYY HH:mm"):null," -"," ",((S=Ct[((f=s==null?void 0:s.data)==null?void 0:f.status)??""])==null?void 0:S.label)??""]},l)})}),m=[{title:c.label.receipt_code,key:"receiptCode",dataIndex:"receiptCode",fixed:"left",width:150},{title:c.status1,key:"status",dataIndex:"status",width:150,render:d=>{var s;return((s=ye[d])==null?void 0:s.label)??""}},{title:c.last_sync_data,key:"lastSyncDataResult",width:150,render:(d,s)=>s.lastUpdated?r(_t,{title:u(s.syncHistory),children:_(s.lastUpdated).format("DD/MM/YYYY")}):null},{title:c.label.apartment,key:"apartment",dataIndex:"apartment",width:150},{title:c.label.date_of_payment,key:"dateOfPayment",dataIndex:"dateOfPayment",width:150,render:d=>d?_(d).format("DD/MM/YYYY"):""},{title:c.label.content,key:"content",dataIndex:"content",width:200,ellipsis:!0},{title:c.label.note,key:"note",dataIndex:"note",width:150,ellipsis:!0},{title:c.label.fund,key:"fund",dataIndex:"fund",width:150},{title:c.label.payment_method,key:"paymentMethod",dataIndex:"paymentMethod",width:150,render:d=>{var s;return(s=Ft[d])==null?void 0:s.label}},{title:c.label.apartment_account,key:"unitAccount",dataIndex:"unitAccount",width:150,render:d=>h(Yt,{children:[d==="REVENUE"&&r(mt,{color:"success",children:c.label.revenue}),d==="EXPENSE"&&r(mt,{color:"error",children:c.label.expense})]})},{title:c.label.account,key:"unitAccountPayment",dataIndex:"unitAccountPayment",fixed:"right",align:"right",width:150,render:d=>B(d)},{title:c.label.total_charge,key:"netRevenue",dataIndex:"netRevenue",fixed:"right",align:"right",width:150,render:d=>B(d)}];return r(y.Table,{columns:m,dataSource:e,loading:t,pagination:a,rowSelection:i,scroll:{...n,x:m.reduce((d,s)=>d+s.width,0)},sticky:o})}const we=()=>{const{idBuilding:t}=I(),{setGetDataStatus:e,resetDataTableSelection:a,setTableData:n}=g.useContext(O),{setVisibleFilterBox:o}=g.useContext(K);return g.useEffect(()=>((async()=>{e({isFetching:!0}),a();const i=await Q({filter:{...j},idBuilding:t,limit:D,page:A});n({records:i.data,totalRecord:i.totalRecord}),e({isFetching:!1})})(),()=>{o(!1)}),[]),[]},Ee=()=>(we(),h(y.Wrapper,{children:[r(_e,{}),h(y.Container,{children:[r(y.Header,{children:r(De,{})}),r(y.Content,{children:r(ve,{})})]})]})),Ye=()=>r(rt,{children:r(Ee,{})}),N="INVOICE",U="RECEIPT",xe=async t=>{try{const[e,a,n,o]=await Promise.all([te(t),ee(t),oe(t),ae(t)]);return{code:200,codeLanguage:void 0,data:{building:e.data,apartment:a.data,resident:n.data,service:o.data}}}catch(e){return{code:e.code,codeLanguage:e.codeLanguage,data:{building:void 0,apartment:void 0,resident:void 0,service:void 0}}}},Pe=()=>{const{idBuilding:t}=I(),{setTitlePage:e,setVisibleFilterBox:a,setVisibleSearchBox:n}=g.useContext(K),[o,i]=g.useState(N),[u,m]=g.useState({isFetching:!1,code:void 0,codeLanguage:void 0});g.useEffect(()=>(e(c.integrate_accounting),a(!0),n(!0),()=>{e(""),a(!1),n(!1)}),[]);const d=({key:l})=>{i(l)},s=async()=>{m({isFetching:!0,code:void 0,codeLanguage:void 0});const l=await xe(t);l.data&&(l.data.building&&k(l.data.building,document,"thong-tin-du-an.xlsx"),l.data.apartment&&k(l.data.apartment,document,"thong-tin-can-ho.xlsx"),l.data.resident&&k(l.data.resident,document,"thong-tin-cu-dan.xlsx"),l.data.service&&k(l.data.service,document,"thong-tin-dich-vu.xlsx")),m({isFetching:!1,code:l.code,codeLanguage:l.codeLanguage})};return[u.isFetching,o,d,s]};var Fe={name:"qvrrxd",styles:"flex:1;height:100%"},Ie={name:"82a6rk",styles:"flex:1"},Ne={name:"82a6rk",styles:"flex:1"};const Le=()=>{const[t,e,a,n]=Pe();return h(Lt,{css:Fe,children:[h(gt,{css:Ie,span:"6",children:[r(ct,{loading:t,icon:r(it,{name:"icon-download-outlined"}),onClick:n,type:"primary",ghost:!0,block:!0,children:c.export_data_building}),h(Nt,{mode:"inline",css:o=>({height:"100%",padding:o.padding.sm,marginTop:o.margin.sm}),selectedKeys:[e],children:[r(ut,{onClick:()=>a({key:N}),className:e===N?"selected":"",children:r("span",{children:c.invoice})},N),r(ut,{onClick:()=>a({key:U}),className:e===U?"selected":"",children:r("span",{children:c.receipt})},U)]})]}),h(gt,{css:Ne,span:"18",children:[e===N?r(Se,{}):null,e===U?r(Ye,{}):null]})]})},pa=Le;export{pa as default};
