import{j as a,a as x,u as O,F as U}from"./@emotion-63839449.js";import{P as v,a as I,o as W}from"./index-b17d22e5.js";import{r as l}from"./react-4fd50329.js";import{P as q}from"./prop-types-1172f4d5.js";import{F as p,u as M}from"./index-687ba9e6.js";import{b0 as j,K as P,ar as z,at as K,g as $,l as s,a3 as N,I as C,bG as X,a5 as _,S as E,a as V,bH as Y,bI as J}from"./index-c2ded735.js";import"./react-redux-896b353b.js";import"./lodash-88fe09e6.js";import"./moment-a468e1f9.js";import"./file-saver-40cf32a9.js";import"./@firebase-43527ee1.js";import{u as Q}from"./react-router-a4308f7b.js";import{I as F}from"./index-43183512.js";import{g as Z,a as ee,d as te,u as oe}from"./helpDeskType-5f91feef.js";import{B as ae,b as S,R}from"./antd-f9eae174.js";import{e as w}from"./rules-c1d56c23.js";import"./hoist-non-react-statics-23d96a9a.js";import"./react-is-e8e5dbb3.js";import"./@babel-b64fd0f9.js";import"./stylis-79144faa.js";import"./react-router-dom-2a8f5f6d.js";import"./history-a1882333.js";import"./resolve-pathname-e210f2ac.js";import"./tiny-invariant-dd7d57d2.js";import"./account-86ffff50.js";import"./index-881eef42.js";import"./libphonenumber-js-0d5a9c92.js";import"./react-infinite-scroll-component-e33646cb.js";import"./classnames-4ba1ba1a.js";import"./redux-10bbab4c.js";import"./react-dom-40621ea0.js";import"./scheduler-765c72db.js";import"./@redux-saga-8bafe09b.js";import"./redux-logger-e1c9ca90.js";import"./dompurify-8e338605.js";import"./query-string-f5cca1e7.js";import"./decode-uri-component-4138e85d.js";import"./split-on-first-4f1167c8.js";import"./filter-obj-2ed190f4.js";import"./oidc-client-7da0eaf7.js";import"./firebase-878887a2.js";import"./rc-pagination-c1e6a0ac.js";import"./rc-picker-2e3d5fe5.js";import"./rc-util-0bc219f3.js";import"./rc-trigger-570b13ec.js";import"./rc-motion-ae889c42.js";import"./rc-align-e5d7b12e.js";import"./dom-align-ecb06dd6.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./rc-resize-observer-b9ad4e29.js";import"./@ant-design-cba9d434.js";import"./@ctrl-fb5a5473.js";import"./rc-tabs-dfd19a56.js";import"./rc-dropdown-5378dd0a.js";import"./rc-menu-b15ebfe9.js";import"./rc-overflow-6be96612.js";import"./rc-select-564caf01.js";import"./rc-virtual-list-8a7b82a6.js";import"./rc-collapse-11b7d3c4.js";import"./shallowequal-4542d6f7.js";import"./rc-drawer-317f0b4d.js";import"./@rc-component-5a112e55.js";import"./rc-field-form-ef5549aa.js";import"./async-validator-dee29e8b.js";import"./scroll-into-view-if-needed-6b992d05.js";import"./compute-scroll-into-view-183f845a.js";import"./rc-image-e0357917.js";import"./rc-dialog-b1d1f07b.js";import"./rc-input-number-8bc068f7.js";import"./rc-rate-c64cf0d5.js";import"./rc-steps-2d1924c7.js";import"./rc-switch-b4e96de7.js";import"./rc-table-191ecc42.js";import"./rc-checkbox-018e8052.js";import"./rc-tree-67773537.js";import"./rc-tree-select-cb7eccc3.js";import"./copy-to-clipboard-64585c8c.js";import"./toggle-selection-93f4ad84.js";import"./rc-textarea-d01adcbb.js";import"./rc-input-02c2c2ba.js";import"./rc-upload-3ab0f08a.js";import"./rc-notification-d13dc43b.js";import"./rc-progress-4f1a7096.js";import"./rc-tooltip-08fa4217.js";import"./use-sync-external-store-5d1b6592.js";import"./idb-cdd1a92f.js";import"./path-to-regexp-ef8d5544.js";const A={name:void 0},T=l.createContext({idBuilding:0,formFilter:void 0,filter:{...A},setFilter:()=>{},getListHelpDeskTypeStatus:{isFetching:!1},setGetListHelpDeskTypeStatus:()=>{},listHelpDeskType:[],setListHelpDeskType:()=>{},modalAddHelpDeskType:void 0,showModalAddHelpDeskType:()=>{},hideModalAddHelpDeskType:()=>{},modalUpdateHelpDeskType:void 0,showModalUpdateHelpDeskType:()=>{},hideModalUpdateHelpDeskType:()=>{},helpDeskTypePermissionWrite:!1}),B=({children:e})=>{const{idBuilding:t}=Q(),[o]=p.useForm(),{getPermissionByModuleCode:n}=j(),[i,r]=l.useState({isFetching:!1}),[d,c]=l.useState({...A}),[f,g]=l.useState([]),[m,u,L]=P(),[D,h,y]=P(),H=n(z),k=(H==null?void 0:H[K])??!1,G={idBuilding:t,formFilter:o,getListHelpDeskTypeStatus:i,setGetListHelpDeskTypeStatus:r,filter:d,setFilter:c,listHelpDeskType:f,setListHelpDeskType:g,modalUpdateHelpDeskType:D,showModalUpdateHelpDeskType:h,hideModalUpdateHelpDeskType:y,modalAddHelpDeskType:m,showModalAddHelpDeskType:u,hideModalAddHelpDeskType:L,helpDeskTypePermissionWrite:k};return a(T.Provider,{value:G,children:e})};B.propTypes={children:q.node};B.defaultProps={children:a("div",{})};const ne=B,ie=e=>{var n,i,r;const t=$();return{id:e==null?void 0:e.id,key:e==null?void 0:e.id,code:(e==null?void 0:e.code)??"",name:(e==null?void 0:e.name[t])||((n=e==null?void 0:e.name)==null?void 0:n.vn)||"",vnName:((i=e==null?void 0:e.name)==null?void 0:i.vi)??"",enName:((r=e==null?void 0:e.name)==null?void 0:r.en)??""}},se=async({idBuilding:e,filter:t})=>{const{name:o}=t;try{const{code:n,codeLanguage:i,data:r,totalRecord:d}=await Z({filter:{name:o||void 0},idBuilding:e});return{code:n,codeLanguage:i,data:r.map(c=>ie(c)),totalRecord:d}}catch({code:n,codeLanguage:i}){return{code:n,codeLanguage:i,data:[],totalRecord:0}}},b=()=>{const{setGetListHelpDeskTypeStatus:e,setListHelpDeskType:t,idBuilding:o}=l.useContext(T);return[async({filter:i})=>{e({isFetching:!0});const r=await se({idBuilding:o,filter:i});t(r==null?void 0:r.data),e({isFetching:!1})}]},re=()=>{const{formFilter:e,setFilter:t}=l.useContext(T),[o]=b();return{onSearch:async i=>{t({...i}),await o({filter:{...i}})},formFilter:e}},de=()=>{const{onSearch:e,formFilter:t}=re(),o=l.useMemo(()=>[{label:s.name,key:"name",component:a(F,{placeholder:s.name,fluid:!0}),visible:!0}],[]);return a(v.FilterBox,{defaultFilter:A,filters:o,formData:t,onSearch:e})},ce=()=>{const{showModalAddHelpDeskType:e,listHelpDeskType:t,helpDeskTypePermissionWrite:o}=l.useContext(T);return{handleAddModal:()=>{e()},total:t==null?void 0:t.length,helpDeskTypePermissionWrite:o}},le=()=>{const{handleAddModal:e,total:t,helpDeskTypePermissionWrite:o}=ce(),n=N(),i=[o?a(ae,{type:"primary",icon:a(C,{name:"icon-plus-circle-outlined"}),onClick:()=>{n({action:X,label:_}),e()},children:s.add},"add"):null].filter(Boolean);return a(v.ActionBox,{actions:i,total:t})},me=async(e,t)=>{const{code:o,name:n,enName:i}=t,r={code:o?o.toUpperCase():void 0,name:{vi:n,en:i,zh:i,ja:i,ko:i}};try{const{code:d,codeLanguage:c}=await ee(e,r);return{code:d,codeLanguage:c}}catch({code:d,codeLanguage:c}){return{code:d,codeLanguage:c}}},ue=()=>{const{hideModalAddHelpDeskType:e,idBuilding:t,formFilter:o}=l.useContext(T),[n]=p.useForm(),[i]=b(),[r,d]=l.useState({isFetching:!1,code:void 0,codeLanguage:void 0});return M(r.code,r.codeLanguage,{message:s.success,description:s.add_data_success}),{hideModalAddHelpDeskType:e,handleAddHelpDeskType:async()=>{if(await n.validateFields()){d({isFetching:!0,code:void 0,codeLanguage:void 0});const g=n.getFieldsValue(),{code:m,codeLanguage:u}=await me(t,g);E.includes(m)&&(o.resetFields(),await i({filter:{...A}})),d({isFetching:!1,code:m,codeLanguage:u}),e()}},formAdd:n}},pe=()=>{const{hideModalAddHelpDeskType:e,handleAddHelpDeskType:t,formAdd:o}=ue();return a(I,{title:s.add,okText:s.add,cancelText:s.cancel,open:!0,onOk:t,onCancel:e,children:a(p,{name:"formAdd",layout:"vertical",form:o,children:x(R,{gutter:[12,12],children:[a(S,{span:"24",children:a(p.Item,{name:"name",rules:[{required:!0},w],label:s.label.name,children:a(F,{placeholder:s.label.name,fluid:"true"})})}),a(S,{span:24,children:a(p.Item,{name:"enName",rules:[{required:!0},w],label:s.label.en_name,children:a(F,{placeholder:s.label.en_name,fluid:"true"})})}),a(S,{span:24,children:a(p.Item,{name:"code",rules:[{required:!0},w],label:s.code,children:a(F,{placeholder:s.code,fluid:"true",style:{textTransform:"uppercase"}})})})]})})})},ge=async(e,t)=>{try{const o=await te(e,t);return{code:o.code,codeLanguage:o.codeLanguage}}catch(o){return{code:o.code,codeLanguage:o.codeLanguage}}},he=()=>{const{layoutScrollRef:e}=l.useContext(V),{listHelpDeskType:t,getListHelpDeskTypeStatus:o,idBuilding:n,filter:i,showModalUpdateHelpDeskType:r,helpDeskTypePermissionWrite:d}=l.useContext(T),c=O(),[f]=b(),[g,m]=l.useState({isFetching:!1,code:void 0,codeLanguage:void 0});M(g.code,g.codeLanguage,{message:s.success,description:s.delete_data_success});const u={offsetScroll:c.offsetScrollX,getContainer:()=>e.current},L=h=>{r(h)},D=h=>{W({onCancel:()=>{m({isFetching:!1,code:void 0,codeLanguage:void 0})},isAll:!1,onOk:async()=>{m({isFetching:!0,code:void 0,codeLanguage:void 0});const y=await ge(n,h==null?void 0:h.id);return m({isFetching:!1,code:y.code,codeLanguage:y.codeLanguage}),E.includes(y.code)?(await f({filter:i}),Promise.resolve()):Promise.reject()},questionText:s.do_you_want_to_delete_help_desk_type,totalItem:1})};return{sticky:u,dataSource:t,loading:o==null?void 0:o.isFetching,handleDeleteHelpDeskType:D,handleUpdateHelpDeskType:L,helpDeskTypePermissionWrite:d}},fe=()=>{const{dataSource:e,loading:t,sticky:o,handleDeleteHelpDeskType:n,handleUpdateHelpDeskType:i,helpDeskTypePermissionWrite:r}=he(),d=N(),c=[{title:s.code,key:"code",dataIndex:"code",width:80},{title:s.name,key:"name",dataIndex:"name",width:140},r?{title:s.action,key:"action",dataIndex:"action",width:80,align:"center",fixed:"right",render:(g,m)=>x(U,{children:[a(C,{onClick:()=>{d({action:Y,label:_}),i(m)},css:u=>({fontSize:u.iconSize}),name:"icon-edit-outlined",title:s.update}),a(C,{onClick:()=>{d({action:J,label:_}),n(m)},css:u=>({fontSize:u.iconSize,marginLeft:u.margin.xs}),name:"icon-minus-circle-outlined",title:s.delete})]})}:null].filter(Boolean),f={x:c.reduce((g,m)=>m+g.width,0),scrollToFirstRowOnChange:!0};return a(v.Table,{sticky:o,scroll:f,columns:c,dataSource:e,loading:t,pagination:!1})},Te=async(e,t,o)=>{const{code:n,name:i,enName:r}=o,d={code:n?n.toUpperCase():void 0,name:{vi:i,en:r,zh:r,ja:r,ko:r}};try{const c=await oe(e,t,d);return{code:c.code,codeLanguage:c.codeLanguage}}catch(c){return{code:c.code,codeLanguage:c.codeLanguage}}},ye=()=>{var m,u,L;const{hideModalUpdateHelpDeskType:e,modalUpdateHelpDeskType:t,idBuilding:o,formFilter:n}=l.useContext(T),[i]=p.useForm(),[r]=b(),[d,c]=l.useState({isFetching:!1,code:void 0,codeLanguage:void 0});M(d==null?void 0:d.code,d==null?void 0:d.codeLanguage,{message:s.success,description:s.update_data_success});const f=async()=>{var h;if(await i.validateFields()){c({isFetching:!0,code:void 0,codeLanguage:void 0});const y=i.getFieldsValue(),{code:H,codeLanguage:k}=await Te(o,(h=t==null?void 0:t.data)==null?void 0:h.id,y);E.includes(H)&&(n.resetFields(),await r({filter:{...A}})),c({isFetching:!1,code:H,codeLanguage:k}),e()}};return{initialValues:{name:(m=t==null?void 0:t.data)==null?void 0:m.vnName,enName:(u=t==null?void 0:t.data)==null?void 0:u.enName,code:(L=t==null?void 0:t.data)==null?void 0:L.code},formUpdate:i,hideModalUpdateHelpDeskType:e,handleUpdateHelpDeskType:f}},ve=()=>{const{hideModalUpdateHelpDeskType:e,formUpdate:t,initialValues:o,handleUpdateHelpDeskType:n}=ye();return a(I,{title:s.update,okText:s.update,cancelText:s.cancel,open:!0,onOk:n,onCancel:e,children:a(p,{name:"formUpdate",layout:"vertical",form:t,initialValues:o,children:x(R,{gutter:[12,12],children:[a(S,{span:"24",children:a(p.Item,{name:"name",rules:[{required:!0},w],label:s.label.name,children:a(F,{placeholder:s.label.name,fluid:"true"})})}),a(S,{span:24,children:a(p.Item,{name:"enName",rules:[{required:!0},w],label:s.label.en_name,children:a(F,{placeholder:s.label.en_name,fluid:"true"})})}),a(S,{span:24,children:a(p.Item,{name:"code",rules:[{required:!0},w],label:s.code,children:a(F,{placeholder:s.code,fluid:"true",style:{textTransform:"uppercase"}})})})]})})})},Fe=()=>{const{setTitlePage:e,setVisibleFilterBox:t,setVisibleSearchBox:o}=l.useContext(V),{modalAddHelpDeskType:n,filter:i,modalUpdateHelpDeskType:r}=l.useContext(T),[d]=b();return l.useEffect(()=>(e(s.configs_helpdesk_type),o(!0),(async()=>await d({filter:i}))(),()=>{e(""),o(!1),t(!1)}),[]),{isShowModalAdd:n==null?void 0:n.isShow,isShowModalUpdate:r==null?void 0:r.isShow}},Le=()=>{const{isShowModalAdd:e,isShowModalUpdate:t}=Fe();return x(U,{children:[x(v.Wrapper,{children:[a(de,{}),x(v.Container,{children:[a(v.Header,{children:a(le,{})}),a(v.Content,{children:a(fe,{})})]})]}),e?a(pe,{}):null,t?a(ve,{}):null]})},to=()=>a(ne,{children:a(Le,{})});export{to as default};
