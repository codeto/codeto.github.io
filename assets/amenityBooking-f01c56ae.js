import{ep as x,l as f,c6 as c,eq as v,er as q,es as w,et as J,g as L,eu as V}from"./index-c2ded735.js";import{l as a}from"./lodash-88fe09e6.js";import{h as u}from"./moment-a468e1f9.js";import"./file-saver-40cf32a9.js";import{c as b}from"./convertNumberToDateTime-e1623b31.js";import{c as j,d as z,e as K}from"./formula-46f71781.js";const S=r=>{const t=Number(r.totalPayment);return{id:r.id,code:r.code,status:r.status,statusFormat:r.status===x?f.unpaid:f.label.paid,totalPayment:t,totalPaymentFormat:c(t),incurredCreatedFor:r.incurredCreatedFor?u(r.incurredCreatedFor,"YYYYMM").format("MM/YYYY"):"",type:r.type}},Q=r=>{const t=Number(r==null?void 0:r.totalPayment);return{id:r==null?void 0:r.id,code:r==null?void 0:r.code,totalPayment:t,totalPaymentFormat:c(t)}},W=r=>{const t=Number(r==null?void 0:r.totalPayment);return{id:r==null?void 0:r.id,code:r==null?void 0:r.code,totalPayment:t,totalPaymentFormat:c(t)}},o=(r,t)=>{var F,h,E,U,H,I,_,p,R,C;const O=b(r==null?void 0:r.startTime).time,G=b(r==null?void 0:r.endTime).time,P=r.amount?Number(r.amount):0,e=r.deposits?Number(r.deposits):0,l=r.utilityPrice?Number(r.utilityPrice):0,A=Number(l)+Number(e);let N=!1;const $=u(r.startDateUsage).format("DD/MM/YYYY"),M=Number((r==null?void 0:r.surchargeFee)||0),T=Number((r==null?void 0:r.refundUtilityPrice)||0),d=[];let Y=null,D=null;return(F=r==null?void 0:r.bills)==null||F.forEach(s=>{s.type===v&&(Y=S(s),d.push(Y)),s.type===q&&(D=S(s),d.push(D))}),![w,J].includes(r==null?void 0:r.status)&&(r!=null&&r.paymentDueDate)&&u().isAfter(u(r==null?void 0:r.paymentDueDate))&&(N=!0),{id:r.id,key:r.code,code:r.code,statusFormat:j[r.status].label||"",statusColor:j[r.status].color||"",status:r.status,amenityName:((h=r==null?void 0:r.utility)==null?void 0:h.name[L()])??"",amenityGroupName:((E=r==null?void 0:r.utilityGroup)==null?void 0:E.name[L()])??"",location:((U=r==null?void 0:r.utility)==null?void 0:U.location)??"",residentName:t?"***":(r==null?void 0:r.residentName)??"",coverPhoto:(H=r==null?void 0:r.utility)==null?void 0:H.coverPhoto,unitName:(r==null?void 0:r.unitName)??"",unitType:((I=V[r==null?void 0:r.unitType])==null?void 0:I.name)??"",createdAt:r!=null&&r.createdAt?u(r==null?void 0:r.createdAt).format("DD/MM/YYYY HH:mm"):"",usageTime:`${$} (${O} - ${G})`,note:r.note,surchargeFee:M,surchargeFeeFormat:c(M),amount:P,amountFormat:c(P),utilityPrice:l,utilityPriceFormat:c(Number(l)),deposits:e,depositsFormat:c(e),totalPayment:A,totalPaymentFormat:c(A),totalTimeUsage:r.totalTimeUsage,paymentDueDate:r.paymentDueDate?u(r==null?void 0:r.paymentDueDate).format("HH:mm DD/MM/YYYY"):"",surcharges:((_=r==null?void 0:r.surcharges)==null?void 0:_.map(s=>z(s)))??[],cancelBookingConditions:r.cancelBookingConditions??[],rejectReason:r.rejectReason??"",rejectAt:r.rejectAt?u(r.rejectAt).format("DD/MM/YYYY HH:mm"):"",cancelAt:r.cancelAt?u(r.cancelAt).format("DD/MM/YYYY HH:mm"):"",rejectBy:r!=null&&r.rejectAt?(r==null?void 0:r.employeeName)||"":(r==null?void 0:r.residentName)||"",bills:(d==null?void 0:d.sort((s,X)=>(s==null?void 0:s.type)===v?-1:1))||[],billForUtilityBookingFee:Y,billForUtilityBookingSurcharge:D,formulas:a.orderBy(((p=r==null?void 0:r.formulas)==null?void 0:p.map(s=>K(s)))||[],["from"],["asc"]),formulaType:r==null?void 0:r.formulaType,isShowPaymentDueAlert:N,employeeNote:r.employeeNote||"",amenitiesUnit:f.frame,receipts:((R=r==null?void 0:r.receipts)==null?void 0:R.map(s=>Q(s)))||[],paySlips:((C=r==null?void 0:r.paySlips)==null?void 0:C.map(s=>W(s)))||[],refundUtilityPrice:T,refundUtilityPriceFormat:c(T),refundUtilityPriceAt:r.refundUtilityPriceAt?u(r.refundUtilityPriceAt).format("DD/MM/YYYY HH:mm"):"",refundDepositAt:r.refundDepositAt?u(r.refundDepositAt).format("DD/MM/YYYY HH:mm"):"",surchargePaidAt:r.surchargePaidAt?u(r.surchargePaidAt).format("DD/MM/YYYY HH:mm"):"",utilityPricePaidAt:r.utilityPricePaidAt?u(r.utilityPricePaidAt).format("DD/MM/YYYY HH:mm"):"",depositsPaidAt:r.depositsPaidAt?u(r.depositsPaidAt).format("DD/MM/YYYY HH:mm"):"",refundUtility:r.refundUtility||{refundValue:null,refundType:null}}};export{o as c};
