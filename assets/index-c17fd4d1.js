import{j as e,a as R,c as Ye,F as Fe,u as Mt}from"./@emotion-63839449.js";import{r as T}from"./react-4fd50329.js";import{l as t,b6 as Dt,b7 as Lt,b8 as Et,b9 as Rt,ba as Pt,bb as xt,bc as Nt,bd as vt,be as Ut,bf as Bt,bg as Yt,bh as Vt,bi as qt,bj as Gt,bk as Ht,bl as zt,bm as De,Y as Ee,bn as $t,S as Ve,bo as jt,i as Wt,A as Qt,M as Kt,X as Xt,j as Jt,bp as Zt,s as V,bq as eo,br as to,I as K,b0 as fe,K as se,ah as qe,ag as _e,at as Se,bs as oo,bt as io,$ as ao,h as j,W as mt,E as we,b1 as no,ai as Ie,bu as ke,bv as ro,a as ht,g as lo,L as so,bw as co,bx as Re,by as uo,bz as po,bA as mo,bB as ho,bC as Te,a1 as fo,a9 as Ne,n as go,bD as bo,bE as rt,bF as yo}from"./index-c2ded735.js";import{g as _o}from"./lodash-88fe09e6.js";import{h as B}from"./moment-a468e1f9.js";import"./file-saver-40cf32a9.js";import{u as ce,a as ye}from"./react-redux-896b353b.js";import"./@firebase-43527ee1.js";import{P as s}from"./prop-types-1172f4d5.js";import{M as Fo,u as Pe,D as de,a as ue,d as lt,T as Io,b as So,g as Co,c as Ao,e as be,B as To,H as ko,I as wo,f as Oo,S as Mo,E as Do,P as Oe,h as Lo,i as Ge,j as He,n as Le,k as G,l as Eo,m as ft,o as st}from"./index-b17d22e5.js";import{a as xe,g as Ro,R as re,b as A,S as Po,B as X,T as xo,w as gt}from"./antd-f9eae174.js";import{F as _,u as ie}from"./index-687ba9e6.js";import{B as J}from"./index-881eef42.js";import{T as bt}from"./index-3a1629f9.js";import{S as E,I as Y}from"./index-43183512.js";import{u as ze}from"./react-router-a4308f7b.js";import"./hoist-non-react-statics-23d96a9a.js";import{r as yt}from"./react-dom-40621ea0.js";import{u as No}from"./useTableCheckbox-753d19b2.js";import{d as vo}from"./downloadFileFromUrl-79614833.js";import{I as $e}from"./integrated-84091933.js";import{I as _t}from"./index-9ef224b9.js";import"./@babel-b64fd0f9.js";import"./stylis-79144faa.js";import"./classnames-4ba1ba1a.js";import"./redux-10bbab4c.js";import"./react-router-dom-2a8f5f6d.js";import"./history-a1882333.js";import"./resolve-pathname-e210f2ac.js";import"./tiny-invariant-dd7d57d2.js";import"./@redux-saga-8bafe09b.js";import"./redux-logger-e1c9ca90.js";import"./dompurify-8e338605.js";import"./query-string-f5cca1e7.js";import"./decode-uri-component-4138e85d.js";import"./split-on-first-4f1167c8.js";import"./filter-obj-2ed190f4.js";import"./oidc-client-7da0eaf7.js";import"./firebase-878887a2.js";import"./scheduler-765c72db.js";import"./rc-pagination-c1e6a0ac.js";import"./rc-picker-2e3d5fe5.js";import"./rc-util-0bc219f3.js";import"./rc-trigger-570b13ec.js";import"./rc-motion-ae889c42.js";import"./rc-align-e5d7b12e.js";import"./dom-align-ecb06dd6.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./rc-resize-observer-b9ad4e29.js";import"./@ant-design-cba9d434.js";import"./@ctrl-fb5a5473.js";import"./rc-tabs-dfd19a56.js";import"./rc-dropdown-5378dd0a.js";import"./rc-menu-b15ebfe9.js";import"./rc-overflow-6be96612.js";import"./rc-select-564caf01.js";import"./rc-virtual-list-8a7b82a6.js";import"./rc-collapse-11b7d3c4.js";import"./shallowequal-4542d6f7.js";import"./rc-drawer-317f0b4d.js";import"./@rc-component-5a112e55.js";import"./rc-field-form-ef5549aa.js";import"./async-validator-dee29e8b.js";import"./scroll-into-view-if-needed-6b992d05.js";import"./compute-scroll-into-view-183f845a.js";import"./rc-image-e0357917.js";import"./rc-dialog-b1d1f07b.js";import"./rc-input-number-8bc068f7.js";import"./rc-rate-c64cf0d5.js";import"./rc-steps-2d1924c7.js";import"./rc-switch-b4e96de7.js";import"./rc-table-191ecc42.js";import"./rc-checkbox-018e8052.js";import"./rc-tree-67773537.js";import"./rc-tree-select-cb7eccc3.js";import"./copy-to-clipboard-64585c8c.js";import"./toggle-selection-93f4ad84.js";import"./rc-textarea-d01adcbb.js";import"./rc-input-02c2c2ba.js";import"./rc-upload-3ab0f08a.js";import"./rc-notification-d13dc43b.js";import"./rc-progress-4f1a7096.js";import"./rc-tooltip-08fa4217.js";import"./use-sync-external-store-5d1b6592.js";import"./idb-cdd1a92f.js";import"./path-to-regexp-ef8d5544.js";import"./react-is-e8e5dbb3.js";import"./account-86ffff50.js";import"./libphonenumber-js-0d5a9c92.js";import"./react-infinite-scroll-component-e33646cb.js";import"./exportExcel-837be6ed.js";import"./xlsx-0fb7ed70.js";import"./regex-deefadac.js";import"./uuid-4a60fe23.js";const Uo=n=>n.map(o=>{const{dataIndex:l,filterComponent:a,key:c}=o,r={...o};return delete r.filterComponent,{title:a||e("div",{}),key:c&&`filter${c.charAt(0).toLowerCase()}${c.substring(1,c.length-1)}`,dataIndex:l&&`filter${l.charAt(0).toLowerCase()}${l.substring(1,l.length-1)}`,fixed:o.fixed,children:[{...r}]}}),Bo=n=>{const{pageSize:o=20,total:l,isShowTotal:a=!0,showQuickJumper:c=!0,showSizeChanger:r=!1,size:g="",callbackOnChange:f=()=>{},simple:u}=n,[S,i]=T.useState(1);return[T.useMemo(()=>({pageSize:o,defaultCurrent:1,current:S,total:l,showQuickJumper:c,showSizeChanger:r,size:g,showTotal:()=>a&&R(xe.Text,{strong:!0,children:[l," ",t.label.results]}),onChange:(k,O)=>{f(k,O),i(k)},simple:u}),[o,S,l]),i]},Yo=({idBuilding:n,filter:o,page:l,limit:a,refreshState:c})=>({type:Lt.REQUEST,payload:{idBuilding:n,filter:o,page:l,limit:a,refreshState:c}}),Vo=({idBuilding:n,floor:o,refreshState:l})=>({type:Et.REQUEST,payload:{idBuilding:n,floor:o,refreshState:l}}),qo=({idBuilding:n,idFloor:o,floor:l,refreshState:a})=>({type:Rt.REQUEST,payload:{idBuilding:n,idFloor:o,floor:l,refreshState:a}}),Go=({idBuilding:n,idFloor:o,refreshState:l})=>({type:Pt.REQUEST,payload:{idBuilding:n,idFloor:o,refreshState:l}}),Ho=()=>({type:Dt}),zo=()=>({type:xt.REQUEST}),Be=({idBuilding:n})=>({type:Nt.REQUEST,payload:{idBuilding:n}}),$o=({idBuilding:n,filter:o,page:l,limit:a,refreshState:c})=>({type:Ut.REQUEST,payload:{idBuilding:n,filter:o,page:l,limit:a,refreshState:c}}),jo=({idBuilding:n,apartment:o,refreshState:l})=>({type:qt.REQUEST,payload:{idBuilding:n,apartment:o,refreshState:l}}),Wo=({idBuilding:n,idApartment:o,apartment:l,refreshState:a})=>({type:Gt.REQUEST,payload:{idBuilding:n,idApartment:o,apartment:l,refreshState:a}}),Qo=({idBuilding:n,idApartment:o,refreshState:l})=>({type:Bt.REQUEST,payload:{idBuilding:n,idApartment:o,refreshState:l}}),Ko=({idBuilding:n,isAll:o,filterObject:l,idApartments:a,refreshState:c})=>({type:Yt.REQUEST,payload:{idBuilding:n,isAll:o,filterObject:l,idApartments:a,refreshState:c}}),Xo=({idBuilding:n,filter:o,refreshState:l})=>({type:Vt.REQUEST,payload:{idBuilding:n,filter:o,refreshState:l}}),Jo=()=>({type:vt}),je=({activeMenuItem:n,handleSelectMenuItem:o,permissionReadBuilding:l,permissionReadUnit:a})=>{const[c]=Ee();return e(Ro,{mode:"inline",style:{height:"100%",padding:c.padding,borderRadius:c.borderRadius},selectedKeys:[n],children:zt.filter(r=>!!(r.value===De&&l||r.value!==De&&a)).map(r=>e(Fo,{onClick:()=>o(r.value),className:n===r.value?"selected":"",children:e("span",{children:r.label})},r.value))})};je.propTypes={activeMenuItem:s.string,handleSelectMenuItem:s.func,permissionReadBuilding:s.bool,permissionReadUnit:s.bool};je.defaultProps={activeMenuItem:Ht,handleSelectMenuItem:()=>{},permissionReadBuilding:!1,permissionReadUnit:!1};const Zo=async n=>await $t(n),dt=Ye(xe.Paragraph,{target:"e454z5o0"})({name:"vh5nmu",styles:"font-size:13px"}),Ft=n=>{const{isShow:o,onHide:l,setLockData:a}=n,[c,r]=T.useState({code:void 0,codeLanguage:void 0,isFetching:!1}),[g]=_.useForm(),{currentBuilding:f,handleChangeCurrentBuilding:u}=Pe(),S=()=>l(),i=async()=>{r({code:void 0,codeLanguage:void 0,isFetching:!0});try{const{dateLock:h,timeLock:k}=await g.validateFields(),O=B(`${h.format("DD/MM/YYYY")} ${k.format("HH:mm:ss")}`,"DD/MM/YYYY HH:mm:ss",!0).toISOString(),M=await Zo({idBuilding:f.id,lockDataAt:O});r({code:M.code,codeLanguage:M.codeLanguage,isFetching:!1}),Ve.includes(M.code)&&(u({...f,lockDataAt:O}),a(O))}catch(h){throw new Error(h)}};return ie(c.code,c.codeLanguage,{message:t.status.success,description:t.status.create_data_lock_success},()=>l()),R(ue,{open:o,title:t.button.create_data_lock_date,onCancel:S,onOk:i,confirmLoading:c.isFetching,children:[e(dt,{children:t.description.accounting_data_lock_warning}),e(dt,{strong:!0,children:t.label.information_date_data_lock}),e(_,{name:"form_create_date_lock",layout:"vertical",form:g,initialValues:{dateLock:B(),timeLock:B()},requiredMark:!1,children:e(_.Item,{required:!0,label:`${t.label.date_lock} *`,children:R(re,{gutter:8,children:[e(A,{span:12,children:e(_.Item,{name:"dateLock",rules:[{required:!0}],children:e(de,{fluid:"true",format:"DD/MM/YYYY"})})}),e(A,{span:12,children:e(_.Item,{name:"timeLock",rules:[{required:!0}],children:e(bt,{fluid:"true"})})})]})})})]})};Ft.propTypes={isShow:s.bool.isRequired,onHide:s.func.isRequired,setLockData:s.func.isRequired};const ei=async(n,o)=>await jt(n),ti=Ye(xe.Paragraph,{target:"ec4qbid0"})({name:"vh5nmu",styles:"font-size:13px"}),It=n=>{const{isShow:o,onHide:l,currentLockData:a,setLockData:c}=n,[r]=_.useForm(),{currentBuilding:g,handleChangeCurrentBuilding:f}=Pe(),[u,S]=T.useState({code:void 0,codeLanguage:void 0,isFetching:!1}),i=()=>l(),h=async()=>{const k=await r.validateFields();if(k){const{dateLock:O,timeLock:M}=k,d=B(`${O.format("DD/MM/YYYY")} ${M.format("HH:mm:ss")}`,"DD/MM/YYYY HH:mm:ss",!0).toISOString();S({code:void 0,codeLanguage:void 0,isFetching:!0});const p=await ei({idBuilding:g.id,lockDataAt:d,prevLockDataAt:a});S({code:p.code,codeLanguage:p.codeLanguage,isFetching:!1}),Ve.includes(p.code)&&(f({...g,lockDataAt:d}),c(d))}};return ie(u.code,u.codeLanguage,{message:t.status.success,description:t.update_data_lock_success},()=>l()),R(ue,{open:o,title:t.label.update_accounting_data_lock,onCancel:i,onOk:h,confirmLoading:u.isFetching,children:[e(ti,{strong:!0,children:t.label.choose_an_alternate_lock_date}),R(_,{name:"form_update_date_lock",layout:"vertical",form:r,requiredMark:!1,children:[e(_.Item,{label:t.label.current_date_lock,children:e(de,{fluid:"true",format:"DD/MM/YYYY HH:mm:ss",disabled:!0,defaultValue:B(a)})}),e(_.Item,{label:`${t.label.set_data_lock_date_to_date} *`,children:R(re,{gutter:8,children:[e(A,{span:12,children:e(_.Item,{name:"dateLock",rules:[{required:!0}],children:e(de,{fluid:"true",format:"DD/MM/YYYY",disabledDate:k=>!k||B(k).isSameOrBefore(B(a),"day")})})}),e(A,{span:12,children:e(_.Item,{name:"timeLock",rules:[{required:!0}],children:e(bt,{fluid:"true"})})})]})})]})]})};It.propTypes={isShow:s.bool.isRequired,onHide:s.func.isRequired,currentLockData:s.string.isRequired,setLockData:s.func.isRequired};const oi=`${Jt}/employee`,ii=`${oi}/list`,ai=async({idBuilding:n,page:o,limit:l,filterObject:a})=>{const c={[Xt]:n},r={...a,limit:l,page:o};return await Wt({type:Qt,payload:{apiUrl:ii,method:Kt.GET,options:{params:r,headers:c}}})},ni=async(n,o,l,a)=>{try{return await ai(n,o,l,a)}catch(c){return c}},ct=async({idBuilding:n,filterObject:o,limit:l=V,page:a})=>{try{const{dataLocker:c,dateLock:r,status:g}=o,f={};return c&&(f.employeeId=c),g&&(f.status=g),r&&Array.isArray(r)&&r.length&&(f.from=B(r[0]).toISOString(),f.to=B(r[1]).toISOString()),await Zt({idBuilding:n,filterObject:f,limit:l,page:a})}catch(c){return c}},{RangePicker:ri}=de,{Option:ut}=E,pt={dateLock:void 0,dataLocker:void 0,status:void 0},St=n=>{const{isShow:o,onHide:l}=n,{currentBuilding:a}=Pe(),[c,r]=T.useState([]),[g,f]=T.useState([]),[u,S]=T.useState(0),[i,h]=T.useState({isFetching:!1}),[k,O]=T.useState({isFetching:!1}),[M,d]=T.useState(pt),p=(C,v)=>{O({isFetching:!0}),(async()=>{const U=await ni({filterObject:{name:v},idBuilding:C,page:1,limit:V});O({isFetching:!1}),r((U==null?void 0:U.data)??[])})()},[D,w]=Bo({total:u,callbackOnChange:async C=>{h({isFetching:!0});const v=await ct({idBuilding:a.id,page:C,filterObject:M});f((v==null?void 0:v.data)??[]),S(v!=null&&v.totalRecord?v.totalRecord:0),h({isFetching:!1}),w(C)}});T.useEffect(()=>{p(a.id,"")},[]),T.useEffect(()=>{(async()=>{h({isFetching:!0});const C=await ct({idBuilding:a.id,page:1,filterObject:M});f((C==null?void 0:C.data)??[]),S(C!=null&&C.totalRecord?C.totalRecord:0),h({isFetching:!1}),w(1)})()},[M]);const x=C=>v=>{d({...M,[C]:v})},I=T.useMemo(()=>g.map(C=>{var v,U;return{key:C.id,latestEditingTime:C.updatedAt,dataLockDate:C.lockDataAt,dataLocker:((v=C==null?void 0:C.creator)==null?void 0:v.fullName)??"",status:(U=eo[C.status])==null?void 0:U.name}}),[g]),P=lt(C=>{p(a.id,C)}),N=Uo([{title:t.label.latest_editing_time,dataIndex:"latestEditingTime",key:"latestEditingTime",render:C=>B(C).format("DD/MM/YYYY HH:mm:ss"),width:195},{title:t.label.data_lock_date,dataIndex:"dataLockDate",key:"dataLockDate",render:C=>B(C).format("DD/MM/YYYY HH:mm:ss"),width:320,filterComponent:e(ri,{format:"DD/MM/YYYY",value:M.dateLock,onChange:x("dateLock")})},{title:t.label.data_locker,dataIndex:"dataLocker",key:"dataLocker",width:220,filterComponent:e(E,{fluid:"true",value:M.dataLocker,onChange:x("dataLocker"),placeholder:t.label.data_locker,filterOption:!1,onSearch:lt(P),showSearch:!0,allowClear:!0,loading:k.isFetching,dropdownRender:C=>k.isFetching?e("div",{className:"display--flex display--flex display--flex--horizontal display--flex--center-horizontal",children:e(Po,{})}):C,children:c.map(C=>e(ut,{value:C.id,children:C.fullName},C.id))})},{title:t.label.status1,dataIndex:"status",key:"status",render:C=>C,width:195,filterComponent:e(E,{fluid:"true",value:M.status,onChange:x("status"),allowClear:!0,placeholder:t.label.status1,showSearch:!0,children:to.map(C=>e(ut,{value:C.id,children:C.name},C.id))})}]),F=()=>l(),W=()=>{d(pt),w(1)};return R(ue,{open:o,title:t.label.data_lock_history,onCancel:F,footer:[e(X,{onClick:F,children:t.button.cancel},"button_cancel_history_data_lock")],width:"80%",children:[e(re,{justify:"end",gutter:8,style:{marginBottom:"12px"},children:e(A,{children:e(xo,{title:t.button.clear_filter,children:e(X,{onClick:W,icon:e(K,{name:"eraser"}),children:t.button.clear_filter})})})}),e(_,{name:"form_search_history",children:e(Io,{dataSource:I,columns:N,bordered:!0,pagination:D,loading:i.isFetching})})]})};St.propTypes={isShow:s.bool.isRequired,onHide:s.func.isRequired};const ve=Ye(xe.Paragraph,{target:"e1psagwd0"})({name:"vh5nmu",styles:"font-size:13px"}),We=n=>{const{lockDataAt:o}=n,[l]=Ee(),{getPermissionByModuleCode:a}=fe(),[c,r]=T.useState(null),[g,f,u]=se(),[S,i,h]=se(),[k,O,M]=se(),d=a(qe),p=(d==null?void 0:d[_e])??!1,D=(d==null?void 0:d[Se])??!1;return T.useEffect(()=>{r(o)},[o]),R("div",{children:[R("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[e(K,{name:"icon-monetization-on-outlined",style:{fontSize:l.fontSizeLargeIcon,marginRight:l.marginSm,color:l.primaryColor}}),e(So,{style:{color:l.primaryColor,fontWeight:l.fontWeightBold},children:t.accounting_info})]}),R("div",{children:[e(ve,{children:t.description.accounting_data_lock_warning}),e(ve,{strong:!0,children:t.label.information_date_data_lock}),c?R(Fe,{children:[R(re,{style:{marginBottom:"12px"},align:"middle",children:[e(A,{style:{marginRight:"60px"},children:e("span",{children:t.label.date_lock})}),e(A,{children:e(de,{value:B(c),disabled:!0,format:"DD/MM/YYYY HH:mm:ss"})}),D?e(A,{children:e(X,{type:"link",onClick:i,children:t.button.update_data_lock})}):null]}),p?e(re,{children:e(A,{children:e(X,{type:"link",style:{paddingLeft:0},onClick:O,children:t.label.data_lock_history})})}):null]}):R(Fe,{children:[e(ve,{type:"danger",strong:!0,children:t.label.currently_the_data_has_not_been_locked}),D?e(re,{children:e(A,{children:e(X,{type:"primary",onClick:f,children:t.button.create_data_lock_date})})}):null]})]}),g.isShow&&e(Ft,{isShow:g.isShow,onHide:u,currentLockData:c,setLockData:r}),S.isShow&&e(It,{isShow:S.isShow,onHide:h,currentLockData:c,setLockData:r}),k.isShow&&e(St,{isShow:k.isShow,onHide:M})]})};We.propTypes={lockDataAt:s.oneOfType([s.instanceOf(B),s.instanceOf(Date),s.string])};We.defaultProps={lockDataAt:null};const li=async n=>{try{return await oo()}catch(o){return o}},si=async(n,o)=>await io(n,o);function di(){var me;const{getBuildings:n}=ao(),{currentBuilding:o,handleChangeCurrentBuilding:l}=Pe(),{getPermissionByModuleCode:a}=fe(),c=ze(),{idBuilding:r}=c,[g]=_.useForm(),[f,u]=T.useState({isFetching:!1}),[S,i]=T.useState({isFetching:!1,code:void 0,codeLanguage:void 0}),[h,k]=T.useState(o),[O,M]=T.useState([]),[d,p]=T.useState({isFetching:!1}),[D,w]=T.useState((h==null?void 0:h.cityId)??void 0),[x,I]=T.useState((h==null?void 0:h.districtId)??void 0),P=b=>{b.buildingCity&&(w(b.buildingCity),I(void 0),g.setFieldsValue({buildingDistrict:void 0,buildingWard:void 0})),b.buildingDistrict&&(I(b.buildingDistrict),g.setFieldsValue({buildingWard:void 0}))};ie(S.code,S.codeLanguage,{message:t.success,description:t.update_building_success}),T.useEffect(()=>{u({isFetching:!0}),(async()=>{p({isFetching:!0});const b=await Co();M((b==null?void 0:b.data)??[]),p({isFetching:!1}),u({isFetching:!0});const $=await li(o==null?void 0:o.id);k(($==null?void 0:$.data)??{}),u({isFetching:!1})})()},[]);const N=async b=>{var he,ae,Q,ne,m;if(g.setFieldsValue({...we(g.getFieldsValue(),{})}),await g.validateFields()){let Z=null;b.imageCover&&b.imageCover.fileList.length>0&&(Z=_o(b,["imageCover","fileList",0,"response","data","url"],null));const ee={imageCover:Z,name:b.buildingName,projectCode:b.projectCode?b.projectCode.toUpperCase():null,unitGroupTypeId:b.buildingType,usingDiscountOriginal:b.usingDiscountOriginal,address:b.buildingAddress,districtId:b.buildingDistrict,cityId:b.buildingCity,wardId:b.buildingWard,hotline:b.buildingPhone&&b.buildingPhone.phoneNumber?`${((he=b==null?void 0:b.buildingPhone)==null?void 0:he.countryCode)??j}${b.buildingPhone.phoneNumber}`:null,email:b.buildingEmail||null,website:b.buildingWebsite||null,dateOfUsageReading:b.dateOfUsageReading||null,dateOfInvoiceSending:b.dateOfInvoiceSending||null,debtRemindPeriod:b.debtRemindPeriod||null,numberDateOfMonth:b.numberDateOfMonth||null,duePayment:b.duePayment||null,dueDebtPayment:b.dueDebtPayment||null,dateOfDebtInvoiceSending:b.dateOfDebtInvoiceSending||null,isViewDebtMonthTemplate:b.isViewDebtMonthTemplate||null,hotlines:b.hotlines.length?b.hotlines.map(y=>{var H,oe,z,Me;return{...y,avatar:((Me=(z=(oe=(H=y==null?void 0:y.avatar)==null?void 0:H[0])==null?void 0:oe.response)==null?void 0:z.data)==null?void 0:Me.url)??"",phone:`${y.phone.countryCode}${y.phone.phoneNumber}`}}):null,enableSyncFast:b.enableSyncFast,emailConfig:{displayName:b.emailConfigDisplayName},investors:((Q=(ae=b==null?void 0:b.investors)==null?void 0:ae.map)==null?void 0:Q.call(ae,y=>{var H,oe,z;return{name:y==null?void 0:y.nameInvestorMore,cityId:y==null?void 0:y.cityInvestorMore,districtId:y==null?void 0:y.districtInvestorMore,wardId:y==null?void 0:y.wardInvestorMore,address:y==null?void 0:y.addressInvestorMore,email:y==null?void 0:y.emailInvestorMore,hotline:(H=y==null?void 0:y.phoneInvestorMore)!=null&&H.phoneNumber?`${((oe=y==null?void 0:y.phoneInvestorMore)==null?void 0:oe.countryCode)??j}${(z=y==null?void 0:y.phoneInvestorMore)==null?void 0:z.phoneNumber}`:null,website:y==null?void 0:y.websiteInvestorMore}}))??null,managements:((m=(ne=b==null?void 0:b.managements)==null?void 0:ne.map)==null?void 0:m.call(ne,y=>{var H,oe,z;return{name:y==null?void 0:y.nameManagementMore,cityId:y==null?void 0:y.cityManagementMore,districtId:y==null?void 0:y.districtManagementMore,wardId:y==null?void 0:y.wardManagementMore,address:y==null?void 0:y.addressManagementMore,email:y==null?void 0:y.emailManagementMore,hotline:(H=y==null?void 0:y.phoneManagementMore)!=null&&H.phoneNumber?`${((oe=y==null?void 0:y.phoneManagementMore)==null?void 0:oe.countryCode)??j}${(z=y==null?void 0:y.phoneManagementMore)==null?void 0:z.phoneNumber}`:null,website:y==null?void 0:y.websiteManagementMore}}))??null};i({code:void 0,codeLanguage:void 0,isFetching:!0});const te=await si(r,ee);l({id:r,lockDataAt:h.lockDataAt,...ee}),i({code:te.code,codeLanguage:te.codeLanguage,isFetching:!1}),await n()}},F=T.useMemo(()=>{var $,he,ae,Q,ne;const b=Ao(o==null?void 0:o.hotline);return{id:r,basicInfo:{name:(o==null?void 0:o.name)??"",type:(o==null?void 0:o.unitGroupTypeId)??"",projectCode:(o==null?void 0:o.projectCode)??"",imageCover:(o==null?void 0:o.imageCover)??"",city:(o==null?void 0:o.cityId)??"",district:(o==null?void 0:o.districtId)??"",ward:(o==null?void 0:o.wardId)??"",address:(o==null?void 0:o.address)??"",phone:{countryCode:b,phoneCode:b,phoneNumber:be(o==null?void 0:o.hotline,b)},email:(o==null?void 0:o.email)??"",website:(o==null?void 0:o.website)??"",hotlines:((he=($=o==null?void 0:o.hotlines)==null?void 0:$.map(m=>m.phone?m.phone.indexOf("1800")===0?{...m,avatar:[{response:{data:{url:m.avatar||null}}}],phone:{countryCode:"1800",phoneCode:"1800",phoneNumber:be(m.phone,"1800")}}:m.phone.indexOf("1900")===0?{...m,avatar:[{response:{data:{url:m.avatar||null}}}],phone:{countryCode:"1900",phoneCode:"1900",phoneNumber:be(m.phone,"1900")}}:{...m,avatar:[{response:{data:{url:m.avatar||null}}}],phone:{countryCode:j,phoneCode:j,phoneNumber:be(m.phone,j)}}:null))==null?void 0:he.filter(Boolean))??[]},investors:((ae=o==null?void 0:o.investors)==null?void 0:ae.map(m=>{var Z,ee,te;return{name:(m==null?void 0:m.name)??"",city:(m==null?void 0:m.cityId)??"",district:(m==null?void 0:m.districtId)??"",ward:(m==null?void 0:m.wardId)??"",address:(m==null?void 0:m.address)??"",phone:{countryCode:((Z=m==null?void 0:m.hotline)==null?void 0:Z.countryCode)??j,phoneCode:((ee=m==null?void 0:m.hotline)==null?void 0:ee.phoneCode)??j,phoneNumber:be(m==null?void 0:m.hotline,((te=m==null?void 0:m.hotline)==null?void 0:te.phoneCode)??j)},email:(m==null?void 0:m.email)??"",website:(m==null?void 0:m.website)??""}}))??[],managements:((Q=o==null?void 0:o.managements)==null?void 0:Q.map(m=>{var Z,ee,te;return{name:(m==null?void 0:m.name)??"",city:(m==null?void 0:m.cityId)??"",district:(m==null?void 0:m.districtId)??"",ward:(m==null?void 0:m.wardId)??"",address:(m==null?void 0:m.address)??"",phone:{countryCode:((Z=m==null?void 0:m.hotline)==null?void 0:Z.countryCode)??j,phoneCode:((ee=m==null?void 0:m.hotline)==null?void 0:ee.phoneCode)??j,phoneNumber:be(m==null?void 0:m.hotline,((te=m==null?void 0:m.hotline)==null?void 0:te.phoneCode)??j)},email:(m==null?void 0:m.email)??"",website:(m==null?void 0:m.website)??""}}))??[],serviceInfo:{usingDiscountOriginal:o==null?void 0:o.usingDiscountOriginal,dateOfUsageReading:o==null?void 0:o.dateOfUsageReading,dateOfInvoiceSending:o==null?void 0:o.dateOfInvoiceSending,dateOfDebtInvoiceSending:o==null?void 0:o.dateOfDebtInvoiceSending,duePayment:o==null?void 0:o.duePayment,dueDebtPayment:o==null?void 0:o.dueDebtPayment,isViewDebtMonthTemplate:o==null?void 0:o.isViewDebtMonthTemplate,debtRemindPeriod:o==null?void 0:o.debtRemindPeriod,numberDateOfMonth:o==null?void 0:o.numberDateOfMonth},accountantInfo:{lockDataAt:o==null?void 0:o.lockDataAt,enableSyncFast:(o==null?void 0:o.enableSyncFast)??!1},emailConfig:{displayName:((ne=o==null?void 0:o.emailConfig)==null?void 0:ne.displayName)??""}}},[h]),W={buildingName:F.basicInfo.name,projectCode:F.basicInfo.projectCode,buildingType:F.basicInfo.type,imageCover:{fileList:[{response:{data:{url:F.basicInfo.imageCover}}}]},buildingCity:F.basicInfo.city,buildingDistrict:F.basicInfo.district,buildingWard:F.basicInfo.ward,buildingAddress:F.basicInfo.address,buildingPhone:F.basicInfo.phone,buildingEmail:F.basicInfo.email,buildingWebsite:F.basicInfo.website,hotlines:F.basicInfo.hotlines,emailConfigDisplayName:(me=F==null?void 0:F.emailConfig)==null?void 0:me.displayName,dateOfUsageReading:F.serviceInfo.dateOfUsageReading,dateOfInvoiceSending:F.serviceInfo.dateOfInvoiceSending,debtRemindPeriod:F.serviceInfo.debtRemindPeriod,numberDateOfMonth:F.serviceInfo.numberDateOfMonth,duePayment:F.serviceInfo.duePayment,dueDebtPayment:F.serviceInfo.dueDebtPayment,dateOfDebtInvoiceSending:F.serviceInfo.dateOfDebtInvoiceSending,isViewDebtMonthTemplate:F.serviceInfo.isViewDebtMonthTemplate,usingDiscountOriginal:F.serviceInfo.usingDiscountOriginal,investors:F==null?void 0:F.investors.map(b=>({nameInvestorMore:b.name,cityInvestorMore:b.city,districtInvestorMore:b.district,wardInvestorMore:b.ward,emailInvestorMore:b.email,phoneInvestorMore:b.phone,addressInvestorMore:b.address,websiteInvestorMore:b.website})),managements:F==null?void 0:F.managements.map(b=>({nameManagementMore:b.name,cityManagementMore:b.city,districtManagementMore:b.district,wardManagementMore:b.ward,emailManagementMore:b.email,phoneManagementMore:b.phone,addressManagementMore:b.address,websiteManagementMore:b.website}))},C=a(mt),v=(C==null?void 0:C[Se])??!1,U=(C==null?void 0:C[_e])??!1,pe=a(qe),Ce=(pe==null?void 0:pe[_e])??!1;return{formUpdate:g,cities:O,onFinish:N,buildingData:F,onValuesChange:P,initialValues:W,selectCityOfBuilding:D,selectDistrictOfBuilding:x,isFetchingCity:d.isFetching,isFetchingBuilding:f.isFetching,isFetchingUpdateBuilding:S.isFetching,isShowConfigBuilding:U,isShowConfigLockData:Ce,isShowActionUpdateBuilding:v}}function ci(){const{formUpdate:n,cities:o,onFinish:l,buildingData:a,onValuesChange:c,initialValues:r,selectCityOfBuilding:g,selectDistrictOfBuilding:f,isFetchingCity:u,isFetchingBuilding:S,isShowConfigBuilding:i,isShowConfigLockData:h,isShowActionUpdateBuilding:k,isFetchingUpdateBuilding:O}=di();return S||!a?e(no,{width:"50px",height:"50px",isLoading:!0}):e(_,{name:"buildingForm",scrollToFirstError:!0,layout:"vertical",onFinish:l,form:n,initialValues:r,style:{display:"flex",flexDirection:"column",flex:1,height:"100%"},onValuesChange:c,children:R(J,{style:{flex:1},children:[R(J.Content,{scrollY:!0,children:[i?R(Fe,{children:[e(To,{form:n,imageCover:a.basicInfo.imageCover,cityId:g,districtId:f,cities:o,loadingCity:u}),e(ko,{}),e(wo,{form:n,cities:o,loadingCity:u,investorData:a.investors}),e(Oo,{form:n,cities:o,loadingCity:u,managementData:a.managements}),e(Mo,{isViewDebtMonthTemplate:a.serviceInfo.isViewDebtMonthTemplate}),e(Do,{})]}):null,h?e(We,{lockDataAt:a.accountantInfo.lockDataAt}):null]}),e(J.Footer,{borderTop:!0,style:{textAlign:"right"},children:k&&i?e(X,{htmlType:"submit",loading:O,type:"primary",children:t.label.confirm}):null})]})})}const Qe=({onClickBtnAdd:n,totalFloor:o})=>{var r;const[l]=Ee(),{getPermissionByModuleCode:a}=fe(),c=((r=a(Ie))==null?void 0:r[Se])??!1;return R("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[e("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:R("span",{style:{fontWeight:l.fontWeightNormal,color:l.labelColor},children:[t.total," ",e("span",{style:{fontWeight:l.fontWeightBold,verticalAlign:"middle",color:l.blackColor},children:o})]})}),e("div",{children:c?e(X,{type:"primary",onClick:n,icon:e(K,{name:"icon-plus-circle-outlined"}),children:t.add}):null})]})};Qe.propTypes={onClickBtnAdd:s.func,totalFloor:s.number};Qe.defaultProps={onClickBtnAdd:()=>{},totalFloor:0};const Ke=({loading:n,floors:o,onClickBtnUpdateFloor:l,onClickBtnDeleteFloor:a,tablePage:c,handleTablePageChange:r,tablePageSize:g,handleTablePageSizeChange:f,totalFloor:u})=>{var p;const[S]=Ee(),{getPermissionByModuleCode:i}=fe(),h=((p=i(Ie))==null?void 0:p[Se])??!1,k=(D,w)=>{D!==c&&r(D),w!==g&&f(w)},O=[{title:t.floor,key:"name",dataIndex:"name"},h?{title:t.actions,key:"actions",dataIndex:"actions",width:100,align:"center",render:(D,w)=>R(Fe,{children:[e(K,{title:t.update,style:{marginRight:S.marginSm,fontSize:S.fontSizeLargeIcon},name:"icon-edit-outlined",onClick:()=>l(w.floor)}),e(K,{title:t.delete,style:{fontSize:S.fontSizeLargeIcon},name:"icon-minus-circle-outlined",onClick:()=>a(w.floor)})]})}:null].filter(Boolean),M=o.map((D,w)=>({key:D.id,id:D.id,name:D.name,floor:D})),d={pageSize:g,defaultCurrent:1,current:c,total:u,showQuickJumper:!0,showSizeChanger:!0,onChange:k};return e(Oe.Table,{pagination:d,loading:n,columns:O,dataSource:M})};Ke.propTypes={loading:s.bool,floors:s.arrayOf(s.any),onClickBtnUpdateFloor:s.func,onClickBtnDeleteFloor:s.func,tablePage:s.number,handleTablePageChange:s.func,tablePageSize:s.number,handleTablePageSizeChange:s.func,totalFloor:s.number};Ke.defaultProps={loading:!1,floors:[],onClickBtnUpdateFloor:()=>{},onClickBtnDeleteFloor:()=>{},tablePage:1,handleTablePageChange:()=>{},tablePageSize:V,handleTablePageSizeChange:()=>{},totalFloor:0};const Xe=({hideModal:n,idBuilding:o,refreshTableData:l})=>{const a=ce(),[c]=_.useForm(),[r,g]=T.useState({code:void 0,codeLanguage:void 0,isFetching:!1});ie(r.code,r.codeLanguage,{message:t.success,description:t.add_data_success},()=>{n(),l()});const f=async()=>{if(c.setFieldsValue({...we(c.getFieldsValue(),{})}),await c.validateFields()){const i={name:c.getFieldValue("name"),unitGroupId:Number(o)};g({code:void 0,codeLanguage:void 0,isFetching:!0}),a(Vo({idBuilding:o,floor:i,refreshState:({code:h,codeLanguage:k})=>{g({code:h,codeLanguage:k,isFetching:!1})}}))}},u=()=>{n()};return e(ue,{title:t.add_floor,okButtonProps:{loading:r.isFetching,disabled:r.isFetching},open:!0,okText:t.confirm,cancelText:t.cancel,onOk:f,onCancel:u,children:e(_,{initialValues:{name:""},layout:"vertical",form:c,name:"formAddFloor",children:e(_.Item,{rules:[{required:!0}],name:"name",label:t.floor,children:e(Y,{placeholder:t.floor})})})})};Xe.propTypes={hideModal:s.func,idBuilding:s.oneOfType([s.number,s.string]),refreshTableData:s.func};Xe.defaultProps={hideModal:()=>{},idBuilding:0,refreshTableData:()=>{}};const Je=({hideModal:n,idBuilding:o,floor:l,refreshTableData:a})=>{const c=ce(),[r]=_.useForm(),[g,f]=T.useState({code:void 0,codeLanguage:void 0,isFetching:!1});ie(g.code,g.codeLanguage,{message:t.success,description:t.update_data_success},()=>{n(),a()});const u=async()=>{if(r.setFieldsValue({...we(r.getFieldsValue(),{})}),await r.validateFields()){const h={name:r.getFieldValue("name"),unitGroupId:Number(o)};f({code:void 0,codeLanguage:void 0,isFetching:!0}),c(qo({idBuilding:o,idFloor:l.id,floor:h,refreshState:({code:k,codeLanguage:O})=>{f({code:k,codeLanguage:O,isFetching:!1})}}))}},S=()=>{n()};return e(ue,{title:t.update_floor,okButtonProps:{loading:g.isFetching,disabled:g.isFetching},open:!0,okText:t.confirm,cancelText:t.cancel,onOk:u,onCancel:S,children:e(_,{initialValues:{name:l.name},layout:"vertical",form:r,name:"formUpdateFloor",children:e(_.Item,{rules:[{required:!0}],name:"name",label:t.floor,children:e(Y,{placeholder:t.floor})})})})};Je.propTypes={hideModal:s.func,idBuilding:s.oneOfType([s.number,s.string]),floor:s.objectOf(s.any),refreshTableData:s.func};Je.defaultProps={hideModal:()=>{},idBuilding:0,floor:void 0,refreshTableData:()=>{}};const Ze=({onSearch:n,formFilter:o})=>{const l=T.useMemo(()=>[{label:t.floor,key:"name",component:e(Y,{placeholder:t.floor}),visible:!0}],[]);return e(Oe.FilterBox,{formData:o,defaultFilter:ke,onSearch:n,layout:"vertical",filters:l})};Ze.propTypes={onSearch:s.func,formFilter:s.objectOf(s.any)};Ze.defaultProps={onSearch:()=>{},formFilter:{}};const ui=({triggerGetFloors:n,filterObj:o,setFilterObj:l,formFilter:a})=>{const[c,r]=T.useState(1),[g,f]=T.useState(V);return{tablePage:c,setTablePage:r,tablePageSize:g,setTablePageSize:f,handleTablePageChange:h=>{c!==h&&(r(h),n(o,h,g))},handleTablePageSizeChange:h=>{g!==h&&(c!==1&&r(1),f(h),n(o,1,h))},refreshTableData:()=>{l(ke),c!==1&&r(1),g!==V&&f(V),n(ke,1,V),a.resetFields()}}},pi=({idBuilding:n})=>{const[o,l,a]=se(),[c,r,g]=se(),[f,u]=T.useState({code:void 0,codeLanguage:void 0}),S=ce();return{formAddFloor:o,hideFormAddFloor:a,formUpdateFloor:c,hideFormUpdateFloor:g,deleteFloorState:f,setDeleteFloorState:u,handleShowFormAddFloor:()=>{l({idBuilding:n})},onClickBtnUpdateFloor:O=>{r({idBuilding:n,floor:O})},onClickBtnDeleteFloor:O=>{ue.confirm({okText:t.confirm,cancelText:t.cancel,title:t.confirm,content:`${t.do_you_want_to_delete_this_item}?`,onOk:()=>(u({code:void 0,codeLanguage:void 0}),new Promise((M,d)=>{S(Go({idBuilding:n,idFloor:O.id,refreshState:({code:p,codeLanguage:D})=>(u({code:p,codeLanguage:D}),p===200?M():d())}))})),afterClose:()=>{u({code:void 0,codeLanguage:void 0})}})}}},mi=()=>{const n=ye(U=>U.configFloor.data),o=ye(U=>U.configFloor.totalData),l=ce(),a=ze(),{idBuilding:c}=a,[r,g]=T.useState(ke),[f,u]=T.useState({isFetching:!1}),[S]=_.useForm(),i=(U,pe,Ce)=>{u({isFetching:!0}),l(Yo({idBuilding:c,filter:{name:U.name?U.name:void 0},page:pe,limit:Ce,refreshState:()=>{u({isFetching:!1})}}))},{handleTablePageChange:h,handleTablePageSizeChange:k,refreshTableData:O,setTablePage:M,setTablePageSize:d,tablePage:p,tablePageSize:D}=ui({filterObj:r,formFilter:S,setFilterObj:g,triggerGetFloors:i}),{deleteFloorState:w,formAddFloor:x,formUpdateFloor:I,handleShowFormAddFloor:P,hideFormAddFloor:N,hideFormUpdateFloor:F,onClickBtnDeleteFloor:W,onClickBtnUpdateFloor:C}=pi({idBuilding:c});T.useEffect(()=>(yt.unstable_batchedUpdates(()=>{i(ke,1,V)}),()=>{l(Ho())}),[]);const v=U=>{g(U),p!==1&&M(1),D!==V&&d(V),i(U,1,V)};return ie(w.code,w.codeLanguage,{message:t.success,description:t.delete_data_success},()=>{O()}),R(Fe,{children:[e(Ze,{formFilter:S,onSearch:v}),R(J,{style:{flex:1},children:[e(J.Header,{children:e(Qe,{totalFloor:o,onClickBtnAdd:P})}),e(J.Content,{fluid:!0,children:e(Ke,{onClickBtnUpdateFloor:C,onClickBtnDeleteFloor:W,floors:n,loading:f.isFetching,tablePage:p,tablePageSize:D,handleTablePageChange:h,handleTablePageSizeChange:k,totalFloor:o})}),e(J.Footer,{}),x.isShow&&e(Xe,{refreshTableData:O,idBuilding:x.data.idBuilding,hideModal:N}),I.isShow&&e(Je,{refreshTableData:O,idBuilding:I.data.idBuilding,floor:I.data.floor,hideModal:F})]})]})},et=({onClickBtnImport:n,onClickBtnAdd:o,onClickBtnDeleteMultiApartment:l,selectAllRowComponent:a,visibleDeleteBtn:c,exportApartmentState:r,onClickBtnExportDataApartment:g,isAdmin:f})=>{var k,O;const{getPermissionByModuleCode:u}=fe(),S=((k=u(Ie))==null?void 0:k[Se])??!1,i=((O=u(Ie))==null?void 0:O[ro])??!1,h=[S&&f?e(X,{css:M=>({marginRight:M.margin.xs}),type:"primary",onClick:l,icon:e(K,{name:"icon-minus-circle-outlined"}),disabled:!c,children:t.delete},"delete"):null,i?e(X,{type:"primary",ghost:!0,css:M=>({marginRight:M.margin.xs}),loading:r.isFetching,disabled:r.isFetching,onClick:g,icon:e(K,{name:"icon-download-outlined"}),children:t.export},"export"):null,S?e(X,{type:"primary",css:M=>({marginRight:M.margin.xs}),onClick:n,icon:e(K,{name:"icon-upload-outlined"}),children:t.import},"import"):null,S?e(X,{type:"primary",onClick:o,icon:e(K,{name:"icon-plus-circle-outlined"}),children:t.add},"add"):null].filter(Boolean);return e(Oe.ActionBox,{actions:h,total:a()})};et.propTypes={onClickBtnImport:s.func,onClickBtnAdd:s.func,onClickBtnDeleteMultiApartment:s.func,selectAllRowComponent:s.func,visibleDeleteBtn:s.bool,exportApartmentState:s.objectOf(s.any),onClickBtnExportDataApartment:s.func,isAdmin:s.bool};et.defaultProps={onClickBtnImport:()=>{},onClickBtnAdd:()=>{},onClickBtnDeleteMultiApartment:()=>{},selectAllRowComponent:()=>{},visibleDeleteBtn:!1,exportApartmentState:{},onClickBtnExportDataApartment:()=>{},isAdmin:!1};const tt=({loading:n,apartments:o,onClickBtnUpdateApartment:l,onClickBtnDeleteApartment:a,pagination:c,rowSelection:r,isAdmin:g})=>{var M;const{layoutScrollRef:f}=T.useContext(ht),u=Mt(),{getPermissionByModuleCode:S}=fe(),i=lo()===so,h=((M=S(Ie))==null?void 0:M[Se])??!1,k=[{title:t.unit,key:"name",dataIndex:"name",width:150},{title:t.floor,key:"floor",dataIndex:"floor",width:150},{title:t.apartment_type,key:"apartmentType",dataIndex:"apartmentType",width:200},{title:t.area,key:"area",dataIndex:"area",width:150},{title:t.build_status,key:"buildStatus",dataIndex:"buildStatus",isFilter:!0,width:150},{title:t.date_of_taking_apartment,key:"dateOfTakingApartment",dataIndex:"dateOfTakingApartment",width:200,render:d=>d?B(d).format("DD/MM/YYYY"):""},h?{title:t.actions,key:"actions",dataIndex:"actions",width:100,align:"center",fixed:"right",render:(d,p)=>[e(K,{title:t.update,style:{marginRight:u.margin.xs,fontSize:u.iconSize},name:"icon-edit-outlined",onClick:()=>l(p.apartment)},"update"),g?e(K,{title:t.delete,style:{fontSize:u.iconSize},name:"icon-minus-circle-outlined",onClick:()=>a(p.apartment)},"delete"):null].filter(Boolean)}:null].filter(Boolean),O=o.map(d=>{var p,D,w,x,I;return{key:d.id,id:d.id,name:d.name,floor:d.floorName,apartmentType:i?Lo((D=(p=d==null?void 0:d.unitType)==null?void 0:p.id)==null?void 0:D.replace(/_/g," ")):((w=d==null?void 0:d.unitType)==null?void 0:w.name)??"",area:d.area,buildStatus:((I=(x=co)==null?void 0:x[d.buildStatus])==null?void 0:I.name)??"",dateOfTakingApartment:d.dateOfTakingApartment,apartment:d}});return e(Oe.Table,{sticky:{offsetScroll:u.offsetScrollX,getContainer:()=>f.current},pagination:c,rowSelection:r,loading:n,columns:k,dataSource:O,scroll:{x:k.reduce((d,p)=>d+p.width,0)}})};tt.propTypes={loading:s.bool,apartments:s.arrayOf(s.any),onClickBtnUpdateApartment:s.func,onClickBtnDeleteApartment:s.func,pagination:s.objectOf(s.any),rowSelection:s.objectOf(s.any),isAdmin:s.bool};tt.defaultProps={loading:!1,apartments:[],onClickBtnUpdateApartment:()=>{},onClickBtnDeleteApartment:()=>{},pagination:{},rowSelection:{},isAdmin:!1};var hi={name:"4zleql",styles:"display:block"};const ot=({hideModal:n,idBuilding:o,floors:l,apartmentTypes:a,refreshTableData:c,labels:r})=>{const g=ce(),[f]=_.useForm(),{checkIsUsedIntegrate:u}=Ge(),S=u($e),[i,h]=T.useState({code:void 0,codeLanguage:void 0,isFetching:!1}),{labelsCustomerCodeData:k}=He();ie(i.code,i.codeLanguage,{message:t.success,description:t.add_data_success},()=>{n(),c()});const O=async()=>{if(f.setFieldsValue({...we(f.getFieldsValue(),{})}),await f.validateFields()){const p=f.getFieldValue("dateOfTakingApartment"),D={name:f.getFieldValue("name"),floorId:f.getFieldValue("floorId"),unitTypeId:f.getFieldValue("unitTypeId"),buildStatus:f.getFieldValue("buildStatus"),area:f.getFieldValue("area"),useArea:f.getFieldValue("useArea"),bedroom:f.getFieldValue("bedroom"),bathroom:f.getFieldValue("bathroom"),storey:f.getFieldValue("storey"),balcony:f.getFieldValue("balcony"),localAddress:f.getFieldValue("localAddress"),direction:f.getFieldValue("direction"),window:f.getFieldValue("window"),description:f.getFieldValue("description"),labelId:f.getFieldValue("customerCode"),dateOfTakingApartment:p?B(p).toISOString():void 0,apt:f.getFieldValue("apt"),unitGroupId:Number(o),paymentServiceCode:{WATER:f.getFieldValue("paymentWaterServiceCode"),ELECTRIC:f.getFieldValue("paymentElectricServiceCode")},labelIds:f.getFieldValue("labelIds")};h({code:void 0,codeLanguage:void 0,isFetching:!0}),g(jo({idBuilding:o,apartment:D,refreshState:({code:w,codeLanguage:x})=>{h({code:w,codeLanguage:x,isFetching:!1})}}))}},M=()=>{n()};return e(ue,{title:t.add_apartment,okButtonProps:{loading:i.isFetching,disabled:i.isFetching},open:!0,okText:t.confirm,cancelText:t.cancel,onOk:O,onCancel:M,width:"50%",children:e(_,{initialValues:{name:""},layout:"vertical",form:f,name:"formAddApartment",children:R(re,{gutter:[12,0],children:[e(A,{span:12,children:e(_.Item,{rules:[{required:!0}],name:"name",label:t.unit,children:e(Y,{placeholder:t.unit})})}),e(A,{span:12,children:e(_.Item,{rules:[{required:!0}],name:"unitTypeId",label:t.apartment_type,children:e(E,{fluid:"true",placeholder:t.apartment_type,children:a.map(d=>e(E.Option,{value:d.id,children:d.name},d.id))})})}),e(A,{span:12,children:e(_.Item,{rules:[{required:!0}],name:"floorId",label:t.floor,children:e(E,{fluid:"true",placeholder:t.floor,children:l.map(d=>e(E.Option,{value:d.id,children:d.name},d.id))})})}),e(A,{span:12,children:e(_.Item,{name:"buildStatus",label:t.build_status,children:e(E,{allowClear:!0,fluid:"true",placeholder:t.build_status,children:Re.map(d=>e(E.Option,{value:d.id,children:d.name},d.id))})})}),e(A,{span:24,children:e(_.Item,{name:"labelIds",label:t.label.label,children:e(E,{showSearch:!0,optionFilterProp:"children",filterOption:(d,p)=>{var D,w;return Le((w=(D=p==null?void 0:p.children)==null?void 0:D.props)==null?void 0:w.children).indexOf(Le(d))>=0},getPopupContainer:d=>d.parentNode,placeholder:t.label.label,fluid:"true",mode:"multiple",maxTagCount:"responsive",children:r==null?void 0:r.map(({id:d,title:p,color:D})=>e(E.Option,{value:d,children:e(gt,{color:D??"default",css:hi,children:p})},d))})})}),e(A,{span:12,children:e(_.Item,{name:"area",label:t.area,children:e(G,{placeholder:t.area})})}),e(A,{span:12,children:e(_.Item,{name:"useArea",label:t.usage_area,children:e(G,{placeholder:t.usage_area})})}),e(A,{span:12,children:e(_.Item,{name:"bedroom",label:t.bedroom,children:e(G,{placeholder:t.bedroom})})}),e(A,{span:12,children:e(_.Item,{name:"bathroom",label:t.bathroom,children:e(G,{placeholder:t.bathroom})})}),e(A,{span:12,children:e(_.Item,{name:"window",label:t.window,children:e(G,{placeholder:t.window})})}),e(A,{span:12,children:e(_.Item,{name:"balcony",label:t.balcony,children:e(G,{placeholder:t.balcony})})}),e(A,{span:12,children:e(_.Item,{name:"localAddress",label:t.address,children:e(Y,{placeholder:t.address})})}),e(A,{span:12,children:e(_.Item,{name:"direction",label:t.direction,children:e(Y,{placeholder:t.direction})})}),e(A,{span:12,children:e(_.Item,{name:"storey",label:t.amount_floor,children:e(Y,{placeholder:t.floor})})}),e(A,{span:12,children:e(_.Item,{name:"customerCode",label:t.customer_code,children:e(E,{fluid:"true",placeholder:t.customer_code,children:k.map(d=>e(E.Option,{value:d.id,children:d.title},d.id))})})}),e(A,{span:12,children:e(_.Item,{name:"dateOfTakingApartment",label:t.date_of_taking_apartment,children:e(de,{format:"DD/MM/YYYY",allowClear:!1,fluid:!0,placeholder:t.date_of_taking_apartment})})}),S?e(A,{span:12,children:e(_.Item,{name:"apt",label:t.apt_code,children:e(G,{placeholder:t.apt_code})})}):null,e(A,{span:12,children:e(_.Item,{name:"paymentWaterServiceCode",label:t.payment_water_service_code,children:e(Y,{placeholder:t.payment_water_service_code})})}),e(A,{span:12,children:e(_.Item,{name:"paymentElectricServiceCode",label:t.payment_electric_service_code,children:e(Y,{placeholder:t.payment_electric_service_code})})}),e(A,{span:24,children:e(_.Item,{name:"description",label:t.description,children:e(Y.TextArea,{placeholder:t.description})})})]})})})};ot.propTypes={hideModal:s.func,idBuilding:s.oneOfType([s.number,s.string]),floors:s.arrayOf(s.any),apartmentTypes:s.arrayOf(s.any),refreshTableData:s.func,labels:s.arrayOf(s.any)};ot.defaultProps={hideModal:()=>{},idBuilding:0,floors:[],apartmentTypes:[],refreshTableData:()=>{},labels:[]};var fi={name:"4zleql",styles:"display:block"};const it=({hideModal:n,idBuilding:o,floors:l,apartment:a,apartmentTypes:c,refreshTableData:r,labels:g})=>{var p,D,w,x;const f=ce(),[u]=_.useForm(),{checkIsUsedIntegrate:S}=Ge(),i=S($e),[h,k]=T.useState({code:void 0,codeLanguage:void 0,isFetching:!1}),{labelsCustomerCodeData:O}=He();ie(h.code,h.codeLanguage,{message:t.success,description:t.update_data_success},()=>{n(),r()});const M=async()=>{if(u.setFieldsValue({...we(u.getFieldsValue(),{})}),await u.validateFields()){const P=u.getFieldValue("dateOfTakingApartment"),N={name:u.getFieldValue("name"),floorId:u.getFieldValue("floorId"),unitTypeId:u.getFieldValue("unitTypeId"),buildStatus:u.getFieldValue("buildStatus")??null,area:u.getFieldValue("area"),useArea:u.getFieldValue("useArea"),bedroom:u.getFieldValue("bedroom"),bathroom:u.getFieldValue("bathroom"),storey:u.getFieldValue("storey"),balcony:u.getFieldValue("balcony"),localAddress:u.getFieldValue("localAddress"),direction:u.getFieldValue("direction"),window:u.getFieldValue("window"),description:u.getFieldValue("description"),labelId:u.getFieldValue("customerCode"),dateOfTakingApartment:P?B(P).toISOString():void 0,apt:u.getFieldValue("apt"),unitGroupId:Number(o),paymentServiceCode:{WATER:u.getFieldValue("paymentWaterServiceCode"),ELECTRIC:u.getFieldValue("paymentElectricServiceCode")},labelIds:u.getFieldValue("labelIds")};k({code:void 0,codeLanguage:void 0,isFetching:!0}),f(Wo({idBuilding:o,idApartment:a.id,apartment:N,refreshState:({code:F,codeLanguage:W})=>{k({code:F,codeLanguage:W,isFetching:!1})}}))}},d=()=>{n()};return e(ue,{title:t.update_apartment,okButtonProps:{loading:h.isFetching,disabled:h.isFetching},open:!0,okText:t.confirm,cancelText:t.cancel,onOk:M,onCancel:d,width:"50%",children:e(_,{initialValues:{name:a.name,floorId:a.floorId,unitTypeId:a.unitTypeId,buildStatus:a.buildStatus||void 0,area:a.area||0,useArea:a.useArea||0,bedroom:a.bedroom||0,bathroom:a.bathroom||0,storey:a.storey||0,balcony:a.balcony||0,localAddress:a.localAddress,direction:a.direction,window:a.window||0,description:a.description,customerCode:a.labelId||void 0,dateOfTakingApartment:a.dateOfTakingApartment?B(a.dateOfTakingApartment):void 0,apt:a.apt||void 0,paymentWaterServiceCode:(p=a==null?void 0:a.paymentServiceCode)==null?void 0:p.WATER,paymentElectricServiceCode:(D=a==null?void 0:a.paymentServiceCode)==null?void 0:D.ELECTRIC,labelIds:(w=a==null?void 0:a.labels)!=null&&w.length?(x=a==null?void 0:a.labels)==null?void 0:x.map(I=>I==null?void 0:I.id):void 0},layout:"vertical",form:u,name:"formUpdateApartment",requiredMark:!1,children:R(re,{gutter:[12,0],children:[e(A,{span:12,children:e(_.Item,{rules:[{required:!0}],name:"name",label:`${t.name} *`,children:e(Y,{placeholder:t.name})})}),e(A,{span:12,children:e(_.Item,{rules:[{required:!0}],name:"unitTypeId",label:`${t.apartment_type} *`,children:e(E,{fluid:"true",placeholder:t.apartment_type,children:c.map(I=>e(E.Option,{value:I.id,children:I.name},I.id))})})}),e(A,{span:12,children:e(_.Item,{rules:[{required:!0}],name:"floorId",label:`${t.floor} *`,children:e(E,{fluid:"true",placeholder:t.floor,children:l.map(I=>e(E.Option,{value:I.id,children:I.name},I.id))})})}),e(A,{span:12,children:e(_.Item,{name:"buildStatus",label:t.build_status,children:e(E,{allowClear:!0,fluid:"true",placeholder:t.build_status,children:Re.map(I=>e(E.Option,{value:I.id,children:I.name},I.id))})})}),e(A,{span:24,children:e(_.Item,{name:"labelIds",label:t.label.label,children:e(E,{showSearch:!0,optionFilterProp:"children",filterOption:(I,P)=>{var N,F;return Le((F=(N=P==null?void 0:P.children)==null?void 0:N.props)==null?void 0:F.children).indexOf(Le(I))>=0},getPopupContainer:I=>I.parentNode,placeholder:t.label.label,fluid:"true",mode:"multiple",maxTagCount:"responsive",children:g==null?void 0:g.map(({id:I,title:P,color:N})=>e(E.Option,{value:I,children:e(gt,{color:N??"default",css:fi,children:P})},I))})})}),e(A,{span:12,children:e(_.Item,{name:"area",label:t.area,children:e(G,{placeholder:t.area})})}),e(A,{span:12,children:e(_.Item,{name:"useArea",label:t.usage_area,children:e(G,{placeholder:t.usage_area})})}),e(A,{span:12,children:e(_.Item,{name:"bedroom",label:t.bedroom,children:e(G,{placeholder:t.bedroom})})}),e(A,{span:12,children:e(_.Item,{name:"bathroom",label:t.bathroom,children:e(G,{placeholder:t.bathroom})})}),e(A,{span:12,children:e(_.Item,{name:"window",label:t.window,children:e(G,{placeholder:t.window})})}),e(A,{span:12,children:e(_.Item,{name:"balcony",label:t.balcony,children:e(G,{placeholder:t.balcony})})}),e(A,{span:12,children:e(_.Item,{name:"localAddress",label:t.address,children:e(Y,{placeholder:t.address})})}),e(A,{span:12,children:e(_.Item,{name:"direction",label:t.direction,children:e(Y,{placeholder:t.direction})})}),e(A,{span:12,children:e(_.Item,{name:"storey",label:t.amount_floor,children:e(Y,{placeholder:t.floor})})}),e(A,{span:12,children:e(_.Item,{name:"customerCode",label:t.customer_code,children:e(E,{allowClear:!0,fluid:"true",placeholder:t.customer_code,children:O.map(I=>e(E.Option,{value:I.id,children:I.title},I.id))})})}),e(A,{span:12,children:e(_.Item,{name:"dateOfTakingApartment",label:t.date_of_taking_apartment,children:e(de,{format:"DD/MM/YYYY",allowClear:!1,fluid:!0,placeholder:t.date_of_taking_apartment})})}),i?e(A,{span:12,children:e(_.Item,{name:"apt",label:t.apt_code,children:e(G,{disabled:!0,placeholder:t.apt_code})})}):null,e(A,{span:12,children:e(_.Item,{name:"paymentWaterServiceCode",label:t.payment_water_service_code,children:e(Y,{placeholder:t.payment_water_service_code})})}),e(A,{span:12,children:e(_.Item,{name:"paymentElectricServiceCode",label:t.payment_electric_service_code,children:e(Y,{placeholder:t.payment_electric_service_code})})}),e(A,{span:24,children:e(_.Item,{name:"description",label:t.description,children:e(Y.TextArea,{placeholder:t.description})})})]})})})};it.propTypes={hideModal:s.func,idBuilding:s.oneOfType([s.number,s.string]),floors:s.arrayOf(s.any),apartment:s.objectOf(s.any),apartmentTypes:s.arrayOf(s.any),refreshTableData:s.func,labels:s.arrayOf(s.any)};it.defaultProps={hideModal:()=>{},idBuilding:0,floors:[],apartment:void 0,apartmentTypes:[],refreshTableData:()=>{},labels:[]};const gi=(n,o)=>{var c,r;const l=o==null?void 0:o[n==null?void 0:n.index],a={errorDescription:(c=n==null?void 0:n.errorDescription)!=null&&c.length?n==null?void 0:n.errorDescription:void 0,...l};if((r=a==null?void 0:a.errorDescription)!=null&&r.length)return a},bi=async({idBuilding:n,listData:o,apartmentTypes:l,isLast:a})=>{var c;try{const r={},g=uo(l,"name"),f=o==null?void 0:o.map(i=>{var h,k,O,M,d;return r[i==null?void 0:i.index]=i,{...i,name:(i==null?void 0:i.name)||void 0,unitType:i!=null&&i.unitType?(h=g[i==null?void 0:i.unitType])==null?void 0:h.id:void 0,floor:(i==null?void 0:i.floor)||void 0,buildStatus:i!=null&&i.buildStatus?(k=po[i==null?void 0:i.buildStatus])==null?void 0:k.id:void 0,dateOfTakingApartment:i!=null&&i.dateOfTakingApartment?B(i==null?void 0:i.dateOfTakingApartment,Eo).toDate():void 0,area:(i==null?void 0:i.area)||void 0,useArea:(i==null?void 0:i.useArea)||void 0,bedroom:(i==null?void 0:i.bedroom)||void 0,bathroom:(i==null?void 0:i.bathroom)||void 0,storey:(i==null?void 0:i.storey)||void 0,balcony:(i==null?void 0:i.balcony)||void 0,window:(i==null?void 0:i.window)||void 0,localAddress:(i==null?void 0:i.localAddress)||void 0,direction:(i==null?void 0:i.direction)||void 0,description:(i==null?void 0:i.description)||void 0,label:(i==null?void 0:i.label)||void 0,note:(i==null?void 0:i.note)||void 0,electric:(i==null?void 0:i.electric)||void 0,water:(i==null?void 0:i.water)||void 0,apt:(i==null?void 0:i.apt)||void 0,virtualAccountCode:(i==null?void 0:i.virtualAccountCode)||void 0,beneficiaryName:(i==null?void 0:i.beneficiaryName)||void 0,labels:(O=i==null?void 0:i.labels)!=null&&O.length?(d=(M=i==null?void 0:i.labels)==null?void 0:M.split(","))==null?void 0:d.map(p=>p==null?void 0:p.trim()):void 0}}),u=await mo({idBuilding:n,listData:f,isLast:a}),S=[];return(c=u==null?void 0:u.data)==null||c.forEach(i=>{const h=gi(i,r);h!=null&&h.errorDescription&&S.push(h)}),{code:u==null?void 0:u.code,codeLanguage:u==null?void 0:u.codeLanguage,data:S}}catch(r){return{code:r==null?void 0:r.code,codeLanguage:r==null?void 0:r.codeLanguage,data:[]}}},{rules:yi}=_t,{dateImportRule:_i}=yi,Ue=100,at=n=>{const{idBuilding:o,hideModal:l,refreshTableData:a,labels:c}=n,{checkIsUsedIntegrate:r}=Ge(),g=r($e),f=ce(),[u,S]=T.useState(0),{apartmentTypes:i}=ft(),[h,k]=T.useState({isFetching:!1,code:void 0,codeLanguage:void 0,totalSuccess:0,totalFailed:0,errors:[]});ie(h.code,h.codeLanguage,{message:t.success,description:t.import_data_success});const O=[{name:"#",key:"index",rules:{type:"number",required:!0},isRequiredColumn:!0},{name:t.unit,key:"unitName",rules:{type:"string",required:!0,max:50},isRequiredColumn:!0},{name:t.apartment_type,key:"unitType",rules:{type:"enum",required:!0,enum:i==null?void 0:i.map(d=>d==null?void 0:d.name)},isRequiredColumn:!0},{name:t.floor,key:"floor",rules:{type:"string",required:!0,max:50},isRequiredColumn:!0},{name:t.build_status,key:"buildStatus",rules:{type:"string",validator(d,p,D,w,x){var P,N;const I=(P=Re)==null?void 0:P.map(F=>F.name);if(p===""||p===void 0)return!0;if(!I.includes(p)){const F=I.join(", ");return new Error((N=x.messages.enum)==null?void 0:N.replace(/{enum}/,F))}return!0}},isRequiredColumn:!0},{name:t.label.label,key:"labels",rules:{type:"string",validator(d,p,D,w,x){if(p===""||p===void 0)return!0;const I=(p==null?void 0:p.split(","))??[],P=c==null?void 0:c.map(F=>F==null?void 0:F.title),N=I==null?void 0:I.filter(F=>!P.includes(F==null?void 0:F.trim()));if((N==null?void 0:N.length)===1){const F=P.join(", ");return new Error(t.validate.enum_file.replace(/{enum}/,F))}return!0}},isRequiredColumn:!0},{name:t.date_of_taking_apartment,key:"dateOfTakingApartment",rules:_i,isRequiredColumn:!0},{name:t.area,key:"area",rules:{type:"number",validator(d,p,D,w,x){var I;return p&&p<0?new Error(t.area_must_greater_or_equal_than_min.replace("{min}",0)):p&&p>9999999?new Error(t.area_must_lower_or_equal_than_max.replace("{max}",9999999)):((I=p==null?void 0:p.toString())==null?void 0:I.length)>0&&Number.isNaN(Number(p))?new Error(t.area_must_be_a_number):!0}},isRequiredColumn:!0},{name:t.usage_area,key:"useArea",rules:{type:"number",validator(d,p,D,w,x){var I;return p&&p<0?new Error(t.area_must_greater_or_equal_than_min.replace("{min}",0)):p&&p>9999999?new Error(t.area_must_lower_or_equal_than_max.replace("{max}",9999999)):((I=p==null?void 0:p.toString())==null?void 0:I.length)>0&&Number.isNaN(Number(p))?new Error(t.area_must_be_a_number):p&&w[t.area]&&p>w[t.area]?new Error(t.usage_area_must_lower_or_equal_than_area):!0}},isRequiredColumn:!0},{name:t.bedroom,key:"bedroom",rules:{type:"number"},isRequiredColumn:!0},{name:t.bathroom,key:"bathroom",rules:{type:"number"},isRequiredColumn:!0},{name:t.amount_floor,key:"storey",rules:{type:"number"},isRequiredColumn:!0},{name:t.balcony,key:"balcony",rules:{type:"number"},isRequiredColumn:!0},{name:t.window,key:"window",rules:{type:"number"},isRequiredColumn:!0},{name:t.address,key:"localAddress",rules:{type:"string"},isRequiredColumn:!0},{name:t.direction,key:"direction",rules:{type:"string",max:50},isRequiredColumn:!0},{name:t.description,key:"description",rules:{type:"string",max:50},isRequiredColumn:!0},{name:t.customer_code,key:"label",rules:{type:"string"},isRequiredColumn:!0},{name:t.note,key:"note",rules:{type:"string"},isRequiredColumn:!0},{name:t.payment_electric_service_code,key:"electric",rules:{type:"string"},isRequiredColumn:!0},{name:t.payment_water_service_code,key:"water",rules:{type:"string"},isRequiredColumn:!0},{name:t.virtual_account,key:"virtualAccountCode",rules:{type:"string",pattern:/^[A-Z0-9]{5,20}$/,message:t.virtual_account_invalid,min:5,max:20},isRequiredColumn:!1},{name:t.beneficiary_name,key:"beneficiaryName",rules:{type:"string",pattern:/^[A-Z0-9-_ ]{5,55}$/,message:t.beneficiary_name_invalid,min:5,max:55},isRequiredColumn:!1},g?{name:t.apt_code,key:"apt",rules:{type:"number"},isRequiredColumn:!0}:null].filter(Boolean);return e(_t,{headers:O,onClose:l,onOk:async d=>{var N;k({isFetching:!0,code:void 0,codeLanguage:void 0,totalSuccess:0,totalFailed:0,errors:[]});let p=[],D=0;const w={code:500,codeLanguage:null,errors:[]};let x=!1;for(let F=0;F<(d==null?void 0:d.length);F+=1){p.push(d[F]);const W=(d==null?void 0:d.length)%Ue;if((d.length<Ue||F===d.length-W)&&(x=!0),p.length===Ue||F===d.length-1){D+=p==null?void 0:p.length;const{code:C,codeLanguage:v,data:U}=await bi({idBuilding:o,listData:p,apartmentTypes:i,isLast:x});if(w.code=C,w.codeLanguage=v,w.errors=[...w.errors,...U],v===ho){a(),f(Be({idBuilding:o}));break}p=[],S(Math.floor(D*100/(d==null?void 0:d.length)))}}S(0);const I=(N=w==null?void 0:w.errors)==null?void 0:N.length,P=D-I;Ve.includes(w.code)&&(a(),f(Be({idBuilding:o}))),k({isFetching:!1,code:w.code,codeLanguage:w.codeLanguage,totalFailed:I,totalSuccess:P,errors:w==null?void 0:w.errors})},visible:!0,fileNameTemplate:t.apartment_info_template,code:h.code,codeLanguage:h.codeLanguage,loading:h.isFetching,numberSuccess:h==null?void 0:h.totalSuccess,numberFail:h==null?void 0:h.totalFailed,problemResponseServerDataSource:h==null?void 0:h.errors,percentImport:u})};at.propTypes={idBuilding:s.oneOfType([s.string,s.number]),hideModal:s.func,refreshTableData:s.func,labels:s.arrayOf(s.any)};at.defaultProps={refreshTableData:()=>{},hideModal:()=>{},idBuilding:0,labels:[]};const nt=({onSearch:n,floors:o,apartmentTypes:l,formFilter:a})=>{const c=T.useMemo(()=>[{label:t.name,key:"name",component:e(Y,{placeholder:t.name}),visible:!0},{label:t.floor,key:"floorId",component:R(E,{fluid:"true",placeholder:t.floor,children:[e(E.Option,{value:"",children:t.select_all_floor},"floor_0"),o.map(r=>e(E.Option,{value:r.id,children:r.name},r.id))]}),visible:!0},{label:t.apartment_type,key:"apartmentTypeId",component:R(E,{fluid:"true",placeholder:t.apartment_type,children:[e(E.Option,{value:"",children:t.select_all_apartment_type},"apartment_type_0"),l.map(r=>e(E.Option,{value:r.id,children:r.name},r.id))]}),visible:!0},{label:t.build_status,key:"buildStatus",component:R(E,{fluid:!0,placeholder:t.label.build_status,children:[e(E.Option,{value:"",children:t.all_build_status},"build_status_0"),Re.map(r=>e(E.Option,{value:r.id,children:r.name},r.id))]}),visible:!0},{label:t.date_of_taking_apartment,key:"dateOfTakingApartment",component:e(de.RangePicker,{allowClear:!0,fluid:!0,placeholder:["DD/MM/YYYY","DD/MM/YYYY"],format:["DD/MM/YYYY","DD/MM/YYYY"]}),visible:!0}],[o,l]);return e(Oe.FilterBox,{formData:a,defaultFilter:Te,onSearch:n,layout:"vertical",filters:c})};nt.propTypes={onSearch:s.func,floors:s.arrayOf(s.any),apartmentTypes:s.arrayOf(s.any),formFilter:s.objectOf(s.any)};nt.defaultProps={onSearch:()=>{},floors:[],apartmentTypes:[],formFilter:{}};const Fi=()=>{const{isAdmin:n}=fo(),o=ye(L=>L.configApartment.floors),l=ye(L=>L.configApartment.data),{apartmentTypes:a}=ft(),c=ye(L=>L.configApartment.totalData),r=ye(L=>L.configApartment.apartmentExportData),g=ce(),f=ze(),{idBuilding:u}=f,{labelData:S}=He(),[i,h]=T.useState(Ne),[k,O]=T.useState(V),[M,d]=T.useState([]),[p,D]=T.useState({...Te}),[w,x]=T.useState({isFetching:!1}),[I,P]=T.useState({isFetching:!1,code:void 0,codeLanguage:void 0}),[N,F]=T.useState({isFetching:!1,code:void 0,codeLanguage:void 0}),[W,C,v,U,pe]=No({dataRows:l,rowKey:"id",totalRows:c}),{selectedRowKeys:Ce,selectedRowKeysCache:me,isSelectAllItem:b}=W,[$,he,ae]=se(),[Q,ne,m]=se(),[Z,ee,te]=se(),[y]=_.useForm(),H=({filter:L,page:q,pageSize:Ae})=>{var le,ge;x({isFetching:!0}),g($o({idBuilding:u,filter:{name:L.name?L.name:void 0,floorId:L.floorId?L.floorId:void 0,apartmentType:L.apartmentTypeId?L.apartmentTypeId:void 0,buildStatus:L.buildStatus?L.buildStatus:void 0,dateOfTakingApartmentFrom:(le=L.dateOfTakingApartment)!=null&&le[0]?B(L.dateOfTakingApartment[0]).startOf("day").toISOString():void 0,dateOfTakingApartmentTo:(ge=L.dateOfTakingApartment)!=null&&ge[1]?B(L.dateOfTakingApartment[1]).endOf("day").toISOString():void 0},page:q,limit:Ae,refreshState:()=>{x({isFetching:!1})}}))};T.useEffect(()=>(yt.unstable_batchedUpdates(()=>{g(Be({idBuilding:u})),g(zo()),H({filter:Te,page:1,pageSize:V})}),()=>{g(Jo())}),[]),T.useEffect(()=>{const L=S==null?void 0:S.filter(q=>[go,bo].includes(q==null?void 0:q.type));d(L)},[S]),T.useEffect(()=>{r&&vo(r,document,"thong-tin-can-ho.xlsx")},[r]);const oe=L=>{D(L),O(V),h(Ne),H({filter:L,page:Ne,pageSize:V})},z=()=>{H({filter:Te,page:1,pageSize:V}),D({...Te}),C(),h(1),O(V),y.resetFields()};ie(I.code,I.codeLanguage,{message:t.success,description:t.delete_data_success},()=>{z()});const Me=()=>{he({idBuilding:u,floors:o,apartmentTypes:a})},Ct=()=>{ee()},At=L=>{ne({idBuilding:u,apartment:L,floors:o,apartmentTypes:a})},Tt=L=>{st({isAll:!1,loading:I.isFetching,questionText:t.do_you_want_to_delete_this_apartment,totalItem:1,onCancel:()=>{P({isFetching:!1,code:void 0,codeLanguage:void 0})},onOk:async()=>(P({isFetching:!0,code:void 0,codeLanguage:void 0}),new Promise((q,Ae)=>{g(Qo({idBuilding:u,idApartment:L.id,refreshState:({code:le,codeLanguage:ge})=>(P({isFetching:!1,code:le,codeLanguage:ge}),le===200?q():Ae())}))}))})},kt=()=>{const L=t.do_you_want_to_delete_apartment.replace("{item}",b?t.all.toLowerCase():me.length);st({isAll:b,loading:I.isFetching,questionText:L,totalItem:me.length,onCancel:()=>{P({isFetching:!1,code:void 0,codeLanguage:void 0})},onOk:async()=>(P({isFetching:!0,code:void 0,codeLanguage:void 0}),new Promise((q,Ae)=>{g(Ko({idBuilding:u,idApartments:me,isAll:b,filterObject:p,refreshState:({code:le,codeLanguage:ge})=>(P({isFetching:!1,code:le,codeLanguage:ge}),le===200?q():Ae())}))}))})},wt=(L,q)=>{L!==i&&h(L),q!==k&&O(q),H({filter:p,page:L,pageSize:q})},Ot=()=>{F({code:void 0,codeLanguage:void 0,isFetching:!0}),g(Xo({idBuilding:u,filter:p,refreshState:({code:L,codeLanguage:q})=>{F({code:L,codeLanguage:q,isFetching:!1})}}))};return R(Fe,{children:[e(nt,{apartmentTypes:a,floors:o,onSearch:oe,formFilter:y}),R(J,{style:{flex:1},children:[e(J.Header,{children:e(et,{exportApartmentState:N,visibleDeleteBtn:b||me.length>0,selectAllRowComponent:pe,onClickBtnImport:Ct,onClickBtnAdd:Me,onClickBtnDeleteMultiApartment:kt,onClickBtnExportDataApartment:Ot,isAdmin:n})}),e(J.Content,{fluid:!0,children:e(tt,{rowSelection:n?{selectedRowKeys:Ce,onSelect:v,onSelectAll:U,fixed:!0}:null,pagination:{pageSize:k,defaultCurrent:1,current:i,total:c,showQuickJumper:!0,showSizeChanger:!0,onChange:wt},tablePage:i,tablePageSize:k,onClickBtnUpdateApartment:At,onClickBtnDeleteApartment:Tt,apartments:l,loading:w.isFetching,isAdmin:n})}),e(J.Footer,{}),$.isShow&&e(ot,{floors:$.data.floors,apartmentTypes:$.data.apartmentTypes,refreshTableData:z,idBuilding:$.data.idBuilding,hideModal:ae,labels:M}),Q.isShow&&e(it,{refreshTableData:z,idBuilding:Q.data.idBuilding,apartmentTypes:Q.data.apartmentTypes,floors:Q.data.floors,apartment:Q.data.apartment,hideModal:m,labels:M}),Z.isShow&&e(at,{refreshTableData:z,idBuilding:u,hideModal:te,labels:M})]})]})},sn=()=>{const{setTitlePage:n,setVisibleSearchBox:o,setVisibleFilterBox:l}=T.useContext(ht),{checkPermissionViewByModuleCodes:a}=fe(),c=a([{code:mt,permissionAction:_e},{code:qe,permissionAction:_e}])||!1,r=a([{code:Ie,permissionAction:_e}])||!1,[g,f]=T.useState(c?De:rt);return T.useEffect(()=>(n(t.configs_buildings),o(!0),()=>{n(""),o(!1),l(!1)}),[]),e("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:R(re,{style:{flex:1},gutter:[12,0],children:[e(A,{span:4,children:e(je,{activeMenuItem:g,handleSelectMenuItem:S=>{l(!1),f(S)},permissionReadBuilding:c,permissionReadUnit:r})}),R(A,{style:{display:"flex",flexDirection:"column",flex:1},span:20,children:[g===De&&c?e(ci,{}):null,g===rt&&r?e(mi,{}):null,g===yo&&r?e(Fi,{}):null]})]})})};export{sn as default};
