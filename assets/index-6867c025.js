import{j as t,a as R,u as Pe,F as rt,c as Le,b as J}from"./@emotion-63839449.js";import{P as $,o as st,b as Ie,n as ce,k as Ee,D as ee,w as ct,d as lt,a as _e,F as dt}from"./index-b17d22e5.js";import{l as a,by as Oe,a9 as Y,s as N,b0 as je,K as de,aU as Xe,at as Se,bv as Je,ag as ut,i as te,A as me,M as ne,X as ae,ea as pt,e4 as mt,j as ht,I as j,a as Ke,S as Me,c6 as Ge,b1 as gt,w as yt}from"./index-c2ded735.js";import{r as S}from"./react-4fd50329.js";import"./react-redux-896b353b.js";import"./lodash-88fe09e6.js";import{h as v}from"./moment-a468e1f9.js";import"./file-saver-40cf32a9.js";import"./@firebase-43527ee1.js";import{P as C}from"./prop-types-1172f4d5.js";import{F,u as he}from"./index-687ba9e6.js";import{u as Q}from"./react-router-a4308f7b.js";import{d as ft}from"./downloadFileFromUrl-79614833.js";import{B as ue,w as Qe,G as Ze,T as ze,R as et,b as U,k as $e,S as Ue,n as St,P as At}from"./antd-f9eae174.js";import{I as K,S as O}from"./index-43183512.js";import{g as _t}from"./department-807891d3.js";import{g as wt}from"./partner-15abd2bf.js";import{P as xe}from"./index-d2c5b7c0.js";import{a as vt}from"./staff-2880022d.js";import{I as tt}from"./index-0335a746.js";import{e as xt}from"./exportExcel-837be6ed.js";import"./hoist-non-react-statics-23d96a9a.js";import"./react-is-e8e5dbb3.js";import"./@babel-b64fd0f9.js";import"./stylis-79144faa.js";import"./react-router-dom-2a8f5f6d.js";import"./history-a1882333.js";import"./resolve-pathname-e210f2ac.js";import"./tiny-invariant-dd7d57d2.js";import"./account-86ffff50.js";import"./index-881eef42.js";import"./libphonenumber-js-0d5a9c92.js";import"./react-infinite-scroll-component-e33646cb.js";import"./redux-10bbab4c.js";import"./react-dom-40621ea0.js";import"./classnames-4ba1ba1a.js";import"./scheduler-765c72db.js";import"./@redux-saga-8bafe09b.js";import"./redux-logger-e1c9ca90.js";import"./dompurify-8e338605.js";import"./query-string-f5cca1e7.js";import"./decode-uri-component-4138e85d.js";import"./split-on-first-4f1167c8.js";import"./filter-obj-2ed190f4.js";import"./oidc-client-7da0eaf7.js";import"./firebase-878887a2.js";import"./rc-pagination-c1e6a0ac.js";import"./rc-picker-2e3d5fe5.js";import"./rc-util-0bc219f3.js";import"./rc-trigger-570b13ec.js";import"./rc-motion-ae889c42.js";import"./rc-align-e5d7b12e.js";import"./dom-align-ecb06dd6.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./rc-resize-observer-b9ad4e29.js";import"./@ant-design-cba9d434.js";import"./@ctrl-fb5a5473.js";import"./rc-tabs-dfd19a56.js";import"./rc-dropdown-5378dd0a.js";import"./rc-menu-b15ebfe9.js";import"./rc-overflow-6be96612.js";import"./rc-select-564caf01.js";import"./rc-virtual-list-8a7b82a6.js";import"./rc-collapse-11b7d3c4.js";import"./shallowequal-4542d6f7.js";import"./rc-drawer-317f0b4d.js";import"./@rc-component-5a112e55.js";import"./rc-field-form-ef5549aa.js";import"./async-validator-dee29e8b.js";import"./scroll-into-view-if-needed-6b992d05.js";import"./compute-scroll-into-view-183f845a.js";import"./rc-image-e0357917.js";import"./rc-dialog-b1d1f07b.js";import"./rc-input-number-8bc068f7.js";import"./rc-rate-c64cf0d5.js";import"./rc-steps-2d1924c7.js";import"./rc-switch-b4e96de7.js";import"./rc-table-191ecc42.js";import"./rc-checkbox-018e8052.js";import"./rc-tree-67773537.js";import"./rc-tree-select-cb7eccc3.js";import"./copy-to-clipboard-64585c8c.js";import"./toggle-selection-93f4ad84.js";import"./rc-textarea-d01adcbb.js";import"./rc-input-02c2c2ba.js";import"./rc-upload-3ab0f08a.js";import"./rc-notification-d13dc43b.js";import"./rc-progress-4f1a7096.js";import"./rc-tooltip-08fa4217.js";import"./use-sync-external-store-5d1b6592.js";import"./idb-cdd1a92f.js";import"./path-to-regexp-ef8d5544.js";import"./regex-deefadac.js";import"./xlsx-0fb7ed70.js";import"./uuid-4a60fe23.js";const oe={asset:void 0,assetCode:void 0,status:"",departmentId:"",maintenanceStatus:""},Te={asset:void 0,maintenanceBy:void 0,status:"",maintenanceAt:void 0},Mt="UNIT_GROUP",nt="FLOOR",at="UNIT",Tt=[{value:Mt,label:a.building},{value:nt,label:a.floor},{value:at,label:a.apartment}],Ce="ACTIVE",Ct="DISABLED",Dt="IN_STOCK",De=[{value:Ce,label:a.label.active1,color:"success"},{value:Ct,label:a.unused,color:"default"},{value:Dt,label:a.in_stock,color:"red"}],Ft="true",It="false",it=[{value:Ft,label:a.yes},{value:It,label:a.no}],{DOCUMENT_FILE_SIZE:Et}={VITE_REACT_APP_URL:"https://pms.cyhome.vn",VITE_API_URL:"https://api.cyhome.vn/api",VITE_API_BILL_URL:"https://api.cyhome.vn/api",VITE_API_PAYMENT_URL:"https://api.cyhome.vn/api",VITE_NOTIFICATION_SERVER_URL:"https://api.cyhome.vn/api/notifications/v1",VITE_PARSE_SERVER_URL:"https://chat.cyhome.vn/api",VITE_PARSE_SERVER_APPLICATION_ID:"Tl56zQjitDrKUS9APwTG0PGslfJ6jWwf",VITE_PARSE_SERVER_REST_API_KEY:"Q4zR0HJd0l9p1PXzS6eGb49A7RY6NnOJ",VITE_PARSE_SERVER_JAVASCRIPT_KEY:"ZqQUlEXweMtEpRPtxXA1PIDZPjcS3ZCk",VITE_FCM_KEY_PAIR:"BOqlGaKbz_3hWtRXrIy0C2yxgPbZgcWVwJiyuWVXgB4lX_cif6mzEVYBtDYVVs5ka_dcBkt6pva_yyRWMYQQhgs",VITE_FCM_SENDER_ID:"96068949844",VITE_FCM_PROJECT_ID:"cyhome-cyfeer",VITE_FCM_API_KEY:"AIzaSyDuvS5RBCLHET_sIUk73swCkrZSr-Y5h0Q",VITE_FCM_APP_ID:"1:96068949844:web:57d54beb5a5a7a087edac1",VITE_PAYMENT_ONLINE_EMAIL:"maidtt@cyfeer.com,dungvdp@cyfeer.com",VITE_ACCOUNT_CREATE_BUILDING:"maidtt@cyfeer.com,dungvdp@cyfeer.com,thanhtp@cyfeer.com,maitt@cyfeer.com",VITE_MAX_PROCESS_PRINT_INVOICE:"5",VITE_CAPTCHA_KEY:"6LeO1qgZAAAAAAUqRKAivUMylloJhAG7o3iCDhiW",VITE_COOKIE_TAG:"cyhome",VITE_AUTH_METHOD:"NORMAL",VITE_GA_MEASUREMENT_ID:"G-QQ98JH1DDS",VITE_ENV:"PRODUCTION",VITE_DOCUMENT_FILE_SIZE:"10",VITE_WHITE_LABEL:"CYHOME",VITE_SURVEY_FORM_URL:"https://tally.so/r/w2BqxD",VITE_BUILDING_USE_REPORT_DEBT_NEW:"301,118",VITE_IS_USE_CLARITY:"true",VITE_POLICY_EN_URL:"https://cyhome-dns.s3-ap-southeast-1.amazonaws.com/terms-and-conditions/CyHomeTandC-en.pdf",VITE_POLICY_VI_URL:"https://cyhome-dns.s3-ap-southeast-1.amazonaws.com/terms-and-conditions/CyHomeTandC-vi.pdf",VITE_PORT:"9002",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},pe=Oe(De,"value"),bt=Oe(Tt,"value");Oe(it,"value");const X=S.createContext({idBuilding:0,isShowActionAdd:!1,isShowActionUpdate:!1,isShowActionUpdateStatus:!1,isShowActionDelete:!1,isShowActionImport:!1,isShowActionExport:!1,isShowActionViewHistoryMaintenance:!1,formFilter:void 0,filter:{...oe},setFilter:()=>{},tableData:{records:[],totalRecord:0},setTableData:()=>{},tablePagination:{current:Y,limit:N},setTablePagination:()=>{},getListAssetStatus:{isFetching:!1},setGetListAssetStatus:()=>{},modalAddAsset:void 0,showModalAddAsset:()=>{},hideModalAddAsset:()=>{},modalUpdateAsset:void 0,showModalUpdateAsset:()=>{},hideModalUpdateAsset:()=>{},modalImportAsset:void 0,showModalImportAsset:()=>{},hideModalImportAsset:()=>{},modalHistoryMaintenanceAsset:void 0,showModalHistoryMaintenanceAsset:()=>{},hideModalHistoryMaintenanceAsset:()=>{},modalUpdateAssetStatus:void 0,showModalUpdateAssetStatus:()=>{},hideModalUpdateAssetStatus:()=>{}}),Re=({children:e})=>{const{idBuilding:n}=Q(),{getPermissionByModuleCode:r}=je(),[c,s]=S.useState({isFetching:!1}),[o,l]=S.useState({...oe}),[i,m]=S.useState({records:[],totalRecord:0}),[y,h]=S.useState({current:Y,limit:N}),[u]=F.useForm(),[g,x,A]=de(),[d,f,D]=de(),[E,k,P]=de(),[I,L,q]=de(),[B,V,H]=de(),T=r(Xe),ge=(T==null?void 0:T[Se])??!1,ye=(T==null?void 0:T[Se])??!1,fe=(T==null?void 0:T[Se])??!1,_=(T==null?void 0:T[Se])??!1,M=(T==null?void 0:T[Se])??!1,p=(T==null?void 0:T[Je])??!1,w=(T==null?void 0:T[ut])??!1,b={idBuilding:n,isShowActionAdd:ge,isShowActionUpdate:ye,isShowActionUpdateStatus:fe,isShowActionDelete:_,isShowActionImport:M,isShowActionExport:p,isShowActionViewHistoryMaintenance:w,formFilter:u,filter:o,setFilter:l,tableData:i,setTableData:m,tablePagination:y,setTablePagination:h,getListAssetStatus:c,setGetListAssetStatus:s,modalAddAsset:g,showModalAddAsset:x,hideModalAddAsset:A,modalUpdateAsset:d,showModalUpdateAsset:f,hideModalUpdateAsset:D,modalImportAsset:I,showModalImportAsset:L,hideModalImportAsset:q,modalHistoryMaintenanceAsset:B,showModalHistoryMaintenanceAsset:V,hideModalHistoryMaintenanceAsset:H,modalUpdateAssetStatus:E,showModalUpdateAssetStatus:k,hideModalUpdateAssetStatus:P};return t(X.Provider,{value:b,children:e})};Re.propTypes={children:C.node};Re.defaultProps={children:t("div",{})};const Ut=Re,ie=`${ht}/asset`,Pt=`${ie}/list`,Lt=ie,Ot=e=>`${ie}/${e}`,Rt=`${ie}/import-data`,Yt=`${ie}/export-data`,Nt=e=>`${ie}/${e}`,kt=e=>`${ie}/${e}/status`,Bt=`${ie}/history`,Vt=async({idBuilding:e,filter:n,page:r,limit:c})=>{const s={[ae]:e},o={...n,page:r,limit:c};return te({type:me,payload:{apiUrl:Pt,method:ne.GET,options:{params:o,headers:s}}})};async function Ht(e,n){const r={[ae]:e};return te({type:pt,payload:{apiUrl:Rt,file:n,method:ne.POST,options:{headers:r}}})}async function Wt(e,n){const r={[ae]:e};return te({type:me,payload:{apiUrl:Lt,body:{...n},method:ne.POST,options:{headers:r}}})}async function qt(e,n,r){const c={[ae]:e};return te({type:me,payload:{apiUrl:Ot(n),body:{...r},method:ne.PUT,options:{headers:c}}})}const Gt=async({idAsset:e,nextMaintain:n,idBuilding:r,status:c,note:s})=>{const o={[ae]:r};return te({type:me,payload:{apiUrl:kt(e),body:{nextMaintain:n,status:c,note:s},method:ne.PUT,options:{headers:o}}})},zt=async(e,n)=>{const r={[ae]:e};return te({type:me,payload:{apiUrl:Nt(n),method:ne.DELETE,options:{headers:r}}})},$t=async({idBuilding:e,filter:n,page:r,limit:c})=>{const s={[ae]:e},o={...n,page:r,limit:c};return te({type:me,payload:{apiUrl:Bt,method:ne.GET,options:{headers:s,params:o}}})};async function jt(e,n){const r={[ae]:e},c={...n};return te({type:mt,payload:{apiUrl:Yt,method:ne.GET,options:{headers:r,params:c}}})}const Xt=async(e,n)=>{try{const{asset:r,assetCode:c,status:s,departmentId:o,maintenanceStatus:l}=n,{code:i,codeLanguage:m,data:y}=await jt(e,{name:r||void 0,assetCode:c||void 0,status:s||void 0,departmentId:o||void 0,maintenanceStatus:l||void 0});return{code:i,codeLanguage:m,data:y}}catch({code:r,codeLanguage:c}){return{code:r,codeLanguage:c,data:void 0}}},Jt=()=>{const{idBuilding:e}=Q(),{filter:n,isShowActionViewHistoryMaintenance:r,isShowActionAdd:c,isShowActionExport:s,isShowActionImport:o,tableData:l,showModalAddAsset:i,showModalImportAsset:m,showModalHistoryMaintenanceAsset:y}=S.useContext(X),[h,u]=S.useState({isFetching:!1,code:void 0,codeLanguage:void 0});he(h.code,h.codeLanguage,{message:a.success,description:a.export_data_success});const g=()=>{m()},x=async()=>{u({isFetching:!0,code:void 0,codeLanguage:void 0});const f=await Xt(e,n);f.data&&ft(f.data,document,"thong-tin-thiet-bi.xlsx"),u({isFetching:!1,code:f.code,codeLanguage:f.codeLanguage})},A=()=>{i()},d=()=>{y()};return{isShowActionViewHistoryMaintenance:r,isShowActionAdd:c,isShowActionImport:o,isShowActionExport:s,loadingExport:h.isFetching,totalRecord:l.totalRecord,handleImportListAsset:g,handleExportListAsset:x,handleAddAsset:A,handleViewHistoryMaintenance:d}};function Kt(){const{isShowActionViewHistoryMaintenance:e,isShowActionAdd:n,isShowActionImport:r,isShowActionExport:c,loadingExport:s,totalRecord:o,handleImportListAsset:l,handleExportListAsset:i,handleAddAsset:m,handleViewHistoryMaintenance:y}=Jt(),h=[e?t(ue,{css:u=>({marginRight:u.margin.xs}),type:"primary",ghost:!0,icon:t(j,{name:"icon-history-outlined"}),onClick:y,children:a.history},"history"):null,c?t(ue,{css:u=>({marginRight:u.margin.xs}),loading:s,type:"primary",ghost:!0,icon:t(j,{name:"icon-download-outlined"}),onClick:i,children:a.export},"export"):null,r?t(ue,{css:u=>({marginRight:u.margin.xs}),type:"primary",ghost:!0,icon:t(j,{name:"icon-upload-outlined"}),onClick:l,children:a.import},"import"):null,n?t(ue,{type:"primary",icon:t(j,{name:"icon-plus-circle-outlined"}),onClick:m,children:a.add},"add"):null];return t($.ActionBox,{actions:h,total:o})}const Qt=e=>({id:e==null?void 0:e.id,name:(e==null?void 0:e.name)??""}),Ye=async e=>{try{const{code:n,codeLanguage:r,data:c,totalRecord:s}=await _t(e);return{code:n,codeLanguage:r,data:c.map(o=>Qt(o)),totalRecord:s}}catch({code:n,codeLanguage:r}){return{code:n,codeLanguage:r,data:[],totalRecord:0}}},Zt=e=>({id:e==null?void 0:e.id,name:(e==null?void 0:e.companyName)??""}),Ae=async({idBuilding:e,filter:n,page:r,limit:c})=>{try{const{name:s}=n,{code:o,codeLanguage:l,data:i,totalRecord:m}=await wt({filter:{companyName:s||void 0},idBuilding:e,limit:c,page:r});return{code:o,codeLanguage:l,data:i.map(y=>Zt(y)),totalRecord:m}}catch({code:s,codeLanguage:o}){return{code:s,codeLanguage:o,data:[],totalRecord:0}}},en=e=>{var n,r,c,s,o,l,i,m,y,h,u;return{id:e==null?void 0:e.id,key:e==null?void 0:e.key,code:e==null?void 0:e.assetCode,name:e==null?void 0:e.name,createdAt:e==null?void 0:e.createdAt,setupAt:e==null?void 0:e.setupDate,dateOfStartingToUse:e==null?void 0:e.startDate,status:(e==null?void 0:e.status)??"",isMaintenanceStatus:(e==null?void 0:e.maintenanceStatus)??!1,maintenanceStatus:e!=null&&e.maintenanceStatus?a.yes:a.no,managerUnit:{id:(n=e==null?void 0:e.department)==null?void 0:n.id,name:((r=e==null?void 0:e.department)==null?void 0:r.name)??""},maintenanceUnit:{id:(c=e==null?void 0:e.maintenanceUnit)==null?void 0:c.id,name:((s=e==null?void 0:e.maintenanceUnit)==null?void 0:s.companyName)??""},producer:(e==null?void 0:e.producer)??"",provider:{id:(o=e==null?void 0:e.supplier)==null?void 0:o.id,name:(l=e==null?void 0:e.supplier)==null?void 0:l.companyName},bill:{code:(e==null?void 0:e.billNo)??"",price:(e==null?void 0:e.price)??0},placeType:(e==null?void 0:e.placeType)??"",location:(e==null?void 0:e.location)??"",floor:{id:(i=e==null?void 0:e.floor)==null?void 0:i.id,name:((m=e==null?void 0:e.floor)==null?void 0:m.name)??""},apartment:{id:(y=e==null?void 0:e.unit)==null?void 0:y.id,name:((h=e==null?void 0:e.unit)==null?void 0:h.name)??""},lastMaintenance:(e==null?void 0:e.lastMaintain)??"",lastMaintenanceFormat:e!=null&&e.lastMaintain?v(e==null?void 0:e.lastMaintain).format("DD/MM/YYYY"):"",nextMaintenance:e==null?void 0:e.nextMaintenanceDate,warrantyCycle:(e==null?void 0:e.rangeDate)??"",warrantyCode:(e==null?void 0:e.warrantyCode)??"",dateOfExpiredWarranty:e==null?void 0:e.warrantyExpiredDate,note:(e==null?void 0:e.note)??"",locationType:e!=null&&e.placeType?(u=bt[e==null?void 0:e.placeType])==null?void 0:u.label:"",assetType:(e==null?void 0:e.assetType)??"",quantity:(e==null?void 0:e.quantity)??0,calculatorUnit:(e==null?void 0:e.calculatorUnit)??"",entryDate:(e==null?void 0:e.entryDate)??"",nextMaintenanceDate:(e==null?void 0:e.nextMaintenanceDate)??"",nextMaintenanceDateFormat:e!=null&&e.nextMaintenanceDate?v(e==null?void 0:e.nextMaintenanceDate).format("DD/MM/YYYY"):"",employee:e==null?void 0:e.employee,assetCategory:e.assetCategory,assetSpecification:e.assetSpecification,origin:e.origin,entryCode:e.entryCode}},tn=async({idBuilding:e,filter:n,page:r,limit:c})=>{try{const{asset:s,assetCode:o,status:l,departmentId:i,maintenanceStatus:m}=n,{code:y,codeLanguage:h,data:u,totalRecord:g}=await Vt({filter:{name:s||void 0,assetCode:o||void 0,status:l||void 0,departmentId:i||void 0,maintenanceStatus:m||void 0},idBuilding:e,limit:c,page:r});return{code:y,codeLanguage:h,data:u.map(x=>en(x)),totalRecord:g}}catch({code:s,codeLanguage:o}){return{code:s,codeLanguage:o,data:[],totalRecord:0}}},re=()=>{const{setTableData:e,idBuilding:n,setGetListAssetStatus:r}=S.useContext(X);return{changeDataTable:async({filter:s,page:o,limit:l})=>{r({isFetching:!0});const i=await tn({filter:s,idBuilding:n,limit:l,page:o});e({records:i.data,totalRecord:i.totalRecord}),r({isFetching:!1})}}},nn=()=>{const{idBuilding:e}=Q(),{setFilter:n,formFilter:r,setTablePagination:c}=S.useContext(X),{changeDataTable:s}=re(),[o,l]=S.useState({isFetching:!1,records:[]}),[i,m]=S.useState({isFetching:!1,records:[]}),y=async u=>{n(u),c({current:Y,limit:N}),await s({filter:{...u},page:Y,limit:N})};S.useEffect(()=>{(async()=>{m({isFetching:!0,records:[]});const[u]=await Promise.all([Ye(e)]);m({isFetching:!1,records:u.data})})()},[]);const h=async u=>{l({...o,isFetching:!0});const{data:g}=await Ae({filter:{name:u},idBuilding:e,limit:N,page:Y});l({isFetching:!1,records:g})};return S.useEffect(()=>{(async()=>await h(""))()},[]),{loadingMaintenanceUnit:o.isFetching,listMaintenanceUnit:o.records,onSearch:y,formFilter:r,handleSearchMaintenanceUnit:h,listDepartment:i.records}},an=()=>{const{onSearch:e,formFilter:n,listDepartment:r}=nn(),c=S.useMemo(()=>[{label:a.asset_name,key:"asset",component:t(K,{placeholder:a.asset,fluid:!0}),visible:!0},{label:a.asset_code,key:"assetCode",component:t(K,{placeholder:a.asset_code,fluid:!0}),visible:!0},{label:a.status1,key:"status",component:R(O,{fluid:!0,children:[t(O.Option,{value:"",children:a.all_status},"status_0"),De.map(({label:s,value:o})=>t(O.Option,{value:o,children:s},o))]}),visible:!0},{label:a.manager_unit,key:"departmentId",component:R(O,{fluid:!0,children:[t(O.Option,{value:"",children:a.all_manager_unit},"managerUnit_0"),r.map(({id:s,name:o})=>t(O.Option,{value:s,children:o},s))]}),visible:!0},{label:a.status_maintenance,key:"maintenanceStatus",component:R(O,{fluid:!0,placeholder:a.status_maintenance,children:[t(O.Option,{value:"",children:a.all},"maintenanceStatus_0"),it.map(({value:s,label:o})=>t(O.Option,{value:s,children:o},s))]}),visible:!0}],[r]);return t($.FilterBox,{defaultFilter:oe,filters:c,formData:n,onSearch:e})},on=async(e,n)=>{try{const{code:r,codeLanguage:c}=await zt(e,n);return{code:r,codeLanguage:c}}catch({code:r,codeLanguage:c}){return{code:r,codeLanguage:c}}},rn=()=>{const{idBuilding:e}=Q(),{layoutScrollRef:n}=S.useContext(Ke),{isShowActionUpdate:r,isShowActionDelete:c,isShowActionUpdateStatus:s,getListAssetStatus:o,tablePagination:l,setTablePagination:i,filter:m,showModalUpdateAsset:y,tableData:h,showModalUpdateAssetStatus:u}=S.useContext(X),{changeDataTable:g}=re(),x=Pe(),[A,d]=S.useState({isFetching:!1,code:void 0,codeLanguage:void 0});he(A.code,A.codeLanguage,{message:a.success,description:a.delete_data_success});const f=async(B,V)=>{let{limit:H,current:T}=l;T!==B?T=B:H!==V&&(T=Y,H=V),i({limit:H,current:T}),await g({filter:{...m},page:T,limit:H})},D=B=>{y({...B})},E=(B,V)=>{u({...V,nextStatus:B})},k=async B=>{st({loading:A.isFetching,onCancel:()=>{d({isFetching:!1,code:void 0,codeLanguage:void 0})},isAll:!1,onOk:async()=>{d({isFetching:!0,code:void 0,codeLanguage:void 0});const V=await on(e,B.id),H=Me.includes(V.code);return H&&await g({filter:{...m},page:l.current,limit:l.limit}),d({isFetching:!1,code:V.code,codeLanguage:V.codeLanguage}),H?Promise.resolve():Promise.reject()},questionText:a.do_you_want_to_delete_asset,totalItem:1})},P=h.records,I={current:l.current,pageSize:l.limit,total:h.totalRecord,showQuickJumper:!0,showSizeChanger:!0,onChange:f},L={offsetScroll:x.offsetScrollX,getContainer:()=>n.current},q={scrollToFirstRowOnChange:!0};return{loading:o.isFetching,isShowActionUpdate:r,isShowActionDelete:c,isShowActionUpdateStatus:s,handleUpdateAsset:D,handleDeleteAsset:k,handleUpdateStatusAsset:E,dataSource:P,pagination:I,scroll:q,sticky:L}},ve=Le("div",{target:"e15pfzuc0"})({name:"1ml69g3",styles:"width:210px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis"});var sn={name:"e0dnmk",styles:"cursor:pointer"};function cn(){const{loading:e,isShowActionUpdate:n,isShowActionDelete:r,handleUpdateAsset:c,handleDeleteAsset:s,dataSource:o,pagination:l,scroll:i,sticky:m}=rn(),y=[{title:a.code_asset,key:"code",dataIndex:"code",fixed:"left",width:150},{title:a.status1,key:"status",width:150,fixed:"left",render:(h,u)=>{var g,x;return t(Qe,{css:sn,color:((g=pe[u.status])==null?void 0:g.color)??"default",children:((x=pe[u.status])==null?void 0:x.label)??"-"})}},{title:a.status_maintenance,key:"isMaintenanceStatus",width:150,fixed:"left",render:(h,u)=>t(Ze,{checked:u.isMaintenanceStatus,disabled:!0})},{title:a.manager_unit,key:"managerUnit",width:150,fixed:"left",render:(h,u)=>u.managerUnit.name},{title:a.staff_in_charge,key:"employee",dataIndex:"employee",width:200},{title:a.asset_name,key:"name",dataIndex:"name",width:220,render:(h,u)=>{const g=h;return(g==null?void 0:g.length)>20?t(ze,{title:g,placement:"topLeft",children:t(ve,{children:g})}):t(ve,{children:g})}},{title:a.quantity,key:"quantity",dataIndex:"quantity",width:120},{title:a.unit_asset,key:"calculatorUnit",dataIndex:"calculatorUnit",width:150},{title:a.last_maintenance,key:"lastMaintenanceFormat",dataIndex:"lastMaintenanceFormat",width:150},{title:a.next_maintenance_date,key:"nextMaintenanceDateFormat",dataIndex:"nextMaintenanceDateFormat",width:180},{title:a.note,key:"note",dataIndex:"note",width:220,render:(h,u)=>{const g=h;return(g==null?void 0:g.length)>20?t(ze,{title:g,placement:"topLeft",children:t(ve,{children:g})}):t(ve,{children:g})}},{title:a.actions,key:"action",fixed:"right",align:"center",width:150,render:(h,u)=>R(rt,{children:[n&&!u.inactiveAt?t(j,{css:g=>({fontSize:g.iconSize}),onClick:()=>c(u),name:"icon-edit-outlined",title:a.update}):null,r&&!u.inactiveAt?t(j,{css:g=>({fontSize:g.iconSize,marginLeft:g.margin.sm}),onClick:()=>s(u),name:"icon-minus-circle-outlined",title:a.delete}):null]})}];return t($.Table,{columns:y,dataSource:o,loading:e,pagination:l,scroll:{...i,x:y.reduce((h,u)=>h+u.width,0)},sticky:m})}var ln={name:"99halj",styles:"color:#2424f3"};const dn=Le("span",{target:"e12wum5z0"})("cursor:pointer;width:85%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;",e=>e.isUploaded&&ln,";"),Ne=({file:e,handlePreviewAttachment:n})=>t(dn,{title:e.name,onClick:()=>n(e),children:e.name});Ne.propTypes={file:C.arrayOf(C.object),handlePreviewAttachment:C.arrayOf(C.func)};Ne.defaultProps={file:{},handlePreviewAttachment:()=>{}};const un=Le("div",{target:"e1pi619b0"})({name:"seoft9",styles:"display:flex;justify-content:space-between;margin:10px;&:hover{background:#f7f7f7;}"}),ke=({file:e,handlePreviewAttachment:n,handleRemoveFile:r})=>{const c=Pe();return R(un,{children:[R(et,{style:{flexFlow:"row"},children:[t(j,{name:"icon-attachment-outlined",css:J({fontsize:c.iconSize,marginRight:c.margin.xs},"","")}),t(Ne,{file:e,handlePreviewAttachment:n})]}),t(j,{name:"icon-delete-outlined",css:J({fontsize:c.iconSize,marginLeft:c.margin.xs},"",""),onClick:()=>{r(e==null?void 0:e.uid)}})]},e)};ke.propTypes={file:C.arrayOf(C.object),handlePreviewAttachment:C.arrayOf(C.func),handleRemoveFile:C.arrayOf(C.func)};ke.defaultProps={file:{},handlePreviewAttachment:()=>{},handleRemoveFile:()=>{}};var pn={name:"1kevbid",styles:"& .ant-upload{width:100%;}"};const Fe=({loadingProvider:e,loadingWarrantyUnit:n,handleSearchProvider:r,handleSearchWarrantyUnit:c,listProvider:s,listDepartment:o,listWarrantyUnit:l,listStaff:i,handlePreviewAttachment:m,fileList:y,handleChange:h,handleRemoveFile:u,handleSelectStaff:g,dataUpdateAsset:x})=>{const A=Pe();return R(et,{gutter:[A.margin.sm,0],children:[R(U,{span:"24",children:[t(j,{name:"icon-info-circle-filled",css:J({fontSize:A.iconSize,marginRight:A.margin.xs,color:A.color.primary},"","")}),t(Ie,{css:J({color:A.color.primary,fontWeight:A.fontWeight.bold},"",""),children:a.label.general_information})]}),t(U,{span:"8",children:t(F.Item,{rules:[{required:!0}],name:"status",label:a.current_status,children:t(O,{fluid:"true",optionFilterProp:"children",getPopupContainer:d=>d.parentNode,children:De.map(({label:d,value:f})=>t(O.Option,{value:f,children:d},f))})})}),t(U,{span:"8",children:t(F.Item,{name:"managerUnit",label:a.manager_unit,rules:[{required:!0}],children:t(O,{fluid:"true",placeholder:a.manager_unit,optionFilterProp:"children",getPopupContainer:d=>d.parentNode,showSearch:!0,filterOption:(d,f)=>ce(f.children).indexOf(ce(d))>=0,allowClear:!0,children:o.map(({id:d,name:f})=>t(O.Option,{value:d,children:f},d))})})}),R(U,{span:"8",children:[t(F.Item,{name:"employee",label:a.staff_in_charge,rules:[{required:!0}],children:t($e,{filterOption:(d,f)=>{var D,E;return((E=(D=f==null?void 0:f.value)==null?void 0:D.toUpperCase())==null?void 0:E.indexOf(d.toUpperCase()))!==-1},placeholder:a.staff_in_charge,onSelect:(d,f)=>{g(f)},children:i==null?void 0:i.map(({id:d,name:f})=>t($e.Option,{value:f,children:f},d))})}),t(F.Item,{name:"employeeId"})]}),t(U,{span:"8",children:t(F.Item,{name:"maintenanceStatus",valuePropName:"checked",label:a.status_maintenance,children:t(Ze,{checkedChildren:a.yes,unCheckedChildren:a.no,disabled:!0})})}),R(U,{span:"24",children:[t(j,{name:"icon-info-circle-filled",css:J({fontSize:A.iconSize,marginRight:A.margin.xs,color:A.color.primary},"","")}),t(Ie,{css:J({color:A.color.primary,fontWeight:A.fontWeight.bold},"",""),children:a.detail_information})]}),t(U,{span:"8",children:t(F.Item,{name:"assetCode",label:a.asset_code,rules:[{required:!0}],children:t(K,{placeholder:a.asset_code})})}),t(U,{span:"8",children:t(F.Item,{name:"asset",label:a.asset_name,rules:[{required:!0}],children:t(K,{placeholder:a.asset_name})})}),t(U,{span:"8",children:t(F.Item,{name:"quantity",label:a.quantity,children:t(Ee,{min:"0",max:"1000000000000",formatter:d=>Ge(d),placeholder:a.quantity})})}),t(U,{span:"8",children:t(F.Item,{name:"calculatorUnit",label:a.unit_asset,children:t(K,{placeholder:a.unit_asset})})}),t(U,{span:"8",children:t(F.Item,{name:"setupAt",label:a.label.asset_setup_date,children:t(ee,{fluid:"true",format:"DD/MM/YYYY",placeholder:"DD/MM/YYYY",getPopupContainer:d=>d.parentNode})})}),t(U,{span:"8",children:t(F.Item,{name:"billCode",label:a.bill_code,children:t(K,{placeholder:a.bill_code})})}),t(U,{span:"8",children:t(F.Item,{name:"price",label:a.price,children:t(Ee,{min:"0",max:"1000000000000",formatter:d=>Ge(d),placeholder:a.price})})}),t(U,{span:"8",children:t(F.Item,{name:"provider",label:a.provider,children:t(O,{allowClear:!0,showSearch:!0,onSearch:r,dropdownRender:d=>e?t("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},children:t(Ue,{})}):d,fluid:"true",placeholder:a.provider,optionFilterProp:"children",getPopupContainer:d=>d.parentNode,filterOption:(d,f)=>ce(f.children).indexOf(ce(d))>=0,children:s.map(({id:d,name:f})=>t(O.Option,{value:d,children:f},d))})})}),t(U,{span:"8",children:t(F.Item,{name:"entryDate",label:a.entry_date,children:t(ee,{fluid:!0,format:"DD/MM/YYYY",placeholder:"DD/MM/YYYY",getPopupContainer:d=>d.parentNode})})}),t(U,{span:"8",children:t(F.Item,{name:"dateOfStartingToUse",label:a.date_of_starting_to_use,children:t(ee,{fluid:"true",format:"DD/MM/YYYY",placeholder:"DD/MM/YYYY",getPopupContainer:d=>d.parentNode})})}),t(U,{span:"8",children:t(F.Item,{name:"producer",label:a.producer,children:t(K,{placeholder:a.producer})})}),R(U,{span:"24",css:J({marginBottom:A.margin.sm},"",""),children:[t(F.Item,{name:"entryCode",label:a.entry_code,children:t(ct,{multiple:!0,maxCount:"10",css:pn,limitSizeFile:Et,onPreview:m,isUploadAllFile:!0,fileList:y,onChange:h,showUploadList:!1,children:t(ue,{icon:t(j,{name:"icon-attachment-outlined",css:J({fontsize:A.iconSize},"","")}),type:"primary",ghost:!0,block:!0,size:"default",children:a.attachments})})}),y.map(d=>t(ke,{file:d,handlePreviewAttachment:m,handleRemoveFile:u})),R("i",{css:J({fontSize:A.fontSize.sm,color:A.labelColor},"",""),children:["* ",a.file_format]})]}),R(U,{span:"24",children:[t(j,{name:"icon-info-circle-filled",css:J({fontSize:A.iconSize,marginRight:A.margin.xs,color:A.color.primary},"","")}),t(Ie,{css:J({color:A.color.primary,fontWeight:A.fontWeight.bold},"",""),children:a.warranty_information})]}),t(U,{span:"8",children:t(F.Item,{name:"warrantyCode",label:a.warranty_code,children:t(K,{placeholder:a.warranty_code})})}),t(U,{span:"8",children:t(F.Item,{name:"dateOfExpiredWarranty",label:a.date_of_expired_warranty,children:t(ee,{fluid:"true",format:"DD/MM/YYYY",placeholder:"DD/MM/YYYY",getPopupContainer:d=>d.parentNode})})}),t(U,{span:"8",children:t(F.Item,{name:"maintenanceUnit",label:a.warranty_unit,children:t(O,{allowClear:!0,showSearch:!0,onSearch:c,dropdownRender:d=>n?t("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},children:t(Ue,{})}):d,fluid:"true",placeholder:a.warranty_unit,optionFilterProp:"children",getPopupContainer:d=>d.parentNode,filterOption:(d,f)=>ce(f.children).indexOf(ce(d))>=0,children:l.map(({id:d,name:f})=>t(O.Option,{value:d,children:f},d))})})}),t(U,{span:"8",children:t(F.Item,{name:"lastMaintenance",label:a.last_maintenance,dependencies:["nextMaintenanceDate"],rules:[({getFieldValue:d})=>({validator(f,D){return D&&d("nextMaintenanceDate")&&v(D).isAfter(d("nextMaintenanceDate"))?Promise.reject(a.last_maintenance_must_lower_or_equal_than_next_maintenance_date):Promise.resolve()}})],children:t(ee,{allowClear:!1,fluid:"true",format:"DD/MM/YYYY",placeholder:"DD/MM/YYYY",getPopupContainer:d=>d.parentNode})})}),t(U,{span:"8",children:t(F.Item,{name:"warrantyCycle",label:a.warranty_cycle_day,children:t(Ee,{min:"1",max:Number.MAX_SAFE_INTEGER,placeholder:a.warranty_cycle_day})})}),t(U,{span:"8",children:t(F.Item,{name:"nextMaintenanceDate",label:a.next_maintenance_date,dependencies:["lastMaintenance"],rules:[({getFieldValue:d})=>({validator(f,D){return D&&d("lastMaintenance")&&v(D).isBefore(d("lastMaintenance"))?Promise.reject(a.last_maintenance_must_lower_or_equal_than_next_maintenance_date):Promise.resolve()}})],children:t(ee,{allowClear:!1,fluid:"true",format:"DD/MM/YYYY",placeholder:"DD/MM/YYYY",getPopupContainer:d=>d.parentNode})})}),t(U,{span:"24",children:t(F.Item,{name:"note",label:a.note,children:t(K.TextArea,{placeholder:a.note,rows:"4"})})})]})};Fe.propTypes={loadingProvider:C.bool,loadingWarrantyUnit:C.bool,handleSearchProvider:C.func,handleSearchWarrantyUnit:C.func,listProvider:C.arrayOf(C.any),listDepartment:C.arrayOf(C.any),listWarrantyUnit:C.arrayOf(C.any),listStaff:C.arrayOf(C.any),handlePreviewAttachment:C.arrayOf(C.func),fileList:C.arrayOf(C.any),handleChange:C.arrayOf(C.func),handleRemoveFile:C.arrayOf(C.func),dataUpdateAsset:C.objectOf(C.object),handleSelectStaff:C.func};Fe.defaultProps={loadingProvider:!1,loadingWarrantyUnit:!1,handleSearchProvider:()=>{},handleSearchWarrantyUnit:()=>{},listProvider:[],listDepartment:[],listWarrantyUnit:[],listStaff:[],handlePreviewAttachment:()=>{},fileList:[],handleChange:()=>{},handleRemoveFile:()=>{},dataUpdateAsset:{},handleSelectStaff:()=>{}};const mn=async(e,n,r)=>{try{const{asset:c,assetCode:s,setupAt:o,dateOfStartingToUse:l,warrantyCode:i,dateOfExpiredWarranty:m,billCode:y,price:h,provider:u,maintenanceUnit:g,managerUnit:x,producer:A,lastMaintenance:d,warrantyCycle:f,status:D,employee:E,quantity:k,calculatorUnit:P,entryDate:I,nextMaintenanceDate:L,note:q,employeeId:B}=n,V={name:c,assetCode:s||null,warrantyCode:i||null,startDate:l?v(l).startOf("day").toISOString():null,warrantyExpiredDate:m?v(m).startOf("day").toISOString():null,setupDate:o?v(o).startOf("day").toISOString():null,price:h||null,billNo:y||null,note:q||null,producer:A||null,status:D||Ce,rangeDate:f||null,lastMaintain:d?v(d).startOf("day").toISOString():null,departmentId:x||null,maintenanceUnitId:g||null,supplierId:u||null,employee:E||null,employeeId:B||null,quantity:k||null,calculatorUnit:P||null,entryDate:I?v(I).startOf("day").toISOString():null,entryCode:r||null,nextMaintenanceDate:L?v(L).startOf("day").toISOString():null},{code:H,codeLanguage:T}=await Wt(e,V);return{code:H,codeLanguage:T}}catch({code:c,codeLanguage:s}){return{code:c,codeLanguage:s}}},hn=e=>({id:e==null?void 0:e.userId,name:e==null?void 0:e.fullName}),Be=async({idBuilding:e,filter:n,page:r,limit:c})=>{const{name:s}=n;try{const{code:o,codeLanguage:l,data:i}=await vt({filter:{name:s||void 0},idBuilding:e,limit:c,page:r});return{code:o,codeLanguage:l,data:i.map(m=>hn(m))}}catch({code:o,codeLanguage:l}){return{code:o,codeLanguage:l,data:[]}}},gn=()=>{const{idBuilding:e}=Q(),[n]=F.useForm(),{hideModalAddAsset:r,setGetListAssetStatus:c,setFilter:s,setTablePagination:o,formFilter:l}=S.useContext(X),{changeDataTable:i}=re(),[m,y]=S.useState({isFetching:!1,records:[]}),[h,u]=S.useState({isFetching:!1,records:[]}),[g,x]=S.useState({isFetching:!1,records:[]}),[A,d]=S.useState({isFetching:!1,code:void 0,codeLanguage:void 0}),[f,D]=S.useState({isFetching:!1,records:[]}),[E,k]=S.useState([]),P=({file:_,fileList:M})=>{let p=M;_.status==="removed"&&(p=M),(_.status==="done"||_.status==="uploading")&&(p=M),_.status||(p=M.filter(w=>w.uid!==_.uid)),k(p.filter(w=>["done","uploading"].includes(w.status)))};he(A.code,A.codeLanguage,{message:a.success,description:a.add_data_success},()=>{r()});const I=_=>{var M,p,w,b;(p=(M=_==null?void 0:_.response)==null?void 0:M.data)!=null&&p.url?xe.open({url:(b=(w=_==null?void 0:_.response)==null?void 0:w.data)==null?void 0:b.url}):_!=null&&_.url&&xe.open(_!=null&&_.url?{url:_==null?void 0:_.url}:"")},L=async _=>{y({...m,isFetching:!0});const{data:M}=await Ae({filter:{name:_},idBuilding:e,limit:N,page:Y});y({records:M,isFetching:!1})},q=async _=>{u({...h,isFetching:!0});const{data:M}=await Ae({filter:{name:_},idBuilding:e,limit:N,page:Y});u({records:M,isFetching:!1})},B=(_,M)=>{if(_.lastMaintenance){if(!M.warrantyCycle&&M.nextMaintenanceDate){n.setFieldsValue({warrantyCycle:v(M.nextMaintenanceDate).diff(v(_.lastMaintenance),"days")+1});return}if(M.warrantyCycle){const p=v(M.lastMaintenance).add(M.warrantyCycle-1,"days");n.setFieldsValue({nextMaintenanceDate:p,maintenanceStatus:p.clone().isBefore(v(),"days")}),n.validateFields(["nextMaintenanceDate"]);return}}if(_.warrantyCycle){if(!M.lastMaintenance&&M.nextMaintenanceDate){n.setFieldsValue({lastMaintenance:v(M.nextMaintenanceDate).subtract(_.warrantyCycle-1,"days")});return}if(M.lastMaintenance){const p=v(M.lastMaintenance).add(_.warrantyCycle-1,"days");n.setFieldsValue({nextMaintenanceDate:p,maintenanceStatus:p.clone().isBefore(v(),"days")}),n.validateFields(["nextMaintenanceDate"]);return}}if(_.nextMaintenanceDate){if(n.setFieldsValue({maintenanceStatus:v(_.nextMaintenanceDate).isBefore(v(),"days")}),!M.lastMaintenance&&M.warrantyCycle){n.setFieldsValue({lastMaintenance:v(_.nextMaintenanceDate).subtract(M.warrantyCycle-1,"days")});return}M.lastMaintenance&&n.setFieldsValue({warrantyCycle:v(_.nextMaintenanceDate).diff(v(M.lastMaintenance),"days")+1})}},V=_=>{const M=E.filter(p=>p.uid!==_);k(M)},H=async()=>{var M;if(await n.validateFields()){const p=n.getFieldsValue(),w=n.getFieldValue("entryCode");let b=[];E!=null&&E.length?b=(E==null?void 0:E.map(G=>{var we,z;return((z=(we=G==null?void 0:G.response)==null?void 0:we.data)==null?void 0:z.url)??(G==null?void 0:G.url)}))??[]:b=((M=w==null?void 0:w.map(G=>(G==null?void 0:G.url)??null))==null?void 0:M.filter(Boolean))??[],d({isFetching:!0,code:void 0,codeLanguage:void 0});const{code:W,codeLanguage:Z}=await mn(e,p,b);d({isFetching:!1,code:W,codeLanguage:Z}),Me.includes(W)&&(c({isFetching:!0}),s({...oe}),l.resetFields(),o({limit:N,current:Y}),await i({filter:{...oe},page:Y,limit:N}))}},T=()=>{r()},ge=async _=>{D({...f,isFetching:!0});const{data:M}=await Be({filter:{name:_},idBuilding:e,limit:N,page:Y});D({records:M,isFetching:!1})};S.useEffect(()=>{(async()=>{x({isFetching:!0,records:[]});const[_]=await Promise.all([Ye(e),L(""),q(""),ge("")]);x({isFetching:!1,records:_.data})})()},[]);const ye={locationType:void 0,location:void 0,asset:void 0,assetCode:void 0,setupAt:void 0,dateOfStartingToUse:void 0,warrantyCode:void 0,dateOfExpiredWarranty:void 0,billCode:void 0,price:0,provider:void 0,maintenanceUnit:void 0,managerUnit:void 0,producer:void 0,lastMaintenance:void 0,warrantyCycle:void 0,status:Ce,maintenanceStatus:!1,note:void 0,employee:void 0,assetType:void 0,assetCategory:void 0,assetSpecification:void 0,origin:void 0,quantity:0,calculatorUnit:void 0,entryDate:void 0,entryCode:void 0,nextMaintenanceDate:void 0},fe=_=>{n.setFieldsValue({employee:_==null?void 0:_.value,employeeId:_==null?void 0:_.key})};return{loading:A.isFetching,loadingDepartment:g.isFetching,listDepartment:g.records,loadingProvider:m.isFetching,listProvider:m.records,loadingWarrantyUnit:h.isFetching,listWarrantyUnit:h.records,initialValues:ye,formAddAsset:n,onValuesChange:B,handleSearchProvider:L,handleSearchWarrantyUnit:q,handleAddAsset:H,handleCancelAddAsset:T,handlePreviewAttachment:I,handleChange:P,fileList:E,handleRemoveFile:V,listStaff:f==null?void 0:f.records,handleSelectStaff:fe}},yn=()=>{const{loading:e,formAddAsset:n,handleAddAsset:r,handleCancelAddAsset:c,handleSearchProvider:s,handleSearchWarrantyUnit:o,initialValues:l,listDepartment:i,listProvider:m,listWarrantyUnit:y,loadingDepartment:h,loadingProvider:u,loadingWarrantyUnit:g,onValuesChange:x,handlePreviewAttachment:A,fileList:d,handleChange:f,handleRemoveFile:D,listStaff:E,handleSelectStaff:k}=gn();return t(_e,{title:a.add_asset,visible:!0,okText:a.add,cancelText:a.cancel,onOk:r,onCancel:c,okButtonProps:{disabled:e,loading:e},width:"80%",children:t(F,{onValuesChange:lt(x),layout:"vertical",initialValues:l,form:n,name:"formAddAsset",children:t(Fe,{listDepartment:i,listProvider:m,listStaff:E,listWarrantyUnit:y,handleSearchProvider:s,handleSearchWarrantyUnit:o,loadingProvider:u,loadingWarrantyUnit:g,loadingDepartment:h,handlePreviewAttachment:A,fileList:d,handleChange:f,handleRemoveFile:D,handleSelectStaff:k})})})},fn=async(e,n,r,c)=>{try{const{asset:s,assetCode:o,setupAt:l,dateOfStartingToUse:i,warrantyCode:m,dateOfExpiredWarranty:y,billCode:h,price:u,provider:g,maintenanceUnit:x,managerUnit:A,producer:d,lastMaintenance:f,warrantyCycle:D,status:E,employee:k,quantity:P,calculatorUnit:I,entryDate:L,nextMaintenanceDate:q,note:B}=r,V={name:s,assetCode:o||null,warrantyCode:m||null,startDate:i?v(i).startOf("day").toISOString():null,warrantyExpiredDate:y?v(y).startOf("day").toISOString():null,setupDate:l?v(l).startOf("day").toISOString():null,price:u||null,billNo:h||null,note:B||null,producer:d||null,status:E||Ce,rangeDate:D||null,lastMaintain:f?v(f).startOf("day").toISOString():null,departmentId:A||null,maintenanceUnitId:x||null,supplierId:g||null,employee:k||null,quantity:P||null,calculatorUnit:I||null,entryDate:L?v(L).startOf("day").toISOString():null,entryCode:c||[],nextMaintenanceDate:q?v(q).startOf("day").toISOString():null},{code:H,codeLanguage:T}=await qt(e,n,V);return{code:H,codeLanguage:T}}catch({code:s,codeLanguage:o}){return{code:s,codeLanguage:o}}},Sn=()=>{var M;const{idBuilding:e}=Q(),[n]=F.useForm(),{hideModalUpdateAsset:r,modalUpdateAsset:c,filter:s,tablePagination:o}=S.useContext(X),{changeDataTable:l}=re(),{data:i}=c,[m,y]=S.useState(!1),[h,u]=S.useState({isFetching:!1,records:[]}),[g,x]=S.useState({isFetching:!1,records:[]}),[A,d]=S.useState({isFetching:!1,records:[]}),[f,D]=S.useState({isFetching:!1,code:void 0,codeLanguage:void 0}),[E,k]=S.useState({isFetching:!1,records:[]}),[P,I]=S.useState(((M=i==null?void 0:i.entryCode)==null?void 0:M.map(p=>({url:p,status:"done",name:p,isUploaded:!0})))??[]),L=({file:p,fileList:w})=>{let b=w;p.status==="removed"&&(b=w),(p.status==="done"||p.status==="uploading")&&(b=w),p.status||(b=w.filter(W=>W.uid!==p.uid)),I(b.filter(W=>["done","uploading"].includes(W.status)))};he(f.code,f.codeLanguage,{message:a.success,description:a.update_data_success},()=>{r()});const q=p=>{var w,b,W,Z;(b=(w=p==null?void 0:p.response)==null?void 0:w.data)!=null&&b.url?xe.open({url:(Z=(W=p==null?void 0:p.response)==null?void 0:W.data)==null?void 0:Z.url}):p!=null&&p.url&&xe.open(p!=null&&p.url?{url:p==null?void 0:p.url}:"")},B=async p=>{u({...h,isFetching:!0});const{data:w}=await Ae({filter:{name:p},idBuilding:e,limit:N,page:Y});u({records:w,isFetching:!1})},V=async p=>{x({...g,isFetching:!0});const{data:w}=await Ae({filter:{name:p},idBuilding:e,limit:N,page:Y});x({records:w,isFetching:!1})},H=(p,w)=>{if(p.lastMaintenance){if(!w.warrantyCycle&&w.nextMaintenanceDate){n.setFieldsValue({warrantyCycle:v(w.nextMaintenanceDate).diff(v(p.lastMaintenance),"days")+1});return}if(w.warrantyCycle){const b=v(w.lastMaintenance).add(w.warrantyCycle-1,"days");n.setFieldsValue({nextMaintenanceDate:b,maintenanceStatus:b.clone().isBefore(v(),"days")}),n.validateFields(["nextMaintenanceDate"]);return}}if(p.warrantyCycle){if(!w.lastMaintenance&&w.nextMaintenanceDate){n.setFieldsValue({lastMaintenance:v(w.nextMaintenanceDate).subtract(p.warrantyCycle-1,"days")});return}if(w.lastMaintenance){const b=v(w.lastMaintenance).add(p.warrantyCycle-1,"days");n.setFieldsValue({nextMaintenanceDate:b,maintenanceStatus:b.clone().isBefore(v(),"days")}),n.validateFields(["nextMaintenanceDate"]);return}}if(p.nextMaintenanceDate){if(n.setFieldsValue({maintenanceStatus:v(p.nextMaintenanceDate).isBefore(v(),"days")}),!w.lastMaintenance&&w.warrantyCycle){n.setFieldsValue({lastMaintenance:v(p.nextMaintenanceDate).subtract(w.warrantyCycle-1,"days")});return}w.lastMaintenance&&n.setFieldsValue({warrantyCycle:v(p.nextMaintenanceDate).diff(v(w.lastMaintenance),"days")+1})}},T=p=>{const w=P.filter(b=>b.uid!==p);I(w)},ge=async()=>{var w;if(await n.validateFields()){const b=n.getFieldsValue(),W=n.getFieldValue("entryCode");let Z=[];P!=null&&P.length?Z=(P==null?void 0:P.map(z=>{var We,qe;return((qe=(We=z==null?void 0:z.response)==null?void 0:We.data)==null?void 0:qe.url)??(z==null?void 0:z.url)}))??[]:Z=((w=W==null?void 0:W.map(z=>(z==null?void 0:z.url)??null))==null?void 0:w.filter(Boolean))??[],D({isFetching:!0,code:void 0,codeLanguage:void 0});const{code:G,codeLanguage:we}=await fn(e,i.id,b,Z);D({isFetching:!1,code:G,codeLanguage:we}),Me.includes(G)&&await l({filter:{...s},page:o.current,limit:o.limit})}},ye=()=>{r()},fe=p=>{(async()=>{k({...E,isFetching:!0});const{data:w}=await Be({filter:{name:p},idBuilding:e,limit:N,page:Y});k({records:w,isFetching:!1})})()};S.useEffect(()=>{(async()=>{var b;y(!0),d({isFetching:!0,records:[]});const[p]=await Promise.all([Ye(e),B(""),V(""),fe("")]);d({isFetching:!1,records:p.data});let{location:w}=i;i.locationType===at?w=i.apartment.id:i.locationType===nt&&(w=i.floor.id),n.setFieldsValue({locationType:i.locationType??(i==null?void 0:i.placeType),location:w,asset:i.name,assetCode:i.code,setupAt:i.setupAt?v(i.setupAt):void 0,dateOfStartingToUse:i.dateOfStartingToUse?v(i.dateOfStartingToUse):void 0,warrantyCode:i.warrantyCode,dateOfExpiredWarranty:i.dateOfExpiredWarranty?v(i.dateOfExpiredWarranty):void 0,billCode:i.bill.code,price:i.bill.price,provider:i.provider.id,maintenanceUnit:i.maintenanceUnit.id,managerUnit:i.managerUnit.id,producer:i.producer,lastMaintenance:i.lastMaintenance?v(i.lastMaintenance):void 0,warrantyCycle:i.warrantyCycle,status:i.status,note:i.note,maintenanceStatus:(i==null?void 0:i.isMaintenanceStatus)??!1,employee:i==null?void 0:i.employee,assetType:i.assetType,assetCategory:i.assetCategory,assetSpecification:i.assetSpecification,origin:i.origin,quantity:i.quantity,calculatorUnit:i.calculatorUnit,entryDate:i.entryDate?v(i.entryDate):void 0,entryCode:((b=i==null?void 0:i.entryCode)==null?void 0:b.map(W=>({url:W,status:"done",name:W})))??[],nextMaintenanceDate:i.nextMaintenanceDate?v(i.nextMaintenanceDate):void 0}),y(!1)})()},[]);const _=p=>{n.setFieldsValue({employee:p==null?void 0:p.value,employeeId:p==null?void 0:p.key})};return{loadingView:m,loading:f.isFetching,loadingDepartment:A.isFetching,listDepartment:A.records,loadingProvider:h.isFetching,listProvider:h.records,loadingWarrantyUnit:g.isFetching,listWarrantyUnit:g.records,listStaff:E==null?void 0:E.records,formUpdateAsset:n,onValuesChange:H,handleSearchProvider:B,handleSearchWarrantyUnit:V,handleUpdateAsset:ge,handleCancelUpdateAsset:ye,handlePreviewAttachment:q,handleChange:L,fileList:P,handleRemoveFile:T,originalAsset:i,handleSelectStaff:_}},An=()=>{const{loadingView:e,loading:n,formUpdateAsset:r,handleUpdateAsset:c,handleCancelUpdateAsset:s,handleSearchProvider:o,handleSearchWarrantyUnit:l,listDepartment:i,listFloor:m,listProvider:y,listWarrantyUnit:h,loadingDepartment:u,loadingFloor:g,loadingProvider:x,loadingWarrantyUnit:A,onValuesChange:d,handlePreviewAttachment:f,fileList:D,listStaff:E,handleChange:k,handleRemoveFile:P,originalAsset:I,handleSelectStaff:L}=Sn();return t(_e,{title:a.update_asset,visible:!0,okText:a.update,cancelText:a.cancel,onOk:c,onCancel:s,okButtonProps:{disabled:n,loading:n},width:"80%",children:R(F,{onValuesChange:d,layout:"vertical",form:r,name:"formUpdateAsset",children:[e?t(gt,{isLoading:!0}):null,t(Fe,{listDepartment:i,listFloor:m,listProvider:y,listStaff:E,listWarrantyUnit:h,handleSearchProvider:o,handleSearchWarrantyUnit:l,loadingProvider:x,loadingWarrantyUnit:A,loadingDepartment:u,loadingFloor:g,handlePreviewAttachment:f,fileList:D,handleChange:k,handleRemoveFile:P,dataUpdateAsset:I,handleSelectStaff:L})]})})},_n=async(e,n)=>{var r;try{const{code:c,codeLanguage:s,data:o}=await Ht(e,n);return{code:c,codeLanguage:s,totalSuccess:(o==null?void 0:o.success)??0,totalFailed:((o==null?void 0:o.errors)??[]).length,errors:((r=o==null?void 0:o.errors)==null?void 0:r.map(l=>({index:l.index,message:l.message,code:l.code})))??[],data:o}}catch({code:c,codeLanguage:s}){return{code:c,codeLanguage:s,totalSuccess:0,totalFailed:0,errors:[],data:void 0}}},{rules:wn}=tt,{dateImportRule:le}=wn,vn=[{name:"#",rules:{type:"number",required:!0}},{name:"Tên thiết bị",rules:{type:"string",required:!0,max:255}},{name:"Mã trang thiết bị",rules:{type:"string",required:!0,max:255}},{name:"Ngày lắp thiết bị",rules:le},{name:"Ngày bắt đầu sử dụng",rules:le},{name:"Mã bảo hành",rules:{type:"string",max:50}},{name:"Ngày hết hạn bảo hành",rules:le},{name:"Số hoá đơn",rules:{type:"string",max:50}},{name:"Giá",rules:{type:"number",max:Number.MAX_SAFE_INTEGER}},{name:"Nhà cung cấp",rules:{type:"string",max:255}},{name:"Đơn vị bảo trì",rules:{type:"string",max:255}},{name:"Đơn vị quản lý",rules:{type:"string",max:255,required:!0}},{name:"Nhà sản xuất",rules:{type:"string",max:255}},{name:"Ngày bảo trì trước",rules:le},{name:"Chu kỳ bảo trì",rules:{type:"number",max:Number.MAX_SAFE_INTEGER}},{name:"Trạng thái",rules:{required:!0,type:"enum",enum:["Đang sử dụng","Ngừng sử dụng","Tồn kho"]}},{name:"Nhân viên phụ trách",rules:{type:"string",max:255,required:!0}},{name:"Số lượng",rules:{type:"number"}},{name:"Đơn vị",rules:{type:"string",max:255}},{name:"Phiếu nhập kho",rules:{type:"string",max:255}},{name:"Ngày nhập kho",rules:le},{name:"Ngày bảo trì tiếp theo",rules:le},{name:"Ghi chú",rules:{type:"string",max:3e3}}],xn=()=>{const{idBuilding:e}=Q(),{hideModalImportAsset:n,setFilter:r,setTablePagination:c,formFilter:s}=S.useContext(X),{changeDataTable:o}=re(),[l,i]=S.useState({isFetching:!1,code:void 0,codeLanguage:void 0,totalSuccess:0,totalFailed:0,errors:[],data:[]});return he(l.code,l.codeLanguage,{message:a.success,description:a.import_data_success}),[vn,l,async h=>{i({isFetching:!0,code:void 0,codeLanguage:void 0,totalSuccess:0,totalFailed:0,errors:[],data:[]});const{code:u,codeLanguage:g,totalSuccess:x,totalFailed:A,errors:d,data:f}=await _n(e,h);x!==0&&(r({...oe}),s.resetFields(),c({current:Y,limit:N}),await o({filter:{...oe},page:Y,limit:N})),i({isFetching:!1,code:u,codeLanguage:g,totalSuccess:x,totalFailed:A,errors:d,data:f})},()=>n()]},Mn=()=>{var s;const[e,n,r,c]=xn();return t(tt,{headers:e,onClose:c,onOk:r,visible:!0,fileNameTemplate:"mau-thong-tin-trang-thiet-bi",templateUrl:yt.document.mau_thong_tin_trang_thiet_bi,code:n.code,codeLanguage:n.codeLanguage,loading:n.isFetching,numberSuccess:(n==null?void 0:n.totalSuccess)??0,numberFail:(n==null?void 0:n.totalFailed)??0,problemResponseServerDataSource:(n==null?void 0:n.errors)??[],errorFile:((s=n==null?void 0:n.data)==null?void 0:s.data)??null})},Tn=async(e,n)=>{try{const{note:r,nextMaintenance:c,nextStatus:s,idAsset:o}=n,{code:l,codeLanguage:i}=await Gt({idAsset:o,nextMaintenanceDate:c||void 0,idBuilding:e,status:s,note:r||void 0});return{code:l,codeLanguage:i}}catch({code:r,codeLanguage:c}){return{code:r,codeLanguage:c}}},Cn=()=>{const{idBuilding:e}=Q(),{hideModalUpdateAssetStatus:n,modalUpdateAssetStatus:r,tablePagination:c,filter:s}=S.useContext(X),{changeDataTable:o}=re(),{data:l}=r,[i]=F.useForm(),[m,y]=S.useState({isFetching:!1,code:void 0,codeLanguage:void 0});he(m.code,m.codeLanguage,{message:a.success,description:a.update_status_success});const h=async()=>{y({isFetching:!0,code:void 0,codeLanguage:void 0});const{code:g,codeLanguage:x}=await Tn(e,{note:i.getFieldValue("note"),nextMaintenance:i.getFieldValue("nextMaintenance"),nextStatus:l.nextStatus,idAsset:l.id});Me.includes(g)&&await o({filter:{...s},page:c.current,limit:c.limit}),y({isFetching:!1,code:g,codeLanguage:x}),n()},u=()=>n();return[m.isFetching,i,l.name,l.status,l.nextStatus,h,u]},Dn=()=>{var l;const[e,n,r,c,s,o]=Cn();return R(_e,{onOk:s,onCancel:o,okText:a.update,cancelText:a.cancel,visible:!0,title:a.update_asset_status,okButtonProps:{disabled:e,loading:e},children:[a.do_you_want_to_change_status_of," ",t("b",{children:r})," ",a.to," ",(l=pe[c])==null?void 0:l.label,"?",R(F,{layout:"vertical",form:n,name:"formUpdateStatus",children:[t(F.Item,{name:"nextMaintenance",label:a.next_maintenance,children:t(ee,{format:"DD/MM/YYYY",fluid:!0,placeholder:"DD/MM/YYYY"})}),t(F.Item,{name:"note",label:a.note,children:t(K.TextArea,{placeholder:a.note})})]})]})},se=S.createContext({idBuilding:0,filter:{...Te},setFilter:()=>{},tableData:{records:[],totalRecord:0},setTableData:()=>{},tablePagination:{current:Y,limit:N},setTablePagination:()=>{},getListMaintenanceAssetHistoryStatus:{isFetching:!1},setGetListMaintenanceAssetHistoryStatus:()=>{},modalExportAssetHistory:void 0,showModalExportAssetHistory:()=>{},hideModalExportAssetHistory:()=>{},isShowActionExport:!1}),Ve=({children:e})=>{const{idBuilding:n}=Q(),{getPermissionByModuleCode:r}=je(),[c,s]=S.useState({isFetching:!1}),[o,l]=S.useState({...Te}),[i,m]=S.useState({records:[],totalRecord:0}),[y,h]=S.useState({current:Y,limit:N}),[u,g,x]=de(),A=r(Xe),d=(A==null?void 0:A[Je])??!1,f={idBuilding:n,filter:o,setFilter:l,tableData:i,setTableData:m,tablePagination:y,setTablePagination:h,getListMaintenanceAssetHistoryStatus:c,setGetListMaintenanceAssetHistoryStatus:s,modalExportAssetHistory:u,showModalExportAssetHistory:g,hideModalExportAssetHistory:x,isShowActionExport:d};return t(se.Provider,{value:f,children:e})};Ve.propTypes={children:C.node};Ve.defaultProps={children:t("div",{})};const Fn=e=>{var n,r,c,s,o,l,i,m,y,h,u,g,x,A,d,f;return{asset:((n=e==null?void 0:e.currentData)==null?void 0:n.name)??"",placeType:((r=e==null?void 0:e.currentData)==null?void 0:r.placeType)??"",location:((c=e==null?void 0:e.currentData)==null?void 0:c.location)??"",floor:{id:(o=(s=e==null?void 0:e.currentData)==null?void 0:s.floor)==null?void 0:o.id,name:((i=(l=e==null?void 0:e.currentData)==null?void 0:l.floor)==null?void 0:i.name)??""},apartment:{id:(y=(m=e==null?void 0:e.currentData)==null?void 0:m.unit)==null?void 0:y.id,name:((u=(h=e==null?void 0:e.currentData)==null?void 0:h.unit)==null?void 0:u.name)??""},maintenanceBy:((g=e==null?void 0:e.employee)==null?void 0:g.fullName)??"",maintenanceAt:(x=e==null?void 0:e.changedData)!=null&&x.nextMaintenanceDate?v((A=e==null?void 0:e.changedData)==null?void 0:A.nextMaintenanceDate).format("DD/MM/YYYY"):"",note:((d=e==null?void 0:e.currentData)==null?void 0:d.note)??"",status:((f=e==null?void 0:e.currentData)==null?void 0:f.status)??""}},ot=async({idBuilding:e,filter:n,page:r,limit:c})=>{try{const{asset:s,maintenanceBy:o,status:l,maintenanceAt:i,assetId:m}=n,{code:y,codeLanguage:h,data:u,totalRecord:g}=await $t({filter:{assetName:s||void 0,userId:o||void 0,status:l||void 0,maintenanceAt:i?v(i).toISOString():void 0,assetId:m||void 0},idBuilding:e,limit:c,page:r});return{code:y,codeLanguage:h,data:u.map(x=>Fn(x)),totalRecord:g}}catch({code:s,codeLanguage:o}){return{code:s,codeLanguage:o,data:[],totalRecord:0}}},He=()=>{const{setTableData:e,idBuilding:n,setGetListMaintenanceAssetHistoryStatus:r}=S.useContext(se),{modalHistoryMaintenanceAsset:c}=S.useContext(X),{data:s}=c;return{changeDataTable:async({filter:l,page:i,limit:m})=>{r({isFetching:!0});const y=await ot({filter:{...l,assetId:s==null?void 0:s.id},idBuilding:n,limit:m,page:i});e({records:y.data,totalRecord:y.totalRecord}),r({isFetching:!1})}}},In=()=>{const{idBuilding:e}=Q(),{setFilter:n,setTablePagination:r}=S.useContext(se),{changeDataTable:c}=He(),[s,o]=S.useState({isFetching:!1,records:[]}),l=async m=>{n(m),r({current:Y,limit:N}),await c({filter:{...m},page:Y,limit:N})},i=async m=>{o({...s,isFetching:!0});const{data:y}=await Be({filter:{name:m},idBuilding:e,limit:N,page:Y});o({isFetching:!1,records:y})};return S.useEffect(()=>{(async()=>await i(""))()},[]),[s.isFetching,s.records,l,i]},En=()=>{const[e,n,r,c]=In(),s=S.useMemo(()=>[{label:a.asset_name,key:"asset",component:t(K,{placeholder:a.asset_name,fluid:!0}),visible:!0},{label:a.maintenance_by,key:"maintenanceBy",component:t(O,{allowClear:!0,showSearch:!0,onSearch:c,filterOption:!1,loading:e,dropdownRender:o=>e?t("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},children:t(Ue,{})}):o,fluid:!0,placeholder:a.all_staff,children:n.map(({id:o,name:l})=>t(O.Option,{value:o,children:l},o))}),visible:!0},{label:a.status1,key:"status",component:R(O,{fluid:!0,children:[t(O.Option,{value:"",children:a.all_status},"status_0"),De.map(({label:o,value:l})=>t(O.Option,{value:l,children:o},l))]}),visible:!0},{label:a.maintenance_at,key:"maintenanceAt",component:t(ee,{fluid:!0,format:"DD/MM/YYYY",placeholder:"DD/MM/YYYY"}),visible:!0}],[n]);return t(dt,{initialValues:Te,filters:s,onSearch:r,visibleFilterBox:!0})},bn=()=>{const{tablePagination:e,setTablePagination:n,getListMaintenanceAssetHistoryStatus:r,filter:c,tableData:s}=S.useContext(se),{modalHistoryMaintenanceAsset:o}=S.useContext(X),{changeDataTable:l}=He(),{data:i}=o,m=async(u,g)=>{let{limit:x,current:A}=e;A!==u?A=u:x!==g&&(A=Y,x=g),n({limit:x,current:A}),await l({filter:{...c,assetId:i==null?void 0:i.id},page:A,limit:x})},y=s.records,h={current:e.current,pageSize:e.limit,total:s.totalRecord,showQuickJumper:!0,showSizeChanger:!0,onChange:m};return[r.isFetching,y,h]};var Un={name:"e0dnmk",styles:"cursor:pointer"};function Pn(){const[e,n,r]=bn(),c=[{title:a.asset_name,key:"asset",dataIndex:"asset",fixed:"left",width:220},{title:a.maintenance_by,key:"maintenanceBy",dataIndex:"maintenanceBy",width:150},{title:a.status1,key:"status",width:120,render:(s,o)=>{var l,i;return t(Qe,{css:Un,color:((l=pe[o.status])==null?void 0:l.color)??"default",children:((i=pe[o.status])==null?void 0:i.label)??"-"})}},{title:a.maintenance_at,key:"maintenanceAt",dataIndex:"maintenanceAt",width:120},{title:a.note,key:"note",dataIndex:"note",width:150}];return t($.Table,{columns:c,dataSource:n,loading:e,pagination:r})}const Ln=()=>{const{showModalExportAssetHistory:e,isShowActionExport:n}=S.useContext(se);return{handleViewHistoryUsage:()=>{e()},isShowActionExport:n}},On=()=>{const{handleViewHistoryUsage:e,isShowActionExport:n}=Ln(),r=[n?t(ue,{ghost:!0,type:"primary",icon:t(j,{name:"icon-download-outlined"}),onClick:e,children:a.export},"export"):null].filter(Boolean);return t($.ActionBox,{actions:r})},be=100,Rn=()=>{const{idBuilding:e,tableData:n,filter:r,hideModalExportAssetHistory:c}=S.useContext(se),[s,o]=S.useState({isFetching:!1}),[l,i]=S.useState(0),m=async()=>{var A,d,f;o({isFetching:!0}),i(0);const y=[];let h=1;const u=n.totalRecord,g=Math.floor(u/be)+1;let x=0;for(;h<=g;){const D=await ot({idBuilding:e,filter:r,limit:be,page:h});if(((A=D==null?void 0:D.data)==null?void 0:A.length)>0){const E=y.length;for(let P=0;P<((d=D==null?void 0:D.data)==null?void 0:d.length);P+=1){const I=D.data[P],L=[E+P+1];L.push((I==null?void 0:I.asset)??""),L.push((I==null?void 0:I.maintenanceBy)??""),L.push(((f=pe[I==null?void 0:I.status])==null?void 0:f.label)??""),L.push((I==null?void 0:I.maintenanceAt)??""),L.push((I==null?void 0:I.note)??""),y.push(L)}h+=1;const k=be/u*100;x+=k,i(Math.round(x))}else{h=0;break}}y.unshift(["#",a.asset_name,a.maintenance_by,a.status1,a.maintenance_at,a.note]),xt(y,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8",a.history_maintenance_info,".xlsx"),o({isFetching:!1}),St.success({message:a.success,description:a.export_data_success}),c()};return S.useEffect(()=>{m()},[]),{isFetchingExport:s.isFetching,percent:l}},Yn=()=>{const{isFetchingExport:e,percent:n}=Rn();return t(_e,{open:!0,okText:a.export,cancelText:a.cancel,okButtonProps:{isFetchingExport:e,disabled:e},footer:null,closable:!1,children:t(At,{strokeColor:{from:"#108ee9",to:"#87d068"},percent:n,status:"active"})})},Nn=()=>{const{tablePagination:e,modalExportAssetHistory:n}=S.useContext(se),{hideModalHistoryMaintenanceAsset:r,modalHistoryMaintenanceAsset:c}=S.useContext(X),{changeDataTable:s}=He(),{data:o}=c;return S.useEffect(()=>{(async()=>await s({filter:{...Te,assetId:o==null?void 0:o.id},page:e.current,limit:e.limit}))()},[]),[!(o!=null&&o.id),r,n==null?void 0:n.isShow]},kn=()=>{const[e,n,r]=Nn();return R(_e,{width:"70%",visible:!0,title:a.history_maintenance,footer:!1,onCancel:n,children:[R($.Wrapper,{children:[e?t(En,{}):null,R($.Container,{children:[t($.Header,{children:t(On,{})}),t($.Content,{children:t(Pn,{})})]})]}),r?t(Yn,{}):null]})},Bn=()=>t(Ve,{children:t(kn,{})}),Vn=()=>{const{setTitlePage:e,setVisibleFilterBox:n,setVisibleSearchBox:r}=S.useContext(Ke),{modalAddAsset:c,modalUpdateAsset:s,modalHistoryMaintenanceAsset:o,modalImportAsset:l,modalUpdateAssetStatus:i,tablePagination:m,filter:y}=S.useContext(X),{changeDataTable:h}=re();return S.useEffect(()=>(e(a.asset),r(!0),(async()=>await h({filter:{...y},page:m.current,limit:m.limit}))(),()=>{e(""),r(!1),n(!1)}),[]),[c.isShow,s.isShow,i.isShow,o.isShow,l.isShow]},Hn=()=>{const[e,n,r,c,s]=Vn();return R($.Wrapper,{children:[t(an,{}),R($.Container,{children:[t($.Header,{children:t(Kt,{})}),t($.Content,{children:t(cn,{})})]}),e?t(yn,{}):null,n?t(An,{}):null,s?t(Mn,{}):null,r?t(Dn,{}):null,c?t(Bn,{}):null]})},Ei=()=>t(Ut,{children:t(Hn,{})});export{Ei as default};
