import{j as e,c as ke,u as ar,a as S,b as ee,F as X}from"./@emotion-63839449.js";import{r as N}from"./react-4fd50329.js";import{I as Y,cz as le,cB as Re,cC as re,l as i,cD as lr,cE as or,S as ue,cy as sr,cF as dr,cG as cr,cH as mr,cI as ur,cJ as oe,cK as G,cL as Me,cM as de,cN as Ue,am as Ce,Y as Q,cO as ce,cP as ie,cQ as Be,cR as je,cS as J,cT as Ve,cU as ye,cV as pr,cW as hr,cX as Ae,cY as yr,cZ as gr,c_ as fr,c$ as Ee,d0 as Ne,d1 as Fe,d2 as ae,d3 as _r,d4 as pe,d5 as Pr,d6 as Tr,d7 as vr,d8 as Sr,d9 as br,b1 as Or}from"./index-c2ded735.js";import"./react-redux-896b353b.js";import"./lodash-88fe09e6.js";import{h as R}from"./moment-a468e1f9.js";import"./file-saver-40cf32a9.js";import"./@firebase-43527ee1.js";import{a as Cr,c as ge,b as Ar,u as Er,d as $e,e as ze,f as Nr,h as qe,i as Fr}from"./amenitiesGroup-b7dc847e.js";import{I as D,S as L}from"./index-43183512.js";import{C as he,b as Ye,k as q,w as me,a as Ir,x as j,D as Ie,M as Lr}from"./index-b17d22e5.js";import{F as y,u as He}from"./index-687ba9e6.js";import{B as ne}from"./index-881eef42.js";import{P as C}from"./prop-types-1172f4d5.js";import{R as U,b as v,c as Ge,B as K,g as wr}from"./antd-f9eae174.js";import{P as Le}from"./index-d2c5b7c0.js";import{g as Dr}from"./amenities-1e1bae0f.js";import{u as xr}from"./react-router-a4308f7b.js";import{T as kr}from"./index-3a1629f9.js";import{i as Rr}from"./intersectPeriodTime-5a3f0a94.js";import{c as we}from"./convertNumberToDateTime-e1623b31.js";const Mr=(t=[],r=[])=>{if(!t||!r||!t.length||!r.length)return!1;for(let l=0;l<r.length;l+=1)if(t.includes(r[l]))return!0;return!1},Ke=async(t,r)=>{try{const{code:l,codeLanguage:n,data:a}=await Cr(t,r);return{code:l,codeLanguage:n,data:ge(a)}}catch({code:l,codeLanguage:n}){return{code:l,codeLanguage:n,data:null}}};var Ur={name:"99halj",styles:"color:#2424f3"};const Br=ke("span",{target:"ep2ws820"})("cursor:pointer;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;",t=>t.isUploaded&&Ur,";"),fe=({file:t,handlePreviewAttachment:r})=>e(Br,{title:t.name,onClick:()=>r(t),children:t.name});fe.propTypes={file:C.objectOf(C.any),handlePreviewAttachment:C.func};fe.defaultProps={file:{},handlePreviewAttachment:()=>{}};const jr=ke("div",{target:"elzcst10"})({name:"seoft9",styles:"display:flex;justify-content:space-between;margin:10px;&:hover{background:#f7f7f7;}"}),_e=({file:t,handlePreviewAttachment:r,handleRemoveFile:l})=>{const n=ar();return S(jr,{children:[S(U,{style:{alignItems:"center"},children:[e(Y,{name:"icon-attachment-outlined",css:ee({fontsize:n.iconSize,marginRight:n.margin.xs},"","")}),e(fe,{file:t,handlePreviewAttachment:r})]}),e(Y,{name:"icon-delete-outlined",css:ee({fontsize:n.iconSize,marginLeft:n.margin.xs},"",""),onClick:()=>{l(t==null?void 0:t.uid)}})]},t)};_e.propTypes={file:C.objectOf(C.any),handlePreviewAttachment:C.func,handleRemoveFile:C.func};_e.defaultProps={file:{},handlePreviewAttachment:()=>{},handleRemoveFile:()=>{}};const Vr=async(t,r,l)=>{try{const{name:n,code:a,type:o,paymentMethod:c,payBeforeTime:u,payBeforeTimeType:s,description:p,status:g,coverPhoto:T,photos:f,priorityInApp:m,amenitiesPreOrderLimit:h,amenitiesUsageHoursLimit:_}=t,b={name:{vi:n,en:n,ja:n,ko:n,zh:n},code:a,type:o,paymentMethod:c,payBeforeTime:u,payBeforeTimeType:s,description:p,status:g?le:Re,coverPhoto:T,photos:f,priorityInApp:m,limitOrderPerUsage:(h==null?void 0:h.time)??null,limitOrderPerUsageType:(h==null?void 0:h.unit)??null,limitOrderTimeUsage:(_==null?void 0:_.hour)??null,limitOrderTimeUsageType:(_==null?void 0:_.unit)??null,files:r},{code:F,codeLanguage:x,data:$}=await Ar(b,l);return{code:F,codeLanguage:x,data:ge($)}}catch({code:n,codeLanguage:a}){return{code:n,codeLanguage:a,data:null}}},$r=async t=>{try{const{code:r,codeLanguage:l,data:n}=await Dr(t);return{code:r,codeLanguage:l,data:n}}catch({code:r,codeLanguage:l}){return{code:r,codeLanguage:l,data:null}}},zr=async(t,r,l,n)=>{try{const{name:a,code:o,type:c,paymentMethod:u,payBeforeTime:s,payBeforeTimeType:p,description:g,status:T,coverPhoto:f,photos:m,priorityInApp:h,amenitiesPreOrderLimit:_,amenitiesUsageHoursLimit:b}=r,F={name:{vi:a,en:a,ja:a,ko:a,zh:a},code:o,type:c,paymentMethod:u,payBeforeTime:s,payBeforeTimeType:p,description:g,status:T?le:Re,coverPhoto:f,photos:m,priorityInApp:h,limitOrderPerUsage:(_==null?void 0:_.time)??null,limitOrderPerUsageType:(_==null?void 0:_.unit)??null,limitOrderTimeUsage:(b==null?void 0:b.hour)??null,limitOrderTimeUsageType:(b==null?void 0:b.unit)??null,files:l},{code:x,codeLanguage:$,data:w}=await Er(t,F,n);return{code:x,codeLanguage:$,data:ge(w)}}catch({code:a,codeLanguage:o}){return{code:a,codeLanguage:o,data:null}}},se=N.createContext({idAmenitiesGroup:0,idBuilding:0,isEditingAmenitiesGroup:!1,setIsEditingAmenitiesGroup:()=>{},getAmenitiesGroupStatus:{isFetching:!1},setGetAmenitiesGroupStatus:()=>{},amenitiesGroup:void 0,setAmenitiesGroup:()=>{},amenitiesList:[],setAmenitiesList:()=>{},isEditingAmenity:!1,setIsEditingAmenity:()=>{},amenitiesActive:void 0,setAmenitiesActive:()=>{},fileList:[],setFileList:()=>{}}),Pe=({children:t})=>{const{idAmenitiesGroup:r,idBuilding:l}=xr(),[n,a]=N.useState(!1),[o,c]=N.useState(!1),[u,s]=N.useState({isFetching:!1}),[p,g]=N.useState({name:"",status:!1,type:re,code:"",paymentMethod:null,payBeforeTime:null,payBeforeTimeType:null,location:"",priorityInApp:null,description:"",coverPhoto:"",photos:[],files:[]}),[T,f]=N.useState([]),[m,h]=N.useState(),[_,b]=N.useState([]),F={isEditingAmenity:o,setIsEditingAmenity:c,idAmenitiesGroup:r,idBuilding:l,isEditingAmenitiesGroup:n,setIsEditingAmenitiesGroup:a,getAmenitiesGroupStatus:u,setGetAmenitiesGroupStatus:s,amenitiesGroup:p,setAmenitiesGroup:x=>{var $;g({...x,name:(($=x==null?void 0:x.name)==null?void 0:$.vi)??x.name})},amenitiesList:T,setAmenitiesList:f,amenitiesActive:m,setAmenitiesActive:h,fileList:_,setFileList:b};return e(se.Provider,{value:F,children:t})};Pe.propTypes={children:C.node};Pe.defaultProps={children:e("div",{})};const qr=()=>{const{idBuilding:t,amenitiesGroup:r,setAmenitiesGroup:l,setAmenitiesList:n,setIsEditingAmenitiesGroup:a,isEditingAmenity:o,isEditingAmenitiesGroup:c,fileList:u,setFileList:s}=N.useContext(se),[p,g]=N.useState({isFetching:!1}),[T,f]=N.useState([]),[m,h]=N.useState({isFetching:!1,code:void 0,codeLanguage:void 0}),[_,b]=N.useState([]),[F,x]=N.useState([]),[$,w]=N.useState({isPreview:!1,imagePreview:""}),[k,M]=N.useState(r==null?void 0:r.type),[O,d]=N.useState(!1);N.useEffect(()=>{var P;r&&s(((P=r==null?void 0:r.files)==null?void 0:P.map(A=>({url:A,status:"done",name:A,isUploaded:!0})))??[])},[r]);const B=({file:P,fileList:A})=>{let E=A;P.status==="removed"&&(E=A),(P.status==="done"||P.status==="uploading")&&(E=A),P.status||(E=A.filter(I=>I.uid!==P.uid)),d(!0),E!=null&&E.every(I=>I.status==="done")&&d(!1),s(E.filter(I=>["done","uploading"].includes(I.status)))},V=P=>{var A,E,I,W;(E=(A=P==null?void 0:P.response)==null?void 0:A.data)!=null&&E.url?Le.open({url:(W=(I=P==null?void 0:P.response)==null?void 0:I.data)==null?void 0:W.url}):P!=null&&P.url&&Le.open(P!=null&&P.url?{url:P==null?void 0:P.url}:"")},H=P=>{const A=u.filter(E=>E.uid!==P);s(A),a(!0)},[z]=y.useForm();He(m.code,m.codeLanguage,{message:i.success,description:i.save_amenities_group_success});const be=()=>{b(z.getFieldValue("coverPhoto")?[{uid:"-1",name:"avatar",status:"done",url:z.getFieldValue("coverPhoto")}]:[])},Oe=()=>{x(Array.isArray(z.getFieldValue("photos"))?z.getFieldValue("photos").map((P,A)=>({uid:(A+1)*-1,name:"avatar",status:"done",url:P})):[])};N.useEffect(()=>{(async()=>{be(),Oe(),g({isFetching:!0});const P=await $r(t);f(P.data),g({isFetching:!1})})()},[]),N.useEffect(()=>{var P,A,E,I;z.setFieldsValue({coverPhoto:((E=(A=(P=_==null?void 0:_[0])==null?void 0:P.response)==null?void 0:A.data)==null?void 0:E.url)??((I=_==null?void 0:_[0])==null?void 0:I.url)??""})},[_]),N.useEffect(()=>{z.setFieldsValue({photos:F.map(P=>{var A,E;return((E=(A=P==null?void 0:P.response)==null?void 0:A.data)==null?void 0:E.url)??(P==null?void 0:P.url)??null}).filter(Boolean)})},[F]);const Xe=({file:P,fileList:A})=>{const E=A.filter(I=>I.status);b(E),a(!0)},Je=({file:P,fileList:A})=>{let E=A;E.length>10&&(E=E.splice(1,10)),E=E.filter(I=>I.status),x(E),a(!0)},Qe=P=>{var A,E;w({isPreview:!0,imagePreview:((E=(A=P==null?void 0:P.response)==null?void 0:A.data)==null?void 0:E.url)??P.url})},Ze=()=>{w({isPreview:!1,imagePreview:""})},er=(P,A)=>{a(!0),M(A.type),P.type&&(P.type!==re?z.setFieldsValue({paymentMethod:lr,payBeforeTime:0,payBeforeTimeType:or}):z.setFieldsValue({paymentMethod:null,payBeforeTime:null,payBeforeTimeType:null}))},rr=async()=>{var E;const P=await z.validateFields();let A=[];if(u!=null&&u.length&&(A=(u==null?void 0:u.map(I=>{var W,Z;return((Z=(W=I==null?void 0:I.response)==null?void 0:W.data)==null?void 0:Z.url)??(I==null?void 0:I.url)}))??[]),P){h({isFetching:!0,code:void 0,codeLanguage:void 0});let I;if(r.id?I=await zr(r.id,z.getFieldsValue(),A,t):I=await Vr(z.getFieldsValue(),A,t),h({isFetching:!1,code:I.code,codeLanguage:I.codeLanguage}),ue.includes(I.code)){const W=await Ke((E=I==null?void 0:I.data)==null?void 0:E.id,t),Z=(W==null?void 0:W.data)||{},nr=(Z==null?void 0:Z.amenities)||[];l(Z),n(nr),a(!1)}}},tr=()=>{z.resetFields(),be(),Oe(),a(!1)},ir=N.useMemo(()=>T&&T.map(P=>P.priorityInApp!==z.getFieldValue("priorityInApp")?P.priorityInApp:!1).filter(Boolean)||[],[T]);return{avatar:_,previewImage:$,amenitiesGroup:r,isEditingAmenity:o,descriptionImages:F,amenitiesGroupForm:z,isEditingAmenitiesGroup:c,saveAmenitiesGroupStatus:m,priorityInAppSelectedNumbers:ir,getListPriorityInAppSelectedStatus:p,onAmenitiesAvatarChange:Xe,onClickBtnSaveAmenitiesGroup:rr,onClickBtnCancelAmenitiesGroup:tr,onValuesChangeAmenitiesGroupForm:er,onAmenitiesDescriptionImageChange:Je,onClickPreviewAmenitiesDescriptionImage:Qe,onClickBtnCloseModalPreviewAmenitiesDescriptionImage:Ze,amenitiesGroupType:k,fileList:u,handleChange:B,isProcessUploadFile:O,handlePreviewAttachment:V,handleRemoveFile:H}},De=()=>S("div",{style:{height:"100%",width:"100%",display:"flex",flexDirection:"column",verticalAlign:"center",justifyContent:"center"},children:[e(Y,{name:"icon-plus-circle-outlined",style:{color:"#999",fontSize:"19px"}}),e("div",{style:{marginTop:"8px",color:"#666"},children:i.upload})]});var Yr={name:"1kevbid",styles:"& .ant-upload{width:100%;}"},Hr={name:"ny7lo8",styles:"width:100%;flex:1 0 0"},Gr={name:"2qga7i",styles:"text-align:right"};const Kr=()=>{var O;const[t]=Q(),{avatar:r,previewImage:l,amenitiesGroup:n,isEditingAmenity:a,descriptionImages:o,amenitiesGroupForm:c,isEditingAmenitiesGroup:u,saveAmenitiesGroupStatus:s,priorityInAppSelectedNumbers:p,getListPriorityInAppSelectedStatus:g,onAmenitiesAvatarChange:T,onClickBtnSaveAmenitiesGroup:f,onClickBtnCancelAmenitiesGroup:m,onValuesChangeAmenitiesGroupForm:h,onAmenitiesDescriptionImageChange:_,onClickPreviewAmenitiesDescriptionImage:b,onClickBtnCloseModalPreviewAmenitiesDescriptionImage:F,amenitiesGroupType:x,fileList:$,handleChange:w,handlePreviewAttachment:k,handleRemoveFile:M}=qr();return S(y,{layout:"vertical",name:"amenitiesGroupForm",initialValues:{name:n.name,status:n.status===le,type:n.type,code:n.code,paymentMethod:n.paymentMethod,payBeforeTime:n.payBeforeTime,payBeforeTimeType:n.payBeforeTimeType,priorityInApp:n.priorityInApp,description:n.description,coverPhoto:n.coverPhoto,photos:n.photos,amenitiesPreOrderLimit:{time:n.limitOrderPerUsage,unit:n.limitOrderPerUsageType},amenitiesUsageHoursLimit:{hour:n.limitOrderTimeUsage,unit:n.limitOrderTimeUsageType},file:(O=n==null?void 0:n.files)==null?void 0:O.map(d=>({url:d,status:"done",name:d}))},form:c,hideRequiredMark:!0,scrollToFirstError:!0,onValuesChange:h,children:[S(ne,{children:[e(ne.Header,{borderBottom:!0,children:e(U,{gutter:[12,0],children:S(he,{centerVertical:!0,span:"12",children:[e(Y,{name:"icon-info-circle-filled",style:{marginRight:t.marginSm,fontSize:t.fontSizeLargeIcon}}),e(Ye,{children:i.amenities_group_info})]})})}),S(ne.Content,{css:ee({marginBottom:t.marginLg},"",""),children:[S(U,{gutter:[12,8],children:[e(v,{span:12,children:e(y.Item,{label:`${i.amenities_group_name} *`,name:"name",rules:[{required:!0,transform:d=>d&&d.toString().trim()}],children:e(D,{placeholder:i.amenities_group_name,maxLength:255,disabled:a})})}),e(v,{span:12,children:e(y.Item,{label:`${i.status1}`,name:"status",valuePropName:"checked",children:e(Ge,{disabled:a,children:i.active})})}),e(v,{span:12,children:e(y.Item,{label:`${i.amenities_group_type} *`,name:"type",children:e(L,{fluid:"true",placeholder:i.select_amenities_type,disabled:!!n.id||a,getPopupContainer:d=>d.parentNode,children:sr.map(d=>e(L.Option,{value:d.key,children:d.label},d.key))})})}),e(v,{span:12,children:e(y.Item,{label:`${i.amenities_group_code} *`,name:"code",rules:[{required:!0,transform:d=>d&&d.toString().trim()}],children:e(D,{disabled:a,placeholder:i.amenities_group_code,maxLength:255,style:{textTransform:"uppercase"}})})}),e(v,{span:6,children:e(y.Item,{label:`${i.payment_method} *`,name:"paymentMethod",children:e(L,{fluid:"true",placeholder:i.payment_method,disabled:!0,getPopupContainer:d=>d.parentNode,children:dr.map(d=>e(L.Option,{value:d.key,children:d.label},d.key))})})}),e(v,{span:6,children:e(y.Item,{label:`${i.payment_expired} *`,className:"site-input-group-wrapper",children:S(D.Group,{compact:!0,children:[e(y.Item,{name:"payBeforeTime",style:{width:"50%"},children:e(L,{fluid:"true",placeholder:i.number_time,disabled:x===re||a,getPopupContainer:d=>d.parentNode,children:cr.map(d=>e(L.Option,{value:d,children:d},d))})}),e(y.Item,{name:"payBeforeTimeType",style:{width:"50%"},children:e(L,{fluid:"true",placeholder:i.unit_time,disabled:x===re||a,getPopupContainer:d=>d.parentNode,children:mr.map(d=>e(L.Option,{value:d.key,children:d.label},d.key))})})]})})}),e(v,{span:12,children:e(y.Item,{label:`${i.order_appear_in_resident_app} *`,name:"priorityInApp",rules:[{required:!0},{validator:(d,B)=>B==null||B===""?Promise.resolve():B<=0?Promise.reject(i.value_must_greater_than_zero):Math.floor(Number(B))!==Number(B)?Promise.reject(i.value_must_be_integer):p.includes(Number(B))?Promise.reject(i.order_appear_in_app_existed):Promise.resolve()}],children:e(q,{placeholder:i.select_order_appear_in_app,loading:g==null?void 0:g.isFetching,max:ur,disabled:a})})}),x===oe||x===G?e(v,{span:12,children:e(y.Item,{label:i.limit_order_per_apartment,children:S(D.Group,{compact:!0,children:[e(y.Item,{name:["amenitiesPreOrderLimit","time"],noStyle:!0,rules:[({getFieldValue:d})=>({validator(B,V){return d(["amenitiesPreOrderLimit","unit"])&&!V?Promise.reject(i.not_select_time):Promise.resolve()}})],dependencies:[["amenitiesPreOrderLimit","unit"]],children:e(L,{allowClear:!0,placeholder:i.select_times,style:{width:"calc(50% - 30px)"},getPopupContainer:d=>d.parentNode,disabled:a,children:Me.map(d=>e(L.Option,{value:d,children:d},d))})}),e(D,{style:{width:60,pointerEvents:"none",backgroundColor:"#fafafa",textAlign:"center"},value:`${i.times.toLowerCase()}/ `,disabled:a}),e(y.Item,{name:["amenitiesPreOrderLimit","unit"],noStyle:!0,rules:[({getFieldValue:d})=>({validator(B,V){return d(["amenitiesPreOrderLimit","time"])&&!V?Promise.reject(i.not_select_unit):Promise.resolve()}})],dependencies:[["amenitiesPreOrderLimit","time"]],children:e(L,{allowClear:!0,placeholder:i.select,style:{width:"calc(50% - 30px)"},getPopupContainer:d=>d.parentNode,disabled:a,children:de.map(d=>e(L.Option,{value:d.key,children:d.label},d.key))})})]})})}):null,x===G?e(v,{span:12,children:e(y.Item,{label:i.limit_the_amenities_usage_times,children:S(D.Group,{compact:!0,children:[e(y.Item,{name:["amenitiesUsageHoursLimit","hour"],noStyle:!0,rules:[({getFieldValue:d})=>({validator(B,V){return d(["amenitiesUsageHoursLimit","unit"])&&!V?Promise.reject(i.status.data_require):Promise.resolve()}})],dependencies:[["amenitiesUsageHoursLimit","unit"]],children:e(q,{style:{width:"calc(50% - 65px)"},className:"site-input-right",placeholder:i.frame,max:Ue,min:1,disabled:a})}),e(D,{style:{width:90,pointerEvents:"none",backgroundColor:"#fafafa",textAlign:"center"},value:`${i.frame.toLowerCase()}/ `,disabled:a}),e(y.Item,{name:["amenitiesUsageHoursLimit","unit"],noStyle:!0,rules:[({getFieldValue:d})=>({validator(B,V){return d(["amenitiesUsageHoursLimit","hour"])&&!V?Promise.reject(i.not_select_unit):Promise.resolve()}})],dependencies:[["amenitiesUsageHoursLimit","hour"]],children:e(L,{allowClear:!0,placeholder:i.select,style:{width:"calc(50% - 25px)"},getPopupContainer:d=>d.parentNode,disabled:a,children:de.map(d=>e(L.Option,{value:d.key,children:d.label},d.key))})})]})})}):null,e(v,{span:"24",children:e(y.Item,{label:`${i.description} *`,name:"description",rules:[{required:!0,transform:d=>d&&d.toString().trim()}],children:e(D.TextArea,{autoSize:{minRows:4,maxRows:4},placeholder:i.description,maxLength:2e4,disabled:a})})})]}),e(U,{children:S(v,{span:"24",children:[e(y.Item,{name:"files",label:i.attached_files,children:e(me,{multiple:!0,maxCount:"5",css:Yr,onPreview:k,limitSizeFile:5,isUploadAllFile:!0,fileList:$,onChange:w,showUploadList:!1,accept:"application/pdf",children:e(K,{icon:e(Y,{name:"icon-attachment-outlined",css:d=>({fontsize:d.iconSize})}),type:"primary",ghost:!0,block:!0,size:"default",children:i.attachments})})}),$.map(d=>e(_e,{file:d,handlePreviewAttachment:k,handleRemoveFile:M})),e("i",{style:{color:t.labelColor,fontSize:"12px"},children:i.uploaded_files_must_be_in_pdf_format_maximum_5_files})]})}),S(U,{gutter:[48,0],css:d=>({marginTop:d.margin.lg}),children:[e(v,{children:e(y.Item,{rules:[{required:!0}],name:"coverPhoto",label:`${i.avatar} *`,children:e("div",{style:{width:"104px",height:"104px"},children:e(me,{onPreview:b,listType:"picture-card",accept:"image/*",fileList:r,onChange:T,disabled:a,module:Ce,children:r.length>0||a?null:e(De,{})})})})}),e(v,{css:Hr,children:e(y.Item,{rules:[{required:!0}],label:`${i.image_introduce} *`,name:"photos",children:e("div",{className:"clearfix",children:e(me,{accept:"image/*",listType:"picture-card",fileList:o,onPreview:b,onChange:_,multiple:!0,disabled:a,maxCount:10,module:Ce,children:o.length>=10||a?null:e(De,{})})})})})]}),S("div",{css:Gr,children:[u?e(K,{onClick:m,css:ee({marginRight:t.marginSm},"",""),children:i.cancel}):null,e(K,{loading:s==null?void 0:s.isFetching,disabled:s.isFetching||a||!u,onClick:f,type:"primary",children:i.save})]})]})]}),l.isPreview?e(Ir,{open:!0,title:i.detail,footer:null,onCancel:F,children:e("img",{alt:"example",style:{width:"100%"},src:l.imagePreview})}):null]})},We=t=>{const r=[...t];r.sort((n,a)=>{const o=n.dayInWeek-a.dayInWeek;return o>0?1:o<0?-1:o===0?n.startTime-a.startTime:0});let l=0;for(;l<r.length-1;){if(r[l].dayInWeek!==r[l+1].dayInWeek){l+=1;continue}if(r[l].endTime===r[l+1].startTime){r[l].endTime=r[l+1].endTime,r.splice(l+1,1);continue}else{l+=1;continue}}return r},Wr=async(t,r,l)=>{var n,a,o,c,u,s,p,g,T,f;try{const m=(t==null?void 0:t.amenitiesCancelOrderPolicies)??[],h=[];for(let w=0;w<m.length;w+=1)w===0?h.push({type:ce,limitDate:0,priceType:m[w].amenitiesCancelOrderPolicyTypeRefundableLevel,price:m[w].amenitiesCancelOrderPolicyTypeRefundableValue,status:ie}):h.push({type:ce,limitDate:m[w-1].amenitiesCancelOrderPolicy.to+1,priceType:m[w].amenitiesCancelOrderPolicyTypeRefundableLevel,price:m[w].amenitiesCancelOrderPolicyTypeRefundableValue,status:ie});const _=[];t.amenitiesTimeServes.forEach(w=>{const k=R(w.amenitiesPeriodTimeServe[0]),M=R(w.amenitiesPeriodTimeServe[1]);w.amenitiesDayServe.forEach(O=>{_.push({startTime:k.hour()*100+k.minute(),endTime:M.hour()*100+M.minute(),dayInWeek:O,formulaType:$e(r.type),formulas:ze(t,r.type),utilityType:(r==null?void 0:r.type)??""})})});const b={localId:t.localId,id:t.id,utilityGroupId:r.id,name:{vi:t.amenitiesName,en:t.amenitiesName,ja:t.amenitiesName,ko:t.amenitiesName,zh:t.amenitiesName},code:t.amenitiesCode,type:r.type,status:t.amenitiesStatus?Be:je,location:t.amenitiesLocation,description:r.description,priorityInApp:r.priorityInApp,photos:r.photos,coverPhoto:r.coverPhoto,activeStartDate:R(t.amenitiesStartDateServe).startOf("day").toDate(),activeEndDate:t.amenitiesEndDateServe?R(t.amenitiesEndDateServe).endOf("day").toDate():null,paymentMethod:r.paymentMethod,payBeforeTime:r.payBeforeTime,payBeforeTimeType:r.payBeforeTimeType,periodTimeServes:r.type===G?We(_):_,limitOrderPerTime:(t==null?void 0:t.amenitiesLimitServe)??null,minSlotPerTime:j({value:((n=t==null?void 0:t.amenitiesLimitFrameOrder)==null?void 0:n.from)??null,isCheckStringNull:!0})?null:t.amenitiesLimitFrameOrder.from,maxSlotPerTime:j({value:((a=t==null?void 0:t.amenitiesLimitFrameOrder)==null?void 0:a.to)??null,isCheckStringNull:!0})?null:t.amenitiesLimitFrameOrder.to,preOrderMinTime:j({value:((o=t==null?void 0:t.amenitiesPreOrder)==null?void 0:o.from)??null,isCheckStringNull:!0})?null:t.amenitiesPreOrder.from,preOrderMaxTime:j({value:((c=t==null?void 0:t.amenitiesPreOrder)==null?void 0:c.to)??null,isCheckStringNull:!0})?null:t.amenitiesPreOrder.to,preOrderMinTimeType:((u=t==null?void 0:t.amenitiesPreOrder)==null?void 0:u.fromType)??J,preOrderMaxTimeType:((s=t==null?void 0:t.amenitiesPreOrder)==null?void 0:s.toType)??J,limitOrderPerUsage:((p=t==null?void 0:t.amenitiesPreOrderLimit)==null?void 0:p.time)??null,limitOrderPerUsageType:((g=t==null?void 0:t.amenitiesPreOrderLimit)==null?void 0:g.unit)??null,limitOrderTimeUsage:((T=t==null?void 0:t.amenitiesUsageHoursLimit)==null?void 0:T.hour)??null,limitOrderTimeUsageType:((f=t==null?void 0:t.amenitiesUsageHoursLimit)==null?void 0:f.unit)??null,deposits:j({value:t==null?void 0:t.amenitiesDepositAmount,isCheckStringNull:!0})?null:t==null?void 0:t.amenitiesDepositAmount,surcharges:((t==null?void 0:t.amenitiesSurcharges)??[]).map(w=>({name:w.amenitiesSurchargeName,price:Number(w.amenitiesSurchargePrice),status:ie,type:Ve})),cancelBookingConditions:h,unitGroupId:l,timeDistance:(t==null?void 0:t.amenitiesTimeDistance)??ye},{code:F,codeLanguage:x,data:$}=await Nr(b,l);return{code:F,codeLanguage:x,data:qe($)}}catch({code:m,codeLanguage:h}){return{code:m,codeLanguage:h,data:null}}},Xr=async({idAmenities:t,amenities:r,amenitiesGroup:l,idBuilding:n})=>{var a,o,c,u,s,p,g,T,f,m;try{const h=(r==null?void 0:r.amenitiesCancelOrderPolicies)??[],_=[];for(let k=0;k<h.length;k+=1)k===0?_.push({type:ce,limitDate:0,priceType:h[k].amenitiesCancelOrderPolicyTypeRefundableLevel,price:h[k].amenitiesCancelOrderPolicyTypeRefundableValue,status:ie}):_.push({type:ce,limitDate:h[k-1].amenitiesCancelOrderPolicy.to+1,priceType:h[k].amenitiesCancelOrderPolicyTypeRefundableLevel,price:h[k].amenitiesCancelOrderPolicyTypeRefundableValue,status:ie});const b=[];r.amenitiesTimeServes.forEach(k=>{const M=R(k.amenitiesPeriodTimeServe[0]),O=R(k.amenitiesPeriodTimeServe[1]);k.amenitiesDayServe.forEach(d=>{b.push({startTime:M.hour()*100+M.minute(),endTime:O.hour()*100+O.minute(),dayInWeek:d,formulaType:$e(l.type),formulas:ze(r,l.type),utilityType:(l==null?void 0:l.type)??""})})});const F={localId:r.localId,id:r.id,utilityGroupId:l.id,name:{vi:r.amenitiesName,en:r.amenitiesName,ja:r.amenitiesName,ko:r.amenitiesName,zh:r.amenitiesName},code:r.amenitiesCode,type:l.type,status:r.amenitiesStatus?Be:je,location:r.amenitiesLocation,description:l.description,priorityInApp:l.priorityInApp,photos:l.photos,coverPhoto:l.coverPhoto,activeStartDate:R(r.amenitiesStartDateServe).startOf("day").toDate(),activeEndDate:r.amenitiesEndDateServe?R(r.amenitiesEndDateServe).endOf("day").toDate():null,paymentMethod:l.paymentMethod,payBeforeTime:l.payBeforeTime,payBeforeTimeType:l.payBeforeTimeType,periodTimeServes:l.type===G?We(b):b,limitOrderPerTime:(r==null?void 0:r.amenitiesLimitServe)??null,minSlotPerTime:j({value:((a=r==null?void 0:r.amenitiesLimitFrameOrder)==null?void 0:a.from)??null,isCheckStringNull:!0})?null:r.amenitiesLimitFrameOrder.from,maxSlotPerTime:j({value:((o=r==null?void 0:r.amenitiesLimitFrameOrder)==null?void 0:o.to)??null,isCheckStringNull:!0})?null:r.amenitiesLimitFrameOrder.to,preOrderMinTime:j({value:((c=r==null?void 0:r.amenitiesPreOrder)==null?void 0:c.from)??null,isCheckStringNull:!0})?null:r.amenitiesPreOrder.from,preOrderMaxTime:j({value:((u=r==null?void 0:r.amenitiesPreOrder)==null?void 0:u.to)??null,isCheckStringNull:!0})?null:r.amenitiesPreOrder.to,preOrderMinTimeType:((s=r==null?void 0:r.amenitiesPreOrder)==null?void 0:s.fromType)??J,preOrderMaxTimeType:((p=r==null?void 0:r.amenitiesPreOrder)==null?void 0:p.toType)??J,limitOrderPerUsage:((g=r==null?void 0:r.amenitiesPreOrderLimit)==null?void 0:g.time)??null,limitOrderPerUsageType:((T=r==null?void 0:r.amenitiesPreOrderLimit)==null?void 0:T.unit)??null,limitOrderTimeUsage:((f=r==null?void 0:r.amenitiesUsageHoursLimit)==null?void 0:f.hour)??null,limitOrderTimeUsageType:((m=r==null?void 0:r.amenitiesUsageHoursLimit)==null?void 0:m.unit)??null,deposits:j({value:r==null?void 0:r.amenitiesDepositAmount,isCheckStringNull:!0})?null:r==null?void 0:r.amenitiesDepositAmount,surcharges:((r==null?void 0:r.amenitiesSurcharges)??[]).map(k=>({name:k.amenitiesSurchargeName,price:Number(k.amenitiesSurchargePrice),status:ie,type:Ve})),cancelBookingConditions:_,unitGroupId:n,timeDistance:(r==null?void 0:r.amenitiesTimeDistance)??ye},{code:x,codeLanguage:$,data:w}=await Fr(t,F,n);return{code:x,codeLanguage:$,data:qe(w)}}catch({code:h,codeLanguage:_}){return{code:h,codeLanguage:_,data:null}}},xe=(t,r)=>{var o,c,u,s,p,g,T,f;const l=[],n=((o=t==null?void 0:t.cancelBookingConditions)==null?void 0:o.sort((m,h)=>Number((m==null?void 0:m.limitDate)||0)-Number((h==null?void 0:h.limitDate)||0)))??[];for(let m=0;m<(n==null?void 0:n.length);m+=1){const h=t.cancelBookingConditions[m];m+1===t.cancelBookingConditions.length?l.push({amenitiesCancelOrderPolicy:{to:null},amenitiesCancelOrderPolicyTypeRefundableLevel:h.priceType,amenitiesCancelOrderPolicyTypeRefundableValue:h.price}):l.push({amenitiesCancelOrderPolicy:{to:t.cancelBookingConditions[m+1].limitDate-1},amenitiesCancelOrderPolicyTypeRefundableLevel:h.priceType,amenitiesCancelOrderPolicyTypeRefundableValue:h.price})}const a=[];return t.periodTimeServes.forEach(m=>{const h=a.findIndex(_=>_.startTime===m.startTime&&_.endTime===m.endTime);if(h===-1){const _=we(Number(m.startTime)).dateTime,b=we(Number(m.endTime)).dateTime,F=m.dayInWeek===0?7:m.dayInWeek;a.push({startTime:m.startTime,endTime:m.endTime,amenitiesDayServe:[F],amenitiesPeriodTimeServe:[_,b]})}else{const _=m.dayInWeek===0?7:m.dayInWeek;a[h].amenitiesDayServe.push(_)}}),{amenitiesTimeDistance:t.timeDistance,amenitiesName:t.name,amenitiesStatus:t.status===le,amenitiesCode:t.code,amenitiesLocation:t.location,amenitiesStartDateServe:R(t.activeStartDate),amenitiesEndDateServe:t.activeEndDate?R(t.activeEndDate):null,amenitiesTimeServes:((c=a==null?void 0:a.map(m=>{const{amenitiesDayServe:h}=m;return h.sort(),h[h.length-1]===7&&(h[h.length-1]=0),{...m,amenitiesDayServe:h}}))==null?void 0:c.sort((m,h)=>m.startTime-h.startTime))??[],amenitiesLimitServe:t.limitOrderPerTime,amenitiesLimitFrameOrder:{from:t.minSlotPerTime,to:t.maxSlotPerTime},amenitiesPreOrder:{from:t.preOrderMinTime,to:t.preOrderMaxTime,fromType:(t==null?void 0:t.preOrderMinTimeType)||J,toType:(t==null?void 0:t.preOrderMaxTimeType)||J},amenitiesPreOrderLimit:{time:t.limitOrderPerUsage,unit:t.limitOrderPerUsageType},amenitiesUsageHoursLimit:{hour:t.limitOrderTimeUsage,unit:t.limitOrderTimeUsageType},amenitiesFormulas:r===G?(((s=(u=t==null?void 0:t.periodTimeServes)==null?void 0:u[0])==null?void 0:s.formulas)??[]).map(m=>({amenitiesFormula:{to:m.to?m.to:null},amenitiesFormulaPrice:m.price})):[],amenitiesPeriodTimePrice:r===oe?((T=(g=(p=t==null?void 0:t.periodTimeServes)==null?void 0:p[0])==null?void 0:g.formulas)==null?void 0:T[0].price)??0:"",amenitiesDepositAmount:t.deposits||null,amenitiesSurcharges:((f=t==null?void 0:t.surcharges)==null?void 0:f.map(m=>({amenitiesSurchargeName:m.name,amenitiesSurchargePrice:m.price})))??[],amenitiesCancelOrderPolicies:l}},te=()=>{const{amenitiesGroup:t,amenitiesList:r,idBuilding:l,setAmenitiesList:n,isEditingAmenitiesGroup:a,isEditingAmenity:o,setIsEditingAmenity:c,setAmenitiesActive:u,amenitiesActive:s}=N.useContext(se),{type:p}=t,[g]=y.useForm(),[T,f]=N.useState({code:void 0,codeLanguage:void 0,isFetching:!1}),[m,h]=N.useState(!1),[_,b]=N.useState(!1);He(T.code,T.codeLanguage,{message:i.success,description:i.save_amenities_success}),N.useEffect(()=>{var O;const M=xe(s,p);g.setFieldsValue({...M}),(O=s==null?void 0:s.utilityBookings)!=null&&O.length?h(!0):h(!1)},[s]);const F=async()=>{if(await g.validateFields()){f({isFetching:!0,code:void 0,codeLanguage:void 0});let O={};if(s.id&&(O=await Xr({idAmenities:s.id,amenities:g.getFieldsValue(),amenitiesGroup:t,idBuilding:l}),ue.includes(O.code))){const{amenitiesUsageHoursLimit:d}=g.getFieldsValue();b((d==null?void 0:d.hour)&&(d==null?void 0:d.unit));const B=[...r],V=B.findIndex(H=>{var z;return H.id===((z=O==null?void 0:O.data)==null?void 0:z.id)});V!==-1&&(B[V]=O.data),n(B),c(!1)}if(!s.id&&(O=await Wr(g.getFieldsValue(),t,l),ue.includes(O.code))){const d=[...r],B=d.findIndex(V=>V.localId===s.localId);d[B]!==-1&&(d[B]=O.data),n(d.sort((V,H)=>R(V.createdAt).isBefore(H.createdAt)?-1:0)??[]),u({...O.data}),c(!1)}f({isFetching:!1,code:O.code,codeLanguage:O.codeLanguage})}},x=()=>{if(s.localId){const M=[...r];for(let O=0;O<M.length;O+=1)if(M[O].localId===s.localId){M.splice(O,1);break}n(M),u(M.length>0?{...M[0]}:void 0)}else{const M=r.findIndex((O,d)=>s.id===O.id);u({...r[M]})}c(!1)},$=async M=>{M&&c(!0)},w={localId:s.localId,...xe(s,p)},k=N.useMemo(()=>!!s.id,[s]);return N.useMemo(()=>{b((s==null?void 0:s.limitOrderTimeUsage)&&(s==null?void 0:s.limitOrderTimeUsageType))},[s]),{amenities:s,initialValues:w,isEditingAmenity:o,amenitiesGroupType:p,amenitiesForm:g,onValuesChange:$,isDisabledField:m,onClickBtnCancel:x,isEditingAmenitiesGroup:a,saveAmenitiesStatus:T,onClickBtnSave:F,isUpdate:k,isHaveAmenitiesUsageHoursLimit:_}},Jr=()=>{const{isDisabledField:t,isUpdate:r,amenitiesGroupType:l,isEditingAmenitiesGroup:n}=te(),[a]=Q();return S(X,{children:[e(U,{gutter:[8,8],children:e(v,{flex:"1 0 0",style:{width:"100%"},children:S(U,{gutter:[12,0],children:[e(v,{span:12,children:e(y.Item,{label:i.limit_the_amenities_usage_times,children:S(D.Group,{compact:!0,children:[e(y.Item,{name:["amenitiesUsageHoursLimit","hour"],noStyle:!0,rules:[({getFieldValue:o})=>({validator(c,u){return o(["amenitiesUsageHoursLimit","unit"])&&!u?Promise.reject(i.status.data_require):Promise.resolve()}})],dependencies:[["amenitiesUsageHoursLimit","unit"]],children:e(q,{style:{width:"calc(50% - 65px)"},className:"site-input-right",placeholder:i.frame,max:Ue,min:1,disabled:n})}),e(D,{style:{width:90,pointerEvents:"none",backgroundColor:"#fafafa",textAlign:"center"},value:`${i.frame.toLowerCase()}/ `,disabled:n}),e(y.Item,{name:["amenitiesUsageHoursLimit","unit"],noStyle:!0,rules:[({getFieldValue:o})=>({validator(c,u){return o(["amenitiesUsageHoursLimit","hour"])&&!u?Promise.reject(i.not_select_unit):Promise.resolve()}})],dependencies:[["amenitiesUsageHoursLimit","hour"]],children:e(L,{allowClear:!0,placeholder:i.select,style:{width:"calc(50% - 25px)"},getPopupContainer:o=>o.parentNode,disabled:n,children:de.map(o=>e(L.Option,{value:o.key,children:o.label},o.key))})})]})})}),e(v,{span:l===G?4:12,children:e(y.Item,{name:"amenitiesTimeDistance",rules:[{required:!0}],label:`${i.time_frame} *`,children:e(L,{fluid:"true",placeholder:i.time_frame,disabled:r||n,getPopupContainer:o=>o.parentNode,children:pr.map(o=>e(L.Option,{value:o.key,children:o.label},o.key))})})}),l===re?null:e(v,{span:l===G?8:12,children:e(y.Item,{label:`${i.serve_ability} *`,name:"amenitiesLimitServe",rules:[{required:!0},{validator(o,c){return c!=null&&c!==""&&c<=0?Promise.reject(i.value_must_greater_than_zero):Math.floor(Number(c))!==Number(c)?Promise.reject(i.value_must_be_integer):Promise.resolve()}}],children:e(q,{max:hr,disabled:n,addonAfter:e("span",{children:i.order_per_one_time_frame.toLowerCase()}),fluid:"true",style:{width:"100%"}})})}),l===G?e(X,{children:e(v,{span:12,children:e(y.Item,{label:i.limit_frame_in_order,className:"site-input-group-wrapper",children:S(D.Group,{compact:!0,children:[e(y.Item,{name:["amenitiesLimitFrameOrder","from"],noStyle:!0,rules:[({getFieldValue:o})=>({validator(c,u){const s=o(["amenitiesLimitFrameOrder","from"]),p=o(["amenitiesLimitFrameOrder","to"]);return j({value:s,isCheckStringNull:!0})&&j({value:p,isCheckStringNull:!0})?Promise.resolve():!j({value:p,isCheckStringNull:!0})&&j({value:s,isCheckStringNull:!0})?Promise.reject(i.data_require):s<0||p<0?Promise.reject(i.value_must_greater_or_equal_than_zero):Math.floor(Number(s))!==Number(s)||Math.floor(Number(p))!==Number(p)?Promise.reject(i.value_must_be_integer):!j({value:p,isCheckStringNull:!0})&&s>p?Promise.reject(i.pre_order_min_must_lower_than_max):Promise.resolve()}})],dependencies:[["amenitiesLimitFrameOrder","to"]],children:e(q,{style:{width:"calc(50% - 65px)"},placeholder:i.from,max:Ae,min:1,disabled:n})}),e(D,{className:"site-input-split",style:{width:30,borderLeft:0,borderRight:0,pointerEvents:"none"},value:"~",disabled:!0}),e(y.Item,{name:["amenitiesLimitFrameOrder","to"],noStyle:!0,children:e(q,{style:{width:"calc(50% - 65px)"},className:"site-input-right",placeholder:i.to,max:Ae,min:1,disabled:n})}),e(D,{style:{width:100,pointerEvents:"none",backgroundColor:"#fafafa",textAlign:"center"},value:i.frame.toLowerCase()})]})})})}):null]})})}),e(y.List,{name:"amenitiesTimeServes",children:(o,{add:c,remove:u})=>{const s=[];for(let p=0;p<o.length;p+=1)s.push(["amenitiesTimeServes",o[p].name,"amenitiesDayServe"]),s.push(["amenitiesTimeServes",o[p].name,"amenitiesPeriodTimeServe"]);return S(X,{children:[e("div",{children:S(K,{fluid:"true",style:{padding:0},type:"link",onClick:()=>{c({amenitiesDayServe:[],amenitiesPeriodTimeServe:[R("07:00","HH:mm"),R("23:00","HH:mm")]})},disabled:n||t,children:["+ ",i.add_serve_time]})}),o.map((p,g)=>e("div",{children:e(U,{gutter:[8,8],children:e(v,{flex:"1 0 0",style:{width:"100%"},children:S(U,{gutter:[12,0],children:[e(v,{span:12,children:e(y.Item,{name:[p.name,"amenitiesDayServe"],fieldKey:[p.fieldKey,"amenitiesDayServe"],rules:[{required:!0}],label:`${i.serve_time} *`,children:e(L,{placeholder:i.day,fluid:"true",mode:"multiple",disabled:t||n,getPopupContainer:T=>T.parentNode,children:yr.map(T=>e(L.Option,{value:T.key,children:T.label},T.key))})},p.key)}),e(v,{span:t||n?12:10,children:e(y.Item,{name:[p.name,"amenitiesPeriodTimeServe"],fieldKey:[p.fieldKey,"amenitiesPeriodTimeServe"],dependencies:s,rules:[{required:!0},({getFieldValue:T})=>({validator(f,m){if(!m||m.length===0)return Promise.resolve();const h=R(m[0]).toDate().getTime(),b=R(m[1]).toDate().getTime()-h;if(b===0)return Promise.reject(i.start_time_must_lower_than_the_end_time);const F=T("amenitiesTimeDistance");let x=36e5;F===gr&&(x=36e5/2),F===fr&&(x=36e5/4);const $=b/x;if($!==Math.floor($))return Promise.reject(i.difference_end_time_and_start_time_is_round_number);const w=T("amenitiesTimeServes"),k=p.name,{amenitiesDayServe:M,amenitiesPeriodTimeServe:O}=w[k],d=[...w].filter((V,H)=>H!==k);let B=!1;if(d&&d.length)for(let V=0;V<d.length;V+=1){const{amenitiesDayServe:H,amenitiesPeriodTimeServe:z}=d[V];if(Mr(M,H)&&Rr(O,z)){B=!0;break}}return B?Promise.reject(i.period_time_existed):Promise.resolve()}})],label:e("div",{}),children:e(kr.RangePicker,{placeholder:[i.start_time,i.end_time],format:"HH:mm",fluid:"true",allowClear:!1,minuteStep:15,disabled:t||n,getPopupContainer:T=>T.parentNode})},p.key)}),t||n?null:e(v,{span:2,children:S(y.Item,{label:e("div",{}),children:[e(Y,{onClick:()=>{o.length>1&&u(p.name)},name:"icon-minus-circle-outlined",style:{fontSize:a.fontSizeLargeIcon}}),p.name!==o.length-1?null:e(Y,{onClick:()=>{c({amenitiesDayServe:[],amenitiesPeriodTimeServe:[R("07:00","HH:mm"),R("23:00","HH:mm")]})},name:"icon-plus-circle-outlined",style:{marginLeft:"10px",fontSize:a.fontSizeLargeIcon}})]})})]})})},p.key)},g))]})}})]})},Qr=()=>{const{isEditingAmenitiesGroup:t}=te();return e(U,{gutter:[8,8],children:e(v,{flex:"1 0 0",style:{width:"100%"},children:S(U,{gutter:[12,0],children:[e(v,{span:12,children:e(y.Item,{label:i.pre_order,className:"site-input-group-wrapper",children:S(D.Group,{compact:!0,children:[e(y.Item,{name:["amenitiesPreOrder","from"],noStyle:!0,rules:[({getFieldValue:r})=>({validator(l,n){const a=r(["amenitiesPreOrder","from"]),o=r(["amenitiesPreOrder","to"]),c=r(["amenitiesPreOrder","fromType"]),u=r(["amenitiesPreOrder","toType"]);if(j({value:a,isCheckStringNull:!0})&&j({value:o,isCheckStringNull:!0}))return Promise.resolve();if(!j({value:a,isCheckStringNull:!0})&&j({value:o,isCheckStringNull:!0})||!j({value:o,isCheckStringNull:!0})&&j({value:a,isCheckStringNull:!0}))return Promise.reject(i.data_require);if(a<0||o<0)return Promise.reject(i.value_must_greater_or_equal_than_zero);if(Math.floor(Number(a))!==Number(a)||Math.floor(Number(o))!==Number(o))return Promise.reject(i.value_must_be_integer);if(c===u){if(a>o)return Promise.reject(i.pre_order_min_must_lower_than_max);if(a===o)return Promise.reject(i.pre_order_min_must_lower_than_max)}if(c!==u){const s=R().add(a,Ee[c]);if(R().add(o,Ee[u]).diff(s,"minutes")<=0)return Promise.reject(i.pre_order_min_must_lower_than_max)}return Promise.resolve()}})],dependencies:[["amenitiesPreOrder","to"],["amenitiesPreOrder","toType"],["amenitiesPreOrder","fromType"]],children:e(q,{style:{width:"calc(25% - 5px)"},placeholder:i.from,max:Ne,disabled:t,min:0})}),e(y.Item,{name:["amenitiesPreOrder","fromType"],noStyle:!0,children:e(L,{style:{width:"calc(25% - 10px)"},disabled:t,children:Fe.map(r=>e(L.Option,{value:r.key,children:r.label},r.key))})}),e(D,{className:"site-input-split",style:{width:30,borderLeft:0,borderRight:0,pointerEvents:"none"},value:"~",disabled:!0}),e(y.Item,{name:["amenitiesPreOrder","to"],noStyle:!0,children:e(q,{style:{width:"calc(25% - 5px)"},type:"number",className:"site-input-right",placeholder:i.to,max:Ne,disabled:t,min:0})}),e(y.Item,{name:["amenitiesPreOrder","toType"],noStyle:!0,children:e(L,{style:{width:"calc(25% - 10px)"},disabled:t,children:Fe.map(r=>e(L.Option,{value:r.key,children:r.label},r.key))})})]})})}),e(v,{span:12,children:e(y.Item,{label:i.limit_order_per_apartment,children:S(D.Group,{compact:!0,children:[e(y.Item,{name:["amenitiesPreOrderLimit","time"],noStyle:!0,rules:[({getFieldValue:r})=>({validator(l,n){return r(["amenitiesPreOrderLimit","unit"])&&!n?Promise.reject(i.not_select_time):Promise.resolve()}})],dependencies:[["amenitiesPreOrderLimit","unit"]],children:e(L,{allowClear:!0,placeholder:i.select_times,style:{width:"calc(50% - 30px)"},getPopupContainer:r=>r.parentNode,disabled:t,children:Me.map(r=>e(L.Option,{value:r,children:r},r))})}),e(D,{style:{width:60,pointerEvents:"none",backgroundColor:"#fafafa",textAlign:"center"},value:`${i.times.toLowerCase()}/ `,disabled:t}),e(y.Item,{name:["amenitiesPreOrderLimit","unit"],noStyle:!0,rules:[({getFieldValue:r})=>({validator(l,n){return r(["amenitiesPreOrderLimit","time"])&&!n?Promise.reject(i.not_select_unit):Promise.resolve()}})],dependencies:[["amenitiesPreOrderLimit","time"]],children:e(L,{allowClear:!0,placeholder:i.select,style:{width:"calc(50% - 30px)"},getPopupContainer:r=>r.parentNode,disabled:t,children:de.map(r=>e(L.Option,{value:r.key,children:r.label},r.key))})})]})})})]})})})},Te=({isDisabledField:t,isEditingAmenitiesGroup:r})=>e(U,{gutter:[8,8],children:e(v,{flex:"1 0 0",style:{width:"100%"},children:S(U,{gutter:[12,0],children:[e(v,{span:12,children:e(y.Item,{name:"amenitiesPeriodTimePrice",label:`${i.price_one_time_frame_with_money_unit} *`,rules:[{validator:(l,n)=>n==null||n===""?Promise.reject(i.data_require):n<0?Promise.reject(i.value_must_greater_or_equal_than_zero):Math.floor(Number(n))!==Number(n)?Promise.reject(i.value_must_be_integer):Promise.resolve()}],children:e(q,{fluid:"true",formatter:l=>l&&l.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:l=>l&&l.toString().replace(/\$\s?|(,*)/g,""),placeholder:i.price,max:ae,disabled:t||r})})}),e(v,{span:12,children:e(y.Item,{name:"amenitiesDepositAmount",label:i.deposit_amount_with_money_unit,rules:[{validator:(l,n)=>n==null||n===""?Promise.resolve():n<=0?Promise.reject(i.value_must_greater_than_zero):Math.floor(Number(n))!==Number(n)?Promise.reject(i.value_must_be_integer):Promise.resolve()}],children:e(q,{fluid:"true",formatter:l=>l&&l.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:l=>l&&l.toString().replace(/\$\s?|(,*)/g,""),placeholder:i.deposit_amount,max:ae,disabled:r})})})]})})}),ve=({updateFields:t,form:r,isDisabledField:l,isEditingAmenitiesGroup:n})=>{const[a]=Q();return S(X,{children:[e(y.List,{name:"amenitiesFormulas",children:(o,{add:c,remove:u})=>S(X,{children:[e("div",{children:S(K,{fluid:"true",style:{padding:0},type:"link",onClick:()=>{const s=r.getFieldValue("amenitiesFormulas");c({amenitiesFormula:{from:s[s.length-1].amenitiesFormula.to,to:""},amenitiesFormulaPrice:""})},disabled:n||l,children:["+ ",i.add_norm]})}),e("div",{children:o.map((s,p)=>e(U,{gutter:[8,8],children:e(v,{flex:"1 0 0",style:{width:"100%"},children:S(U,{gutter:[12,0],children:[e(v,{span:12,children:e(y.Item,{label:`${i.norm} *`,className:"site-input-group-wrapper",children:S(D.Group,{compact:!0,children:[e(y.Item,{noStyle:!0,shouldUpdate:!0,children:({getFieldValue:g})=>{const T=g(["amenitiesFormulas",s.name-1,"amenitiesFormula","to"]);return e(D,{placeholder:i.from,disabled:!0,style:{pointerEvents:"none",width:"calc(50% - 45px)"},value:T?T+1:0})}}),e(D,{className:"site-input-split",style:{width:30,borderLeft:0,borderRight:0,pointerEvents:"none",textAlign:"center"},value:"~",fluid:"true",disabled:l||n}),e(y.Item,{name:[s.name,"amenitiesFormula","to"],fieldKey:[s.fieldKey,"amenitiesFormula","to"],dependencies:[s.name-1<0?[]:["amenitiesFormulas",s.name-1,"amenitiesFormula","to"]],rules:[({getFieldValue:g})=>({validator(T,f){const m=g(["amenitiesFormulas",s.name-1,"amenitiesFormula","to"])||0;if((f==null||f==="")&&s.name!==o.length-1)return Promise.reject(i.data_require);if(!j({value:m})&&s.name!==o.length-1){if(Number(f)<=0)return Promise.reject(i.value_must_greater_than_zero);if(Math.floor(Number(f))!==Number(f))return Promise.reject(i.value_must_be_integer);if(Number(f)<=Number(m))return Promise.reject(i.upper_bound_must_greater_than_lower_bound)}return Promise.resolve()}})],noStyle:!0,children:e(q,{style:{width:"calc(50% - 55px)"},className:"site-input-right",placeholder:p===o.length-1?"":i.to,max:_r,fluid:"true",disabled:l||p===o.length-1||n})},`children-${s.name}`),e(D,{style:{width:70,backgroundColor:"#fafafa",textAlign:"center",pointerEvents:"none"},value:i.frame.toLowerCase(),fluid:"true"})]})},`parent-${s.name}`)}),e(v,{span:l||n?12:10,children:e(y.Item,{name:[s.name,"amenitiesFormulaPrice"],fieldKey:[s.fieldKey,"amenitiesFormulaPrice"],label:`${i.price_one_time_frame_with_money_unit} *`,rules:[{validator:(g,T)=>T==null||T===""?Promise.reject(i.data_require):T<0?Promise.reject(i.value_must_greater_or_equal_than_zero):Math.floor(Number(T))!==Number(T)?Promise.reject(i.value_must_be_integer):Promise.resolve()}],children:e(q,{formatter:g=>g&&g.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:g=>g&&g.toString().replace(/\$\s?|(,*)/g,""),placeholder:i.price,max:ae,fluid:"true",disabled:l||n})})}),l||n?null:e(v,{span:2,children:e(y.Item,{label:e("div",{}),children:S("div",{style:{width:"50px",height:"32px",display:"flex",flexDirection:"row",alignItems:"center"},children:[e(Y,{onClick:()=>{o.length>1&&(u(s.name),t())},name:"icon-minus-circle-outlined",style:{fontSize:a.fontSizeLargeIcon}}),s.name!==o.length-1?null:e(Y,{onClick:()=>{const g=r.getFieldValue("amenitiesFormulas");c({amenitiesFormula:{from:g[g.length-1].amenitiesFormula.to,to:""},amenitiesFormulaPrice:""})},name:"icon-plus-circle-outlined",style:{marginLeft:"10px",fontSize:a.fontSizeLargeIcon}})]})})})]})})},s.key))})]})}),e(U,{gutter:[8,8],children:e(v,{span:12,children:e(y.Item,{name:"amenitiesDepositAmount",label:i.deposit_amount_with_money_unit,rules:[{validator:(o,c)=>c==null||c===""?Promise.resolve():c<=0?Promise.reject(i.value_must_greater_or_equal_than_zero):Math.floor(Number(c))!==Number(c)?Promise.reject(i.value_must_be_integer):Promise.resolve()}],children:e(q,{formatter:o=>o&&o.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:o=>o&&o.toString().replace(/\$\s?|(,*)/g,""),placeholder:i.deposit_amount,max:ae,fluid:"true",disabled:n})})})})]})};ve.propTypes={updateFields:C.func,form:C.oneOfType([C.object]),isDisabledField:C.bool,isEditingAmenitiesGroup:C.bool};ve.defaultProps={updateFields:()=>{},form:null,isDisabledField:!1,isEditingAmenitiesGroup:!1};const Zr=()=>{const{amenitiesForm:t,amenitiesGroupType:r,isDisabledField:l,isEditingAmenitiesGroup:n}=te();return r===oe?e(Te,{isDisabledField:l,isEditingAmenitiesGroup:n}):e(ve,{form:t,updateFields:()=>{const o=t.getFieldValue("amenitiesFormulas"),c=[];for(let u=0;u<o.length;u+=1)u===0?c.push({amenitiesFormula:{from:0,to:o[u].amenitiesFormula.to},amenitiesFormulaPrice:o[u].amenitiesFormulaPrice}):c.push({amenitiesFormula:{from:o[u-1].amenitiesFormula.to,to:o[u].amenitiesFormula.to},amenitiesFormulaPrice:o[u].amenitiesFormulaPrice});t.setFieldsValue({amenitiesFormulas:c})},isDisabledField:l,isEditingAmenitiesGroup:n})};Te.propTypes={isDisabledField:C.bool,isEditingAmenitiesGroup:C.bool};Te.defaultProps={isDisabledField:!1,isEditingAmenitiesGroup:!1};const et=()=>{const[t]=Q(),{isEditingAmenitiesGroup:r,isDisabledField:l}=te();return e(y.List,{name:"amenitiesSurcharges",children:(n,{add:a,remove:o})=>S(X,{children:[e("div",{children:S(K,{fluid:"true",style:{padding:0},type:"link",onClick:()=>{a({amenitiesSurchargeName:"",amenitiesSurchargePrice:null})},disabled:r||l,children:["+ ",i.create_surcharge]})}),e("div",{children:n.map((c,u)=>e(U,{gutter:[8,8],children:e(v,{flex:"1 0 0",style:{width:"100%"},children:S(U,{gutter:[12,0],children:[e(v,{span:12,children:e(y.Item,{name:[c.name,"amenitiesSurchargeName"],fieldKey:[c.fieldKey,"amenitiesSurchargeName"],label:`${i.name} *`,dependencies:[["amenitiesSurcharges",c.name,"amenitiesSurchargePrice"]],rules:[{required:!0}],children:e(D,{placeholder:i.name,maxLength:255,fluid:"true",disabled:r||l})},[c.key,"amenitiesSurchargeName"])}),e(v,{span:l||r?12:10,children:e(y.Item,{name:[c.name,"amenitiesSurchargePrice"],fieldKey:[c.fieldKey,"amenitiesSurchargePrice"],label:`${i.value} *`,dependencies:[["amenitiesSurcharges",c.name,"amenitiesSurchargeName"]],rules:[{required:!0},{validator(s,p){return p==null||p===""?Promise.reject(i.status.data_require):p<=0?Promise.reject(i.value_must_greater_than_zero):Math.floor(Number(p))!==Number(p)?Promise.reject(i.value_must_be_integer):Promise.resolve()}}],children:e(q,{formatter:s=>s&&s.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:s=>s&&s.toString().replace(/\$\s?|(,*)/g,""),placeholder:i.value,max:ae,min:0,fluid:"true",disabled:r||l})},[c.key,"amenitiesSurchargePrice"])}),r||l?null:e(v,{span:2,children:S(y.Item,{label:e("div",{}),children:[e(Y,{onClick:()=>{o(c.name)},name:"icon-minus-circle-outlined",style:{fontSize:t.fontSizeLargeIcon}}),c.name!==n.length-1?null:e(Y,{onClick:()=>{a({amenitiesSurchargeName:"",amenitiesSurchargePrice:null})},name:"icon-plus-circle-outlined",style:{marginLeft:"10px",fontSize:t.fontSizeLargeIcon}})]})})]})})},u))})]})})},Se=({fieldIndex:t,isEditingAmenitiesGroup:r,isDisabledField:l,form:n,field:a,fields:o,remove:c,add:u,updateFields:s,amenitiesCancelOrderPolicyTypeRefundableLevelDependencies:p,amenitiesCancelOrderPolicyTypeRefundableValueDependencies:g})=>{const[T]=Q();return e(U,{gutter:[8,8],children:e(v,{flex:"1 0 0",style:{width:"100%"},children:S(U,{gutter:[12,0],children:[e(v,{span:12,children:e(y.Item,{label:`${i.refundable} *`,className:"site-input-group-wrapper",children:S(D.Group,{compact:!0,children:[e(y.Item,{noStyle:!0,shouldUpdate:!0,children:({getFieldValue:f})=>{const m=f(["amenitiesCancelOrderPolicies",a.name-1,"amenitiesCancelOrderPolicy","to"]);return e(D,{fluid:"true",placeholder:i.from,disabled:!0,style:{pointerEvents:"none",width:"calc(50% - 110px)"},value:m?m+1:0})}}),e(D,{fluid:"true",className:"site-input-split",style:{width:30,borderLeft:0,borderRight:0,pointerEvents:"none",textAlign:"center"},value:"~",disabled:r||l}),e(y.Item,{name:[a.name,"amenitiesCancelOrderPolicy","to"],fieldKey:[a.fieldKey,"amenitiesCancelOrderPolicy","to"],dependencies:[a.name-1<0?[]:["amenitiesCancelOrderPolicies",a.name-1,"amenitiesCancelOrderPolicy","to"]],rules:[({getFieldValue:f})=>({validator(m,h){const _=f(["amenitiesCancelOrderPolicies",a.name-1,"amenitiesCancelOrderPolicy","to"])||0;if((h==null||h==="")&&a.name!==o.length-1)return Promise.reject(i.data_require);if(!j({value:_})&&a.name!==o.length-1){if(Number(h)<=0)return Promise.reject(i.value_must_greater_than_zero);if(Math.floor(Number(h))!==Number(h))return Promise.reject(i.value_must_be_integer);if(Number(h)<=Number(_))return Promise.reject(i.upper_bound_must_greater_than_lower_bound)}return Promise.resolve()}})],noStyle:!0,children:e(q,{fluid:"true",style:{width:"calc(50% - 110px)"},className:"site-input-right",placeholder:t===o.length-1?"":i.to,max:Pr,min:1,disabled:t===o.length-1||r||l})},`children-${a.name}`),e(D,{fluid:"true",style:{width:190,backgroundColor:"#fafafa",textAlign:"center",pointerEvents:"none"},value:i.date_before_usage,disabled:r||l})]})},`parent-${a.name}`)}),e(v,{span:6,children:e(y.Item,{name:[a.name,"amenitiesCancelOrderPolicyTypeRefundableLevel"],fieldKey:[a.fieldKey,"amenitiesCancelOrderPolicyTypeRefundableLevel"],label:`${i.refund_level} *`,rules:[{required:!0},({getFieldValue:f})=>({validator(m,h){const _=f("amenitiesCancelOrderPolicies");let b;for(let F=0;F<_.length;F+=1)if(!b)b=_[F].amenitiesCancelOrderPolicyTypeRefundableLevel;else if(b!==_[F].amenitiesCancelOrderPolicyTypeRefundableLevel)return Promise.reject(i.refund_level_must_have_same_value);return Promise.resolve()}})],dependencies:p,children:e(L,{placeholder:i.refund_level,fluid:"true",getPopupContainer:f=>f.parentNode,disabled:r||l,children:Tr.map(f=>e(L.Option,{value:f.key,children:f.label},f.key))})},a.fieldKey)}),e(v,{span:l||r?6:4,children:e(y.Item,{name:[a.name,"amenitiesCancelOrderPolicyTypeRefundableValue"],fieldKey:[a.fieldKey,"amenitiesCancelOrderPolicyTypeRefundableValue"],label:`${i.value} *`,dependencies:[["amenitiesCancelOrderPolicies",a.name,"amenitiesCancelOrderPolicyTypeRefundableLevel"],...g],rules:[{required:!0},({getFieldValue:f})=>({validator(m,h){if(h==null||h==="")return Promise.reject(i.status.data_require);if(h<0)return Promise.reject(i.value_must_greater_or_equal_than_zero);if(Math.floor(Number(h))!==Number(h))return Promise.reject(i.value_must_be_integer);const _=f(["amenitiesCancelOrderPolicies",a.name,"amenitiesCancelOrderPolicyTypeRefundableLevel"]);if(h>100&&_===pe)return Promise.reject(i.value_must_lower_than_one_hundred_percent);const b=f("amenitiesCancelOrderPolicies");for(let F=0;F<b.length-1;F+=1)if(Number(b[F].amenitiesCancelOrderPolicyTypeRefundableValue)>Number(b[F+1].amenitiesCancelOrderPolicyTypeRefundableValue))return Promise.reject(i.value_must_sort_from_low_to_high);return Promise.resolve()}})],children:e(q,{fluid:"true",formatter:f=>f&&f.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:f=>f&&f.toString().replace(/\$\s?|(,*)/g,""),placeholder:i.value,max:ae,disabled:r||l})},a.fieldKey)}),r||l?null:e(v,{span:2,children:e(y.Item,{label:e("div",{}),children:S("div",{style:{width:"50px",height:"32px",display:"flex",flexDirection:"row",alignItems:"center"},children:[e(Y,{onClick:()=>{c(a.name),s()},name:"icon-minus-circle-outlined",style:{fontSize:T.fontSizeLargeIcon}}),a.name!==o.length-1?null:e(Y,{onClick:()=>{var m,h;const f=n.getFieldValue("amenitiesCancelOrderPolicies");u({amenitiesCancelOrderPolicy:{from:((h=(m=f==null?void 0:f[f.length-1])==null?void 0:m.amenitiesCancelOrderPolicy)==null?void 0:h.to)??0,to:""},amenitiesCancelOrderPolicyTypeRefundableLevel:pe,amenitiesCancelOrderPolicyTypeRefundableValue:null}),s()},name:"icon-plus-circle-outlined",style:{marginLeft:"10px",fontSize:T.fontSizeLargeIcon}})]})})})]})})},a.key)};Se.propTypes={fieldIndex:C.number,isEditingAmenitiesGroup:C.bool,isDisabledField:C.bool,form:C.oneOfType([C.object]),field:C.objectOf(C.any),fields:C.arrayOf(C.objectOf(C.any)),remove:C.func,add:C.func,updateFields:C.func,amenitiesCancelOrderPolicyTypeRefundableLevelDependencies:C.arrayOf(C.arrayOf(C.any)),amenitiesCancelOrderPolicyTypeRefundableValueDependencies:C.arrayOf(C.arrayOf(C.any))};Se.defaultProps={fieldIndex:0,isEditingAmenitiesGroup:!1,isDisabledField:!1,form:null,field:"",fields:[],remove:()=>{},add:()=>{},updateFields:[],amenitiesCancelOrderPolicyTypeRefundableLevelDependencies:[],amenitiesCancelOrderPolicyTypeRefundableValueDependencies:[]};const rt=()=>{const{amenitiesForm:t,isEditingAmenitiesGroup:r,isDisabledField:l}=te(),n=()=>{const a=t.getFieldValue("amenitiesCancelOrderPolicies"),o=[];for(let c=0;c<a.length;c+=1)c===0?o.push({key:(a==null?void 0:a.id)??c,amenitiesCancelOrderPolicy:{from:0,to:a[c].amenitiesCancelOrderPolicy.to},amenitiesCancelOrderPolicyTypeRefundableLevel:a[c].amenitiesCancelOrderPolicyTypeRefundableLevel,amenitiesCancelOrderPolicyTypeRefundableValue:a[c].amenitiesCancelOrderPolicyTypeRefundableValue}):o.push({amenitiesCancelOrderPolicy:{from:a[c-1].amenitiesCancelOrderPolicy.to+1,to:a[c].amenitiesCancelOrderPolicy.to},amenitiesCancelOrderPolicyTypeRefundableLevel:a[c].amenitiesCancelOrderPolicyTypeRefundableLevel,amenitiesCancelOrderPolicyTypeRefundableValue:a[c].amenitiesCancelOrderPolicyTypeRefundableValue});t.setFieldsValue({amenitiesCancelOrderPolicies:o})};return e(y.List,{name:"amenitiesCancelOrderPolicies",children:(a,{add:o,remove:c})=>{const u=[],s=[];for(let p=0;p<a.length;p+=1){const g=a[p];u.push(["amenitiesCancelOrderPolicies",g.name,"amenitiesCancelOrderPolicyTypeRefundableLevel"]),u.push(["amenitiesCancelOrderPolicies",g.name,"amenitiesCancelOrderPolicy","type"]),s.push(["amenitiesCancelOrderPolicies",g.name,"amenitiesCancelOrderPolicyTypeRefundableValue"])}return S(X,{children:[e("div",{children:S(K,{style:{padding:0},type:"link",onClick:()=>{var g,T;const p=t.getFieldValue("amenitiesCancelOrderPolicies");o({amenitiesCancelOrderPolicy:{from:((T=(g=p==null?void 0:p[p.length-1])==null?void 0:g.amenitiesCancelOrderPolicy)==null?void 0:T.to)??0,to:""},amenitiesCancelOrderPolicyTypeRefundableLevel:pe,amenitiesCancelOrderPolicyTypeRefundableValue:null}),n()},disabled:r||l,children:["+ ",i.create_cancel_order_policy]})}),e("div",{children:a.map((p,g)=>e(Se,{isEditingAmenitiesGroup:r,isDisabledField:l,fieldIndex:g,form:t,remove:c,add:o,field:p,fields:a,updateFields:n,amenitiesCancelOrderPolicyTypeRefundableLevelDependencies:u,amenitiesCancelOrderPolicyTypeRefundableValueDependencies:s||[]},p.key))})]})}})},tt=()=>{const{isEditingAmenitiesGroup:t,isDisabledField:r,amenitiesForm:l}=te();return e(U,{gutter:[8,8],children:e(v,{flex:"1 0 0",style:{width:"100%"},children:S(U,{gutter:[12,0],children:[e(v,{span:12,children:e(y.Item,{rules:[{required:!0}],label:`${i.amenities_name} *`,name:"amenitiesName",children:e(D,{fluid:"true",placeholder:i.amenities_name,disabled:t})})}),e(v,{span:12,children:e(y.Item,{label:i.status1,name:"amenitiesStatus",valuePropName:"checked",children:e(Ge,{disabled:t,children:i.active})})}),e(v,{span:12,children:e(y.Item,{rules:[{required:!0}],label:`${i.amenities_code} *`,name:"amenitiesCode",children:e(D,{fluid:"true",placeholder:i.amenities_code,style:{textTransform:"uppercase"},disabled:t})})}),e(v,{span:12,children:e(y.Item,{rules:[{required:!0}],label:`${i.location} *`,name:"amenitiesLocation",children:e(D,{fluid:"true",placeholder:i.location,disabled:t})})}),e(v,{span:12,children:e(y.Item,{name:"amenitiesStartDateServe",dependencies:["amenitiesEndDateServe"],rules:[{required:!0},({getFieldValue:n})=>({validator(a,o){if(!o||!n("amenitiesEndDateServe"))return Promise.resolve();const c=R(o).startOf("day"),u=R(n("amenitiesEndDateServe")).startOf("day");return c.isSameOrBefore(u)?Promise.resolve():Promise.reject(i.start_date_not_greater_than_end_date)}})],label:`${i.start_date} *`,children:e(Ie,{disabledDate:n=>n&&n<R().startOf("day"),placeholder:i.start_date,format:"DD/MM/YYYY",fluid:"true",allowClear:!1,disabled:r||t,getPopupContainer:n=>n.parentNode})})}),e(v,{span:12,children:e(y.Item,{name:"amenitiesEndDateServe",dependencies:["amenitiesStartDateServe"],rules:[({getFieldValue:n})=>({validator(a,o){if(!o||!n("amenitiesStartDateServe"))return Promise.resolve();const c=R(n("amenitiesStartDateServe")).startOf("day");return R(o).startOf("day").isSameOrAfter(c)?Promise.resolve():Promise.reject(i.end_date_not_lower_than_start_date)}})],label:i.end_date,children:e(Ie,{disabledDate:n=>{const a=l.getFieldValue("amenitiesStartDateServe");return n&&n<R(a).startOf("day")&&n<R().startOf("day")},placeholder:i.end_date,format:"DD/MM/YYYY",fluid:"true",disabled:r||t,getPopupContainer:n=>n.parentNode})})})]})})})};var it={name:"2qga7i",styles:"text-align:right"};const nt=()=>{const[t]=Q(),{amenities:r,initialValues:l,amenitiesGroupType:n,amenitiesForm:a,onValuesChange:o,onClickBtnCancel:c,isEditingAmenitiesGroup:u,saveAmenitiesStatus:s,onClickBtnSave:p,isEditingAmenity:g}=te();return S(y,{layout:"vertical",name:"amenitiesForm",initialValues:l,form:a,hideRequiredMark:!0,scrollToFirstError:!0,onValuesChange:o,children:[e(tt,{}),n!==re?e(Qr,{}):null,e(Jr,{}),n!==re?S(X,{children:[e(Zr,{}),e(et,{}),e(rt,{form:a})]}):null,S("div",{css:it,children:[((r==null?void 0:r.localId)||g)&&e(K,{onClick:c,css:ee({marginRight:t.marginSm},"",""),children:i.cancel})||null,e(K,{disabled:u||s.isFetching||!g,loading:s==null?void 0:s.isFetching,onClick:p,type:"primary",children:i.save})]})]})},at=t=>t===oe?Sr:t===G?br:"",lt=t=>t===oe?[{name:null,price:null}]:t===G?[{name:"",price:null,from:0,to:null}]:[];var ot={name:"2qga7i",styles:"text-align:right"};const st=()=>{const{amenitiesGroup:t,amenitiesList:r,isEditingAmenitiesGroup:l,setAmenitiesList:n,idBuilding:a,isEditingAmenity:o,setIsEditingAmenity:c,amenitiesActive:u,setAmenitiesActive:s}=N.useContext(se),[p]=Q();N.useEffect(()=>{u||s(r==null?void 0:r[0])},[t]);const g=m=>{s({...m})},T=()=>{const m={id:null,localId:R().millisecond(),name:`${t.name} ${(r==null?void 0:r.length)+1}`,code:`${t.code}_${(r==null?void 0:r.length)+1}`,status:le,location:null,activeStartDate:R().startOf("day").toDate(),activeEndDate:void 0,periodTimeServes:[{startTime:700,endTime:2300,dayInWeek:vr,formulaType:at(t.type),formulas:lt(t.type)}],timeDistance:ye,limitOrderPerTime:1,preOrderMinTime:null,preOrderMaxTime:null,preOrderMinTimeType:J,preOrderMaxTimeType:J,limitOrderPerUsage:void 0,limitOrderPerUsageType:void 0,deposits:null,surcharges:[],cancelBookingConditions:[],unitGroupId:a};n([...r,m]),s(m),c(!0)},f=!t.id||l||o;return t.id?S(ne,{children:[e(ne.Header,{borderBottom:!0,children:S(U,{gutter:[12,0],children:[S(he,{centerVertical:!0,span:"12",children:[e(Y,{name:"icon-list-alt-outlined",style:{marginRight:p.marginSm,fontSize:p.fontSizeLargeIcon}}),e(Ye,{children:i.amenities_info})]}),e(v,{span:"12",css:ot,children:e(K,{onClick:T,disabled:f,type:"primary",children:i.add_amenities})})]})}),e(ne.Content,{children:r.length>0?S(U,{gutter:[12,0],children:[e(v,{span:"4",children:e(wr,{mode:"inline",css:ee({height:"100%",padding:p.padding},"",""),selectedKeys:[u==null?void 0:u.id],children:r.map(m=>e(Lr,{onClick:()=>g(m),className:((u==null?void 0:u.id)??(u==null?void 0:u.localId))===((m==null?void 0:m.id)??(m==null?void 0:m.localId))?"selected":"",disabled:o||l,children:e("span",{children:m.name})},m.id))})}),u?e(he,{span:"20",children:e(nt,{})}):null]}):null})]}):null},dt=()=>{const{idAmenitiesGroup:t,idBuilding:r,getAmenitiesGroupStatus:l,setGetAmenitiesGroupStatus:n,setAmenitiesGroup:a,setAmenitiesList:o}=N.useContext(se),[c]=Q();return N.useEffect(()=>{(async()=>{if(t){n({isFetching:!0});const u=await Ke(t,r);if(u.data){const s=(u==null?void 0:u.data)??{},p=(s==null?void 0:s.amenities)??[];a(s),o(p)}n({isFetching:!1})}})()},[]),l.isFetching?e(Or,{isLoading:!0}):S(X,{children:[e("div",{css:ee({marginBottom:c.margin},"",""),children:e(Kr,{})}),e(st,{})]})},Lt=()=>e(Pe,{children:e(dt,{})});export{Lt as A};
