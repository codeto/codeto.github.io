import{j as e,a as f,u as et,F as we,c as tt,b as te}from"./@emotion-63839449.js";import{l as J,P as Ce,N as le,D as kt,a as ke,d as Lt,k as qe,w as gt,T as Vt}from"./index-b17d22e5.js";import{l as i,by as $e,a9 as K,s as ie,cf as it,b0 as Bt,K as Ee,a$ as Ut,at as zt,bv as Dt,ax as Gt,cP as Je,a0 as st,I as Q,c6 as me,hv as Tt,a1 as Ft,a as wt,hw as Mt,hx as Ht,hy as Wt,dk as Yt,S as bt,hz as $t,hA as jt,hB as Qt,hC as qt,hD as Jt,hE as Kt,hF as Xt,hG as Zt,hH as ei}from"./index-c2ded735.js";import"./lodash-88fe09e6.js";import{h as G}from"./moment-a468e1f9.js";import"./file-saver-40cf32a9.js";import{P as ae}from"./prop-types-1172f4d5.js";import{B as Qe}from"./index-881eef42.js";import{F as w,u as lt}from"./index-687ba9e6.js";import{r as R}from"./react-4fd50329.js";import"./react-redux-896b353b.js";import"./@firebase-43527ee1.js";import{u as ti,a as ii}from"./react-router-a4308f7b.js";import{C as Ae,u as ni,g as ai}from"./registrationFromSetting-8b4f2e37.js";import{u as oi}from"./useQuery-d54d310a.js";import{c as At,B as ve,D as ri,w as Ke,T as be,R as j,b as F,a as V,G as si,I as ft,n as xt,A as Rt,S as li,P as ci}from"./antd-f9eae174.js";import{I as re,S as oe}from"./index-43183512.js";import{c as Et}from"./compareObject-7b349d22.js";import{P as Xe}from"./index-d2c5b7c0.js";import{F as di}from"./file-8888dc2a.js";import{D as _t}from"./document-96ae7510.js";import{g as ui}from"./getPageByTotalAndLimit-7f60b558.js";import{e as pi}from"./exportExcel-837be6ed.js";import{a as mi}from"./buildingConfig-5e834703.js";import"./hoist-non-react-statics-23d96a9a.js";import"./react-is-e8e5dbb3.js";import"./@babel-b64fd0f9.js";import"./stylis-79144faa.js";import"./react-router-dom-2a8f5f6d.js";import"./history-a1882333.js";import"./resolve-pathname-e210f2ac.js";import"./tiny-invariant-dd7d57d2.js";import"./account-86ffff50.js";import"./libphonenumber-js-0d5a9c92.js";import"./react-infinite-scroll-component-e33646cb.js";import"./redux-10bbab4c.js";import"./react-dom-40621ea0.js";import"./classnames-4ba1ba1a.js";import"./scheduler-765c72db.js";import"./@redux-saga-8bafe09b.js";import"./redux-logger-e1c9ca90.js";import"./dompurify-8e338605.js";import"./query-string-f5cca1e7.js";import"./decode-uri-component-4138e85d.js";import"./split-on-first-4f1167c8.js";import"./filter-obj-2ed190f4.js";import"./oidc-client-7da0eaf7.js";import"./firebase-878887a2.js";import"./rc-pagination-c1e6a0ac.js";import"./rc-picker-2e3d5fe5.js";import"./rc-util-0bc219f3.js";import"./rc-trigger-570b13ec.js";import"./rc-motion-ae889c42.js";import"./rc-align-e5d7b12e.js";import"./dom-align-ecb06dd6.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./rc-resize-observer-b9ad4e29.js";import"./@ant-design-cba9d434.js";import"./@ctrl-fb5a5473.js";import"./rc-tabs-dfd19a56.js";import"./rc-dropdown-5378dd0a.js";import"./rc-menu-b15ebfe9.js";import"./rc-overflow-6be96612.js";import"./rc-select-564caf01.js";import"./rc-virtual-list-8a7b82a6.js";import"./rc-collapse-11b7d3c4.js";import"./shallowequal-4542d6f7.js";import"./rc-drawer-317f0b4d.js";import"./@rc-component-5a112e55.js";import"./rc-field-form-ef5549aa.js";import"./async-validator-dee29e8b.js";import"./scroll-into-view-if-needed-6b992d05.js";import"./compute-scroll-into-view-183f845a.js";import"./rc-image-e0357917.js";import"./rc-dialog-b1d1f07b.js";import"./rc-input-number-8bc068f7.js";import"./rc-rate-c64cf0d5.js";import"./rc-steps-2d1924c7.js";import"./rc-switch-b4e96de7.js";import"./rc-table-191ecc42.js";import"./rc-checkbox-018e8052.js";import"./rc-tree-67773537.js";import"./rc-tree-select-cb7eccc3.js";import"./copy-to-clipboard-64585c8c.js";import"./toggle-selection-93f4ad84.js";import"./rc-textarea-d01adcbb.js";import"./rc-input-02c2c2ba.js";import"./rc-upload-3ab0f08a.js";import"./rc-notification-d13dc43b.js";import"./rc-progress-4f1a7096.js";import"./rc-tooltip-08fa4217.js";import"./use-sync-external-store-5d1b6592.js";import"./idb-cdd1a92f.js";import"./path-to-regexp-ef8d5544.js";import"./xlsx-0fb7ed70.js";const hi="ACTION_REGISTER",gi="ACTION_CANCEL",fi="ACTION_LOST",_i="ACTION_UPDATE",Ve=[{label:i.registration_type_vehicle,value:hi,color:"green"},{label:i.registration_type_cancel,value:gi,color:"red"},{label:i.registration_type_card_lost,value:fi,color:"yellow"},{label:i.registration_type_card_update,value:_i,color:"blue"}],Ue="VEHICLE_CARD",ct="RESIDENT_CARD",Be=[{label:i.vehicle_card,value:Ue},{label:i.resident_card,value:ct}],ze=$e(Ve,"value"),nt=$e(Be,"value"),de="WAITING_FOR_APPROVED",W="APPROVED",se="IN_PROGRESS",q="COMPLETED",ce="CANCELLED",he="ALL",It=[{label:i.waiting_for_approved,value:de,color:"orange"},{label:i.approved,value:W,color:"green"},{label:i.in_progress,value:se,color:"blue"},{label:i.complete,value:q,color:"green"},{label:i.canceled,value:ce,color:"red"},{label:i.all,value:he}],pe=$e(It,"value"),Ne={unitName:"",code:"",actions:[],types:[],createdAt:[]},Ct="EMPLOYEE",yt="RESIDENT";Ct+"",i.employee,yt+"",i.resident;const De="APPROVE",Ci="CONFIRMED",Ge="IN_PROGRESS",Me="COMPLETED",He="DEPOSIT",We="REFUND",Ye="CANCEL",yi="NO_DEPOSIT",Ot="WAIT_FOR_DEPOSIT",dt="DEPOSITED",Si="REFUNDED",vi=[{label:i.no_deposit_yet,value:yi,color:"default"},{label:i.wait_for_deposit,value:Ot,color:"yellow"},{label:i.deposited,value:dt,color:"green"},{label:i.refunded,value:Si,color:"blue"}],Pe=$e(vi,"value"),Ti="create",Fi="update",wi="approved",bi="in_progress",Ai="completed",xi="cancelled",Ri=[{label:i.add,value:Ti},{label:i.update,value:Fi},{label:i.approve,value:wi},{label:i.in_progress,value:bi},{label:i.complete,value:Ai},{label:i.cancel,value:xi}],Ei=$e(Ri,"value"),X=R.createContext({idBuilding:0,tableData:{records:[],totalRecord:0},setTableData:()=>{},getCardRegistrationStatus:{isFetching:!1},setGetCardRegistrationStatus:()=>{},filter:{...Ne},setFilter:()=>{},tablePagination:{current:K,limit:ie},setTablePagination:()=>{},tableSelection:()=>{},formDetailCardRegistration:{isShow:!1,data:{}},hideFormDetailCardRegistration:()=>{},showFormDetailCardRegistration:()=>{},formAddCardRegistration:{isShow:!1,data:{}},showFormAddCardRegistration:()=>{},hideFormAddCardRegistration:()=>{},showFormUpdateStatus:()=>{},formUpdateStatusCardRegistration:{isShow:!1,data:{}},hideFormUpdateStatus:()=>{},status:de,setStatus:()=>{},formConfigData:{isShow:!1,data:{}},showFormConfig:()=>{},hideFormConfig:()=>{},formUpdateData:{isShow:!1,data:{}},showFormUpdate:()=>{},hideFormUpdate:()=>{},cardRegistrationPermissionWrite:!1,cardRegistrationPermissionApprove:!1,cardRegistrationPermissionExport:!1,formFilter:void 0,formExportCardRegistration:{isShow:!1,data:{}},showFormExportCardRegistration:()=>{},hideFormExportCardRegistration:()=>{},settingRegistrationForms:[],setSettingRegistrationForm:()=>{},cardRegistrationSetting:{status:it},formHistoryCardRegistration:{isShow:!1,data:{}},showFormHistoryCardRegistration:()=>{},hideFormHistoryCardRegistration:()=>{},dataHistory:[],setDataHistory:()=>{},formConfirmExit:!1,setFormConfirmExit:()=>{}}),ut=({children:a})=>{const{getPermissionByModuleCode:o}=Bt(),t=ti(),{idBuilding:r}=t,[n]=w.useForm(),[d,m]=R.useState({isFetching:!1}),[u,g]=R.useState({...Ne}),[_,y]=R.useState({current:K,limit:ie}),[S,p]=R.useState({records:[],totalRecord:0}),[c,v]=R.useState(de),[b,x]=R.useState([]),[h,s,l]=Ee(),[k,E]=R.useState([]),[A,I]=R.useState(!1),[M,P,T]=Ee(),[O,U,H]=Ee(),[Z,ee,ue]=Ee(),[ge,fe,_e]=Ee(),[N,L,Y]=Ee(),B=R.useMemo(()=>(b==null?void 0:b.find(Le=>Le.type===Ae))??{status:it},[b]),z=o(Ut),D=(z==null?void 0:z[zt])??!1,ye=(z==null?void 0:z[Dt])??!1,Re=(z==null?void 0:z[Gt])??!1,Te={idBuilding:r,tableData:S,setTableData:p,getCardRegistrationStatus:d,setGetCardRegistrationStatus:m,filter:u,setFilter:g,tablePagination:_,setTablePagination:y,cardRegistrationSetting:B,settingRegistrationForms:b,setSettingRegistrationForm:x,formDetailCardRegistration:O,showFormDetailCardRegistration:U,hideFormDetailCardRegistration:H,showFormUpdateStatus:ee,hideFormUpdateStatus:ue,status:c,setStatus:v,formAddCardRegistration:M,showFormAddCardRegistration:P,hideFormAddCardRegistration:T,formConfigData:ge,showFormConfig:fe,hideFormConfig:_e,formUpdateStatusCardRegistration:Z,formExportCardRegistration:N,showFormExportCardRegistration:L,hideFormExportCardRegistration:Y,cardRegistrationPermissionExport:ye,cardRegistrationPermissionWrite:D,cardRegistrationPermissionApprove:Re,formFilter:n,formHistoryCardRegistration:h,showFormHistoryCardRegistration:s,hideFormHistoryCardRegistration:l,dataHistory:k,setDataHistory:E,formConfirmExit:A,setFormConfirmExit:I};return e(X.Provider,{value:Te,children:a})};ut.propTypes={children:ae.node};ut.defaultProps={children:e("div",{})};const Ii=ut,Oi=async(a,o,t)=>{var u;const n={formConfigs:[...((u=a==null?void 0:a.filter(g=>g.type!==Ae))==null?void 0:u.map(g=>({type:g.type,status:g.status})))??[],{type:Ae,status:o.status?Je:it}]},{code:d,codeLanguage:m}=await ni(n,t);return[d,m]},xe=()=>{const{getAllQuery:a,setQuery:o}=oi(),{setTablePagination:t,setStatus:r,setFilter:n,formFilter:d}=R.useContext(X);return{getQueryParamsCardRegistration:()=>{var l,k,E,A,I,M;const{limit:g,page:_,status:y,code:S,actions:p,types:c,unitName:v,createdFrom:b,createdTo:x}=a(),h={pagination:{limit:g&&+g||ie,page:_&&+_||K},status:y||de,filter:{code:S||"",unitName:v||"",createdAt:b&&x&&G(b,J,!0).isValid()&&G(x,J,!0).isValid()?[G(b,J),G(x,J)]:[],types:(c==null?void 0:c.length)&&(c==null?void 0:c.split(","))||[],actions:(p==null?void 0:p.length)&&(p==null?void 0:p.split(","))||[]}};t({limit:h.pagination.limit,current:h.pagination.page}),r(h.status),n({...h.filter}),d.setFieldsValue({...h.filter});const s={limit:h.pagination.limit,page:h.pagination.page,status:h.status,code:(l=h.filter)==null?void 0:l.code,unitName:(k=h.filter)==null?void 0:k.unitName,types:((A=(E=h==null?void 0:h.filter)==null?void 0:E.types)==null?void 0:A.join(","))||"",actions:((M=(I=h==null?void 0:h.filter)==null?void 0:I.actions)==null?void 0:M.join(","))||"",createdFrom:"",createdTo:""};return Array.isArray(h.filter.createdAt)&&h.filter.createdAt.length&&(s.createdFrom=G(h.filter.createdAt[0]).format(J),s.createdTo=G(h.filter.createdAt[1]).format(J)),o(s),h},setQueryParamsCardRegistration:({limit:g=ie,page:_=K,status:y=de,filter:S=Ne})=>{const{code:p="",unitName:c="",actions:v="",types:b="",createdAt:x=null}=S,h={limit:g,page:_,status:y,code:p,unitName:c,actions:Array.isArray(v)&&(v==null?void 0:v.length)>0?v==null?void 0:v.join(","):"",types:Array.isArray(b)&&(b==null?void 0:b.length)>0?b==null?void 0:b.join(","):"",createdFrom:"",createdTo:""};Array.isArray(x)&&x.length&&(h.createdFrom=G(x[0]).format(J),h.createdTo=G(x[1]).format(J)),o(h)}}},pt=({setVisibleSettingOverlay:a})=>{const[o]=w.useForm(),{idBuilding:t,filter:r,cardRegistrationSetting:n,settingRegistrationForms:d,setSettingRegistrationForm:m,status:u}=R.useContext(X),[g,_]=R.useState({code:void 0,codeLanguage:void 0,isFetching:!1}),{getCardRegistrationBadges:y}=st(),{setQueryParamsCardRegistration:S}=xe();return lt(g.code,g.codeLanguage,{message:i.success,description:i.update_data_success}),[async()=>{_({code:void 0,codeLanguage:void 0,isFetching:!0});try{const c={status:o.getFieldValue("status")},[v,b]=await Oi(d,c,t);a(!1),_({code:v,codeLanguage:b,isFetching:!1});const x=[...d.filter(h=>h.type!==Ae),{...n,...c}];m(x),u===de&&S({current:K,limit:ie,filter:{...r},status:u}),await y(t)}catch(c){_({code:c.code,codeLanguage:c.codeLanguage,isFetching:!1})}},{status:n.status===Je},g,o]};pt.propTypes={setVisibleSettingOverlay:ae.func};pt.defaultProps={setVisibleSettingOverlay:()=>{}};const mt=({setVisibleSettingOverlay:a})=>{const[o,t,r,n]=pt({setVisibleSettingOverlay:a});return e(Qe,{rise:!0,style:{width:"315px"},children:f(w,{initialValues:t,layout:"vertical",form:n,name:"formSetting",children:[e(Qe.Header,{}),e(Qe.Content,{children:e(w.Item,{name:"status",valuePropName:"checked",children:e(At,{children:i.active})})}),e(Qe.Footer,{borderTop:!0,style:{textAlign:"right"},children:e(ve,{loading:r.isFetching,htmlType:"submit",onClick:o,children:i.confirm})})]})})};mt.propTypes={setVisibleSettingOverlay:ae.func};mt.defaultProps={setVisibleSettingOverlay:()=>{}};const Pi=()=>{const{tableData:a,showFormAddCardRegistration:o,cardRegistrationPermissionWrite:t,cardRegistrationPermissionExport:r,cardRegistrationPermissionApprove:n,showFormExportCardRegistration:d}=R.useContext(X),[m,u]=R.useState(!1),g=p=>{u(p)},{totalRecord:_}=a;return{totalRecord:_,onClickBtnAdd:()=>{o()},cardRegistrationPermissionWrite:t,cardRegistrationPermissionExport:r,cardRegistrationPermissionApprove:n,visibleSettingOverlay:m,onVisibleSettingOverlayChange:g,setVisibleSettingOverlay:u,handleExportCardRegistration:()=>{d()}}},Ni=()=>{const{totalRecord:a,onClickBtnAdd:o,visibleSettingOverlay:t,onVisibleSettingOverlayChange:r,setVisibleSettingOverlay:n,handleExportCardRegistration:d,cardRegistrationPermissionWrite:m,cardRegistrationPermissionExport:u,cardRegistrationPermissionApprove:g}=Pi(),_=[g?e(ri,{open:t,onOpenChange:r,trigger:["click"],overlay:e(mt,{setVisibleSettingOverlay:n}),css:y=>({marginRight:y.margin.xs}),children:e(ve,{type:"primary",ghost:!0,icon:e(Q,{name:"icon-setting-outlined"}),children:i.setting})},"setting"):null,u?e(ve,{type:"primary",ghost:!0,onClick:d,icon:e(Q,{name:"icon-download-outlined"}),css:y=>({marginRight:y.margin.xs}),children:i.export},"export"):null,m?e(ve,{onClick:o,type:"primary",icon:e(Q,{name:"icon-plus-circle-outlined"}),children:i.add},"add"):null].filter(Boolean);return e(Ce.ActionBox,{total:a,actions:_})},ki=a=>{var l,k,E,A,I,M;const{id:o,code:t,status:r,type:n,action:d,createdAt:m,note:u,reason:g,resident:_,unit:y,depositStatus:S,requiredInfo:p,changeStatusBy:c,depositValue:v,refundValue:b}=a,x=r?(l=pe[r])==null?void 0:l.value:"";let h="",s="";return[W,se,q].includes(x)&&(h=(k=c==null?void 0:c[x])==null?void 0:k.time),x===ce&&(c!=null&&c[W])&&(h=(E=c==null?void 0:c[W])==null?void 0:E.time),x===q&&(h=(A=c==null?void 0:c[W])==null?void 0:A.time,s=(I=c==null?void 0:c[x])==null?void 0:I.time),{...a,id:o,code:t??"",status:r?pe[r]:"",type:n?nt[n]:"",action:d?ze[d]:"",registrationDate:m?G(m).format(J):"",note:u??"",vehicleFiles:(p==null?void 0:p.vehicleFiles)??[],residentFiles:(p==null?void 0:p.residentFiles)??[],vehicleType:(p==null?void 0:p.vehicleType)??"",vehicleColor:(p==null?void 0:p.vehicleColor)??"",registrationPlate:(p==null?void 0:p.registrationPlate)??"",vehicleGeneration:(p==null?void 0:p.vehicleGeneration)??"",isRegisterCharging:(p==null?void 0:p.isRegisterCharging)??!1,reason:g??"",residentName:(_==null?void 0:_.fullName)??"",unitName:(y==null?void 0:y.name)??"",relationshipWithOwner:(p==null?void 0:p.relationshipWithOwner)??"",periodOfAuthorization:(p==null?void 0:p.periodOfAuthorization)??"",depositStatus:S?Pe[S]:"",depositNameStatus:S?(M=Pe[S])==null?void 0:M.label:"",depositValueFormat:v?me(v):0,refundValueFormat:b?me(b):0,approveTime:h?G(h).format(le):"",completeAt:s?G(s).format(le):""}},Li=async({filter:a,limit:o,page:t,idBuilding:r,isUserCs:n})=>{const{unitName:d,code:m,actions:u,types:g,status:_,createdAt:y}=a,S={unitName:d||void 0,code:m||void 0,actions:u||void 0,types:g||void 0,status:_===he?void 0:_,createdFrom:y!=null&&y[0]?G(y[0]).startOf("day").toISOString():void 0,createdTo:y!=null&&y[1]?G(y[1]).endOf("day").toISOString():void 0},p=await Tt({filter:S,limit:o,page:t,idBuilding:r}),c=p.data.map(b=>ki(b)),v=(p==null?void 0:p.totalRecord)??0;return[c,v]},at=()=>{const{setTableData:a,idBuilding:o,setGetCardRegistrationStatus:t}=R.useContext(X),{isUserCs:r}=Ft();return{changeDataTable:async({filter:d,limit:m,page:u})=>{t({isFetching:!0});const[g,_]=await Li({filter:d,limit:m,page:u,idBuilding:o,isUserCs:r});a({records:g,totalRecord:_}),t({isFetching:!1})}}},Vi=()=>{const{filter:a,status:o,formFilter:t,tablePagination:r}=R.useContext(X),{setQueryParamsCardRegistration:n}=xe(),{changeDataTable:d}=at();return{onSearch:async u=>{const g=Et(u,a);g&&await d({filter:{...u,status:o},limit:r.limit,page:r.current}),g||n({limit:ie,page:K,filter:{...u},status:o})},defaultFilter:Ne,formFilter:t}},Bi=()=>{const{onSearch:a,defaultFilter:o,formFilter:t}=Vi(),r=R.useMemo(()=>[{label:i.registration_code,key:"code",component:e(re,{placeholder:i.registration_code,allowClear:!0}),visible:!0},{label:i.apartment,key:"unitName",component:e(re,{placeholder:i.apartment,allowClear:!0}),visible:!0},{label:i.registration_type,key:"actions",component:e(oe,{mode:"multiple",fluid:"true",placeholder:i.registration_type,getPopupContainer:n=>n.parentNode,children:Ve.map(n=>e(oe.Option,{value:n.value,children:n.label},n.value))}),visible:!0},{label:i.card_type,key:"types",component:e(oe,{mode:"multiple",fluid:"true",placeholder:i.card_type,getPopupContainer:n=>n.parentNode,children:Be.map(n=>e(oe.Option,{value:n.value,children:n.label},n.value))}),visible:!0},{label:i.registration_date,key:"createdAt",component:e(kt.RangePicker,{fluid:"true",placeholder:[J,J],format:[J,J],getPopupContainer:n=>n.parentNode}),visible:!0}],[]);return e(Ce.FilterBox,{defaultFilter:o,filters:r,onSearch:a,formData:t})},Ui=()=>{const{setTablePagination:a,setStatus:o,status:t,filter:r}=R.useContext(X),{setQueryParamsCardRegistration:n}=xe(),d=async u=>{u!==t&&(o(u),a({current:K,limit:ie}),n({limit:ie,page:K,status:u,filter:r}))},m=R.useMemo(()=>It,[]);return{onTabChange:d,tabs:m,activeKey:t}},zi=()=>{const{onTabChange:a,tabs:o,activeKey:t}=Ui();return e(Ce.Tabs,{activeKey:t,onTabChange:a,tabs:o})},Di=()=>{const{getCardRegistrationStatus:a,tablePagination:o,setTablePagination:t,tableData:r,showFormDetailCardRegistration:n,showFormUpdateStatus:d,cardRegistrationPermissionWrite:m,cardRegistrationPermissionApprove:u,filter:g,status:_,showFormHistoryCardRegistration:y}=R.useContext(X),{setQueryParamsCardRegistration:S}=xe(),{layoutScrollRef:p}=R.useContext(wt),c=et(),v=async(P,T)=>{let{current:O,limit:U}=o;P!==O&&(O=P),T!==U&&(U=T,O=K),t({current:O,limit:U}),S({limit:U,page:O,status:_,filter:g})},b=P=>{n(P)},x=P=>{d({cardRegistration:P,type:De})},h=P=>{d({cardRegistration:P,type:Ge})},s=P=>{d({cardRegistration:P,type:Me})},l=P=>{d({cardRegistration:P,type:We})},k=P=>{d({cardRegistration:P,type:He})},E=P=>{d({cardRegistration:P,type:Ye})},A=P=>{y({cardRegistration:P})},I={pageSize:o.limit,defaultCurrent:K,current:o.current,total:r.totalRecord,showQuickJumper:!0,showSizeChanger:!0,onChange:v},M={offsetScroll:c.offsetScrollX,getContainer:()=>p.current};return{onClickBtnDetail:b,onClickBtnApprove:x,onClickBtnInprogress:h,onClickBtnCompleted:s,onClickRefund:l,onClickDeposit:k,sticky:M,dataSource:r.records,cardRegistrationTablePagination:I,loading:a.isFetching,cardRegistrationPermissionWrite:m,cardRegistrationPermissionApprove:u,onClickBtnCancel:E,status:_,onClickBtnHistory:A}},Se=tt("div",{target:"eg48m8c0"})({name:"l8l8b8",styles:"white-space:nowrap;overflow:hidden;text-overflow:ellipsis"}),Gi=()=>{const{onClickBtnDetail:a,onClickBtnApprove:o,onClickBtnInprogress:t,onClickBtnCompleted:r,onClickRefund:n,onClickDeposit:d,onClickBtnCancel:m,sticky:u,dataSource:g,cardRegistrationTablePagination:_,loading:y,status:S,cardRegistrationPermissionWrite:p,cardRegistrationPermissionApprove:c,onClickBtnHistory:v}=Di(),b=[{title:i.registration_code,key:"code",dataIndex:"code",fixed:"left",width:120},{title:i.vehicle_card_type,key:"type",dataIndex:"type",width:100,render:(h,s)=>{var l;return((l=s==null?void 0:s.type)==null?void 0:l.label)??null}},{title:i.register_type,key:"action",dataIndex:"action",width:180,render:(h,s)=>{var l,k,E;return(l=s==null?void 0:s.action)!=null&&l.label?e(Ke,{color:(k=s==null?void 0:s.action)==null?void 0:k.color,children:(E=s==null?void 0:s.action)==null?void 0:E.label}):null}},{title:i.registration_date,key:"registrationDate",dataIndex:"registrationDate",width:120},{title:i.deposit_status,key:"depositStatus",dataIndex:"depositStatus",width:120,render:(h,s)=>{var l,k,E;return(l=s==null?void 0:s.depositStatus)!=null&&l.label?e(Ke,{color:(k=s==null?void 0:s.depositStatus)==null?void 0:k.color,children:(E=s==null?void 0:s.depositStatus)==null?void 0:E.label}):null}},{title:i.deposit_value,key:"depositValueFormat",dataIndex:"depositValueFormat",width:120},{title:i.refund_value,key:"refundValueFormat",dataIndex:"refundValueFormat",width:120},{title:i.apartment,key:"unitName",dataIndex:"unitName",width:120,render:(h,s)=>{const l=h;return(l==null?void 0:l.length)>10?e(be,{title:l,placement:"topLeft",children:e(Se,{children:l})}):e(Se,{children:l})}},{title:i.resident,key:"residentName",dataIndex:"residentName",width:120,render:(h,s)=>{const l=h;return(l==null?void 0:l.length)>10?e(be,{title:l,placement:"topLeft",children:e(Se,{children:l})}):e(Se,{children:l})}},{title:i.role,key:"relationshipWithOwner",dataIndex:"relationshipWithOwner",width:120,render:(h,s)=>{const l=h;return(l==null?void 0:l.length)>10?e(be,{title:l,placement:"topLeft",children:e(Se,{children:l})}):e(Se,{children:l})}},[W,se,q,ce,he].includes(S)?{title:i.start_time,key:"approveTime",dataIndex:"approveTime",width:150}:null,[q,he].includes(S)?{title:i.complete_at,key:"completeAt",dataIndex:"completeAt",width:150}:null,[ce,he].includes(S)?{title:i.cancel_reason,key:"reason",dataIndex:"reason",width:120,render:(h,s)=>{const l=h;return(l==null?void 0:l.length)>10?e(be,{title:l,placement:"topLeft",children:e(Se,{children:l})}):e(Se,{children:l})}}:null,{title:i.action,key:"action",dataIndex:"action",width:150,align:"center",fixed:"right",render:(h,s)=>{var l,k,E,A,I,M,P;return f(we,{children:[e(Q,{title:i.history,css:T=>({fontSize:T.iconSize,marginRight:T.margin.xs}),name:"icon-history-filled",onClick:()=>v(s)}),e(Q,{title:i.detail_cardRegistration,onClick:()=>a(s),name:"icon-eye-outlined",css:T=>({fontSize:T.iconSize})}),((l=s==null?void 0:s.status)==null?void 0:l.value)===de&&c?e(Q,{title:i.confirm_in_approve_cardRegistration,css:T=>({marginLeft:T.margin.xs,fontSize:T.iconSize}),onClick:()=>o(s),name:"icon-check-outlined"}):null,((k=s==null?void 0:s.status)==null?void 0:k.value)===W&&p?e(Q,{title:i.confirm_in_progress_cardRegistration,css:T=>({marginLeft:T.margin.xs,fontSize:T.iconSize}),onClick:()=>t(s),name:"icon-exit-to-app-outlined"}):null,((E=s==null?void 0:s.depositStatus)==null?void 0:E.value)===dt&&p?e(Q,{title:i.refund_cardRegistration,onClick:()=>n(s),name:"icon-attach-money-filled",css:T=>({marginLeft:T.margin.xs,fontSize:T.iconSize})}):null,[se,q,W].includes((A=s==null?void 0:s.status)==null?void 0:A.value)&&((I=s==null?void 0:s.depositStatus)==null?void 0:I.value)===Ot&&p?e(Q,{title:i.collect_deposit,onClick:()=>d(s),name:"icon-attach-money-filled",css:T=>({marginLeft:T.margin.xs,fontSize:T.iconSize})}):null,((M=s==null?void 0:s.status)==null?void 0:M.value)===se&&p?e(Q,{title:i.confirm_complete_cardRegistration,css:T=>({marginLeft:T.margin.xs,fontSize:T.iconSize}),onClick:()=>r(s),name:"icon-export-outlined"}):null,[W,de].includes((P=s==null?void 0:s.status)==null?void 0:P.value)&&c?e(Q,{title:i.cancel_vehicle_card_registration,css:T=>({marginLeft:T.margin.xs,fontSize:T.iconSize}),onClick:()=>m(s),name:"icon-close-circle-outlined"}):null]})}}].filter(Boolean),x={x:b.reduce((h,s)=>s+h.width,0),scrollToFirstRowOnChange:!0};return e(Ce.Table,{sticky:u,scroll:x,columns:b,dataSource:g,loading:y,pagination:_})},Mi=async(a,o)=>{try{return await Mt(a,o)}catch(t){return t}},Hi=()=>{var s,l,k,E,A,I,M,P;const{idBuilding:a,formDetailCardRegistration:o,hideFormDetailCardRegistration:t}=R.useContext(X),{isUserCs:r}=Ft(),[n]=w.useForm(),[d,m]=R.useState({}),u=(s=o==null?void 0:o.data)==null?void 0:s.id;R.useEffect(()=>{(async()=>{const T=await Mi(u,a);m(T.data)})()},[]);const g=(l=d==null?void 0:d.requiredInfo)==null?void 0:l.vehicleFiles,_=(k=d==null?void 0:d.requiredInfo)==null?void 0:k.residentFiles,y=T=>T==null?void 0:T.map(O=>{var H;return{url:O,fileName:O.substring(O.lastIndexOf("/")+1),fileType:O.split(".").pop().toLowerCase(),icon:((H=di)==null?void 0:H[O.split(".").pop().toLowerCase()])??O}}),S=y(g),p=y(_),{status:c,changeStatusBy:v}=d,b=c?(E=pe[c])==null?void 0:E.value:"";let x="",h="";return[W,se,q].includes(b)&&(x=(A=v==null?void 0:v[b])==null?void 0:A.time),b===ce&&(v!=null&&v[W])&&(x=(I=v==null?void 0:v[W])==null?void 0:I.time),b===q&&(x=(M=v==null?void 0:v[W])==null?void 0:M.time,h=(P=v==null?void 0:v[b])==null?void 0:P.time),{hideFormDetailCardRegistration:t,formDetail:n,cardRegistrationDetail:d,attachFilesResident:p,attachFilesEmployee:S,isUserCs:r,approveTime:x,completeAt:h}},Wi=()=>{var _,y,S,p,c,v,b,x,h,s,l,k,E,A,I,M,P,T,O,U,H,Z,ee,ue,ge,fe,_e,N,L,Y,B,z;const{hideFormDetailCardRegistration:a,formDetail:o,cardRegistrationDetail:t,attachFilesResident:r,attachFilesEmployee:n,isUserCs:d,approveTime:m,completeAt:u}=Hi(),g=et();return e(ke,{open:!0,title:i.detail_card_registration,onCancel:a,footer:null,width:"65%",style:{zIndex:"0"},children:f(w,{form:o,layout:"vertical",name:"detail",style:{height:"530px",overflowY:"scroll"},children:[f(j,{style:{background:"#f7f7f7",padding:"10px 10px 0 10px"},children:[e(F,{span:"8",css:te({marginBottom:g.margin.sm},"",""),children:f(V.Text,{strong:i.status_card_registration,children:[i.status_card_registration,": "]})}),e(F,{span:"8",children:f(V.Text,{strong:((_=pe[(t==null?void 0:t.status)??""])==null?void 0:_.label)??"-",css:te({fontSize:g.fontSize.md},"",""),children:[[se,W,de].includes(t==null?void 0:t.status)?f("span",{style:{color:`${(y=pe[(t==null?void 0:t.status)??""])==null?void 0:y.color}`},children:[((S=pe[(t==null?void 0:t.status)??""])==null?void 0:S.label)??"-"," "]}):"",(t==null?void 0:t.status)===q&&f("span",{style:{color:`${(p=pe[(t==null?void 0:t.status)??""])==null?void 0:p.color}`},children:[((c=pe[(t==null?void 0:t.status)??""])==null?void 0:c.label)??"-"," "]}),(t==null?void 0:t.status)===ce?f("span",{style:{color:`${(v=pe[(t==null?void 0:t.status)??""])==null?void 0:v.color}`},children:[((b=pe[(t==null?void 0:t.status)??""])==null?void 0:b.label)??"-"," "]}):""]})})]}),f(j,{style:{background:"#f7f7f7",padding:"0 10px 10px 10px"},children:[e(F,{span:"8",children:f(V.Text,{children:[i.registration_code,": "]})}),e(F,{span:"8",children:e(V.Text,{children:(t==null?void 0:t.code)??"-"})})]}),f(j,{style:{background:"#f7f7f7",padding:"0 10px 10px 10px"},children:[e(F,{span:"8",children:f(V.Text,{children:[i.vehicle_card_type,": "]})}),e(F,{span:"8",children:e(V.Text,{children:(x=nt[(t==null?void 0:t.type)??""])==null?void 0:x.label})})]}),f(j,{style:{background:"#f7f7f7",padding:"0 10px 10px 10px",marginBottom:"20px"},children:[e(F,{span:"8",children:f(V.Text,{children:[i.register_type,": "]})}),e(F,{span:"8",children:e(V.Text,{children:(h=ze[(t==null?void 0:t.action)??""])==null?void 0:h.label})})]}),f(j,{style:{background:"#f7f7f7",padding:"10px 0 0 10px",marginBottom:"20px"},children:[e(F,{span:"24",css:te({marginBottom:g.margin.sm},"",""),children:e(V.Text,{strong:i.creator_info,children:i.creator_info})}),e(F,{span:"8",children:e(w.Item,{label:i.apartment,children:((s=t==null?void 0:t.unit)==null?void 0:s.name)??"-"})}),e(F,{span:"8",children:e(w.Item,{label:i.subscribers,children:d?"***":((l=t==null?void 0:t.resident)==null?void 0:l.fullName)??"-"})}),e(F,{span:"8",children:e(w.Item,{label:i.registration_date,children:t!=null&&t.createdAt?G(t==null?void 0:t.createdAt).format(J):"-"})}),e(F,{span:"8",children:e(w.Item,{label:i.relationship_with_the_head_of_household,children:((k=t==null?void 0:t.requiredInfo)==null?void 0:k.relationshipWithOwner)??"-"})}),t!=null&&t.approvedAt?e(F,{span:"8",children:e(w.Item,{label:i.approved_at,children:t==null?void 0:t.approvedAt})}):null]}),f(j,{style:{background:"#f7f7f7",padding:"10px 0 0 10px"},children:[e(F,{span:"24",children:f(V.Text,{strong:i.card_registration_info,children:[i.card_registration_info," "]})}),(t==null?void 0:t.type)===Ue?f(we,{children:[e(F,{span:"8",children:e(w.Item,{label:i.license_plates,children:((E=t==null?void 0:t.requiredInfo)==null?void 0:E.registrationPlate)??"-"})}),e(F,{span:"8",children:e(w.Item,{label:i.color,children:((A=t==null?void 0:t.requiredInfo)==null?void 0:A.vehicleColor)??"-"})}),e(F,{span:"8",children:e(w.Item,{label:i.vehicle_generation,children:((I=t==null?void 0:t.requiredInfo)==null?void 0:I.vehicleGeneration)??"-"})}),e(F,{span:"8",children:e(w.Item,{label:i.label.parking_type,children:((M=t==null?void 0:t.requiredInfo)==null?void 0:M.vehicleType)??"-"})}),e(F,{span:"8",children:e(w.Item,{label:i.register_for_a_charging_card,children:e(si,{checked:(P=t==null?void 0:t.requiredInfo)==null?void 0:P.isRegisterCharging,disabled:!0})})}),e(F,{span:"24",children:f(V.Text,{strong:i.file_info,children:[i.file_info," "]})}),((O=(T=t==null?void 0:t.requiredInfo)==null?void 0:T.vehicleFiles)==null?void 0:O.length)>0?e(F,{span:"24",children:e(j,{style:{width:"100%"},gutter:[g.margin.md,g.margin.md],children:n==null?void 0:n.map(D=>e(F,{style:{width:"10%"},children:e(be,{title:D.fileName,children:f("figure",{className:"upload__item",style:{margin:"15px 0px"},children:[e(ft,{title:D.fileName,src:D.icon,width:"100%",height:"80px",preview:!1,alt:D.fileName,style:{cursor:"pointer",objectFit:"cover"}}),e("div",{className:"upload__item__action",style:{zIndex:1e6,width:"100%"},children:e(Q,{name:"icon-eye-outlined",style:{fontSize:"20px"},onClick:()=>{Xe.open({url:D.url})}})})]})})}))})}):null]}):null,(t==null?void 0:t.type)===ct?f(we,{children:[e(F,{span:"8",children:e(w.Item,{label:i.lease_or_authorization_term,children:(U=t==null?void 0:t.requiredInfo)!=null&&U.periodOfAuthorization?(H=t==null?void 0:t.requiredInfo)==null?void 0:H.periodOfAuthorization:"-"})}),((ee=(Z=t==null?void 0:t.requiredInfo)==null?void 0:Z.residentFiles)==null?void 0:ee.length)>0?e(we,{children:f(j,{style:{background:"#f7f7f7",width:"100%"},children:[e(F,{span:"24",children:f(V.Text,{strong:i.file_info,children:[i.file_info," "]})}),e(F,{span:"24",children:e(j,{style:{width:"100%"},gutter:[g.margin.md,g.margin.md],children:r==null?void 0:r.map(D=>e(F,{style:{width:"10%"},children:e(be,{title:D.fileName,children:f("figure",{className:"upload__item",style:{margin:"15px 0px"},children:[e(ft,{title:D.fileName,src:D.icon,width:"100%",height:"80px",preview:!1,alt:D.fileName,style:{cursor:"pointer",objectFit:"cover"}}),e("div",{className:"upload__item__action",style:{zIndex:1e6,width:"100%"},children:e(Q,{name:"icon-eye-outlined",style:{fontSize:"20px"},onClick:()=>{Xe.open({url:D.url})}})})]})})}))})})]})}):null]}):null]}),f(j,{style:{background:"#f7f7f7",padding:"10px 0 0 10px",marginBottom:"20px"},children:[e(F,{span:"24",css:te({marginBottom:g.margin.sm},"",""),children:f(V.Text,{strong:i.deposit_info,children:[i.deposit_info," "]})}),e(F,{span:"8",children:e(w.Item,{label:i.deposit_status,children:(ue=Pe[(t==null?void 0:t.depositStatus)??""])!=null&&ue.label?e(Ke,{color:(ge=Pe[(t==null?void 0:t.depositStatus)??""])==null?void 0:ge.color,children:(fe=Pe[(t==null?void 0:t.depositStatus)??""])==null?void 0:fe.label}):"-"})}),e(F,{span:"8",children:f(w.Item,{label:i.deposit_value,children:[t!=null&&t.depositValue?me(t==null?void 0:t.depositValue):0," "," ",i.vnd]})}),e(F,{span:"8",children:f(w.Item,{label:i.refund_value,children:[t!=null&&t.refundValue?me(t==null?void 0:t.refundValue):0," "," ",i.vnd]})})]}),e(j,{style:{background:"#f7f7f7",padding:"10px 0 0 10px"},children:f(j,{style:{width:"100%"},children:[e(F,{span:"24",css:te({marginBottom:g.margin.sm},"",""),children:f(V.Text,{strong:i.confirm_employee,children:[i.confirm_employee,": "]})}),e(F,{span:"24",children:e(w.Item,{label:i.management_note,children:(t==null?void 0:t.employeeNote)??"-"})}),[W,se,q,ce].includes(t==null?void 0:t.status)?e(F,{span:"8",children:e(w.Item,{label:i.start_time,children:m?G(m).format(le):"-"})}):null,(t==null?void 0:t.status)===q?e(F,{span:"8",children:e(w.Item,{label:i.complete_at,children:u?G(u).format(le):"-"})}):null,(t==null?void 0:t.status)===ce?f(we,{children:[e(F,{span:"24",css:te({marginBottom:g.margin.sm},"",""),children:e(V,{children:e("b",{children:i.content_cancel})})}),e(F,{span:"8",children:e(w.Item,{label:i.canceler,children:(N=(_e=t==null?void 0:t.changeStatusBy)==null?void 0:_e.CANCELLED)==null?void 0:N.name})}),e(F,{span:"8",children:e(w.Item,{label:i.cancel_at,children:(Y=(L=t==null?void 0:t.changeStatusBy)==null?void 0:L.CANCELLED)!=null&&Y.time?G((z=(B=t==null?void 0:t.changeStatusBy)==null?void 0:B.CANCELLED)==null?void 0:z.time).format(J):"-"})}),e(F,{span:"24",children:e(w.Item,{label:i.reason,children:(t==null?void 0:t.reason)??"-"})})]}):null]})})]})})};var Yi={name:"99halj",styles:"color:#2424f3"};const $i=tt("span",{target:"e1pkvhpq0"})("cursor:pointer;width:85%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;",a=>a.isUploaded&&Yi,";"),ht=({file:a,handlePreviewAttachment:o})=>e($i,{title:a.name,onClick:()=>o(a),children:a.name});ht.propTypes={file:ae.arrayOf(ae.object),handlePreviewAttachment:ae.arrayOf(ae.func)};ht.defaultProps={file:{},handlePreviewAttachment:()=>{}};const ji=tt("div",{target:"e1425ecl0"})({name:"seoft9",styles:"display:flex;justify-content:space-between;margin:10px;&:hover{background:#f7f7f7;}"}),Ze=({file:a,handlePreviewAttachment:o,handleRemoveFile:t})=>{const r=et();return f(ji,{children:[f(j,{style:{flexFlow:"row"},children:[e(Q,{name:"icon-attachment-outlined",css:te({fontsize:r.iconSize,marginRight:r.margin.xs},"","")}),e(ht,{file:a,handlePreviewAttachment:o})]}),e(Q,{name:"icon-delete-outlined",css:te({fontsize:r.iconSize,marginLeft:r.margin.xs},"",""),onClick:()=>{t(a==null?void 0:a.uid)}})]},a)};Ze.propTypes={file:ae.arrayOf(ae.object),handlePreviewAttachment:ae.arrayOf(ae.func),handleRemoveFile:ae.arrayOf(ae.func)};Ze.defaultProps={file:{},handlePreviewAttachment:()=>{},handleRemoveFile:()=>{}};const Qi=async({dataCreate:a,idBuilding:o})=>{try{const{vehicleFiles:t,type:r,action:n,vehicleType:d,vehicleColor:m,registrationPlate:u,vehicleGeneration:g,isRegisterCharging:_,relationshipWithOwner:y,residentFiles:S,periodOfAuthorization:p,unitId:c,residentId:v,depositValue:b}=a;let x={},h=[];return r===Ue&&(x={unitId:c||null,residentId:v||null,type:r||null,action:n||null,isRegisterCharging:_||!1,vehicleColor:m||null,vehicleType:d||null,vehicleGeneration:g||null,registrationPlate:u||null,vehicleFiles:t||"",depositValue:b||null,relationshipWithOwner:y||null},h=await Ht(x,o)),r===ct&&(x={unitId:c||null,residentId:v||null,type:r||null,action:n||null,relationshipWithOwner:y||null,periodOfAuthorization:p||"",residentFiles:S||"",depositValue:b||null},h=await Wt(x,o)),h}catch(t){return t}},St=async({filter:a,limit:o,page:t,idBuilding:r})=>{try{return await Yt({filter:a,limit:o,page:t,idBuilding:r})}catch(n){return n}},qi=()=>{const[a]=w.useForm(),{getCardRegistrationBadges:o}=st(),{changeDataTable:t}=at(),{idBuilding:r,filter:n,status:d,hideFormAddCardRegistration:m,tablePagination:u,formConfirmExit:g,setFormConfirmExit:_}=R.useContext(X),{setQueryParamsCardRegistration:y}=xe(),[S,p]=R.useState({code:void 0,codeLanguage:void 0,isFetching:!1}),[c,v]=R.useState({data:[],isFetching:!1}),[b,x]=R.useState({data:[],isFetching:!1}),[h,s]=R.useState([]),[l,k]=R.useState([]),[E,A]=R.useState({isShowInfoByVehicleCardType:!1,isShowInfoByResidentCardType:!1}),I=(N,L,Y)=>{var z;let B=L;N.status==="error"?xt.error({message:i.error1,description:(z=N==null?void 0:N.response)==null?void 0:z.message}):N.status||(B=L.filter(D=>D.uid!==N.uid)),Y(B.filter(D=>["done","uploading"].includes(D.status)))},M=({file:N,fileList:L})=>{I(N,L,s)},P=({file:N,fileList:L})=>{I(N,L,k)};lt(S.code,S.codeLanguage,{message:i.success,description:i.add_data_success});const T=(N,L)=>{_(!0);const{unitId:Y}=N,{type:B}=L;if(A(()=>({isShowInfoByVehicleCardType:B&&B===Ue,isShowInfoByResidentCardType:B&&B!==Ue})),Y){x({...b,isFetching:!0});const z=c.data.find(D=>D.id===Y);x({data:(z==null?void 0:z.residents)??[],isFetching:!1}),a.setFieldsValue({residentId:void 0})}},{isShowInfoByVehicleCardType:O,isShowInfoByResidentCardType:U}=E,H=N=>{var L,Y;Xe.open({url:(Y=(L=N==null?void 0:N.response)==null?void 0:L.data)==null?void 0:Y.url})},Z=N=>{if(h){const L=h.filter(Y=>Y.uid!==N);s(L)}if(l){const L=l.filter(Y=>Y.uid!==N);k(L)}};R.useEffect(()=>{(async()=>{v({data:[],isFetching:!0});const N=await St({idBuilding:r,limit:ie,page:K,filter:{name:void 0}});v({data:N.data,isFetching:!1})})()},[]);const ee=async N=>{v({...c,isFetching:!0});const L=await St({idBuilding:r,limit:ie,page:K,filter:{name:N||void 0}});v({data:L.data,isFetching:!1})},ue=(N,L)=>{var Y;return L!=null&&L.length?L.map(B=>{var z,D;return((D=(z=B==null?void 0:B.response)==null?void 0:z.data)==null?void 0:D.url)??(B==null?void 0:B.url)}):((Y=N==null?void 0:N.map(B=>(B==null?void 0:B.url)??null))==null?void 0:Y.filter(Boolean))??[]},ge=async()=>{const N=await a.validateFields(),L=a.getFieldsValue();if(N){const Y=a.getFieldValue("vehicleFiles"),B=a.getFieldValue("residentFiles"),z=ue(Y,h),D=ue(B,l);p({code:void 0,codeLanguage:void 0,isFetching:!0});const ye=await Qi({dataCreate:{...L,vehicleFiles:z,residentFiles:D},idBuilding:r});if(p({code:ye.code,codeLanguage:ye.codeLanguage,isFetching:!1}),bt.includes(ye.code)){const Re={limit:u.limit,page:u.current,filter:{...n},status:d},Te={limit:ie,page:K,filter:{...Ne},status:W},Le=Et(Te,Re);Le&&await t({limit:ie,page:K,filter:{...Ne,status:W}}),Le||y({...Te}),await o(r),m()}}},fe=()=>{g?ke.confirm({cancelText:i.cancel,okText:i.confirm,title:i.confirm,content:i.the_content_you_enter_has_not_been_saved_are_you_sure_you_want_to_exit_this_screen,onOk:()=>{_(!1),m()}}):m()},_e={type:void 0,action:void 0,vehicleFiles:void 0,residentFiles:void 0,unitId:void 0,residentId:void 0,vehicleType:void 0,vehicleColor:void 0,registrationPlate:void 0,vehicleGeneration:void 0,relationshipWithOwner:void 0,periodOfAuthorization:void 0,isRegisterCharging:!1,depositValue:void 0};return{onCancelCreateCardRegistration:fe,handleAddCardRegistration:ge,formAddCardRegistration:a,isFetchingAdd:S.isFetching,initialValues:_e,onValuesChange:T,handlePreviewAttachment:H,attachFileList:h,attachFileListResident:l,handleChange:M,handleRemoveFile:Z,isFetchingApartment:c.isFetching,apartmentData:c.data,handleSearchApartment:ee,isShowInfoByVehicleCardType:O,isShowInfoByResidentCardType:U,residentData:b.data,isFetchingResident:b.isFetching,handleChangeFileResident:P}};var Ji={name:"1kevbid",styles:"& .ant-upload{width:100%;}"},Ki={name:"1kevbid",styles:"& .ant-upload{width:100%;}"};const Xi=()=>{const{onCancelCreateCardRegistration:a,handleAddCardRegistration:o,formAddCardRegistration:t,isFetchingAdd:r,initialValues:n,onValuesChange:d,handlePreviewAttachment:m,attachFileList:u,attachFileListResident:g,handleChange:_,handleRemoveFile:y,isFetchingApartment:S,apartmentData:p,handleSearchApartment:c,isShowInfoByVehicleCardType:v,isShowInfoByResidentCardType:b,residentData:x,isFetchingResident:h,handleChangeFileResident:s}=qi(),l=et(),k=f(j,{style:{justifyContent:"space-between",alignItems:"center"},children:[e(V.Text,{children:i.create_vehicle_card_registration}),f(j,{children:[e(ve,{onClick:a,style:{marginRight:10},children:i.cancel}),e(ve,{type:"primary",onClick:o,disabled:r,loading:r,children:i.add})]})]}),E=e(F,{span:"24",style:{textAlign:"left"},children:e(Rt,{message:i.after_create_vehicle_card_registration_will_show_in_tab_verified,type:"warning",showIcon:!0,closable:!0})});return e(ke,{title:k,onCancel:a,open:!0,width:"55%",bodyStyle:{maxHeight:"450px",overflowY:"scroll"},footer:E,closable:!1,closeIcon:null,children:f(w,{initialValues:n,form:t,name:"formAddCardRegistration",layout:"vertical",onValuesChange:d,children:[f(j,{gutter:[12,12],children:[e(F,{span:"12",children:e(w.Item,{rules:[{required:!0}],label:i.apartment,name:"unitId",children:e(oe,{allowClear:!0,showSearch:!0,placeholder:i.label.select_apartment,filterOption:!1,loading:S,onSearch:Lt(c),getPopupContainer:A=>A.parentNode,style:{width:"100%"},dropdownRender:A=>S?e("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},children:e(li,{})}):A,children:p==null?void 0:p.map(({id:A,name:I})=>e(oe.Option,{value:A,children:I},A))})})}),e(F,{span:"12",children:e(w.Item,{rules:[{required:!0}],label:i.resident,name:"residentId",children:e(oe,{allowClear:!0,showSearch:!0,placeholder:i.label.select_resident,filterOption:!1,loading:h,getPopupContainer:A=>A.parentNode,style:{width:"100%"},children:x==null?void 0:x.map(({id:A,fullName:I})=>e(oe.Option,{value:A,children:I},A))})})}),e(F,{span:"12",children:e(w.Item,{rules:[{required:!0}],label:i.vehicle_card_type,name:"type",children:e(oe,{fluid:"true",allowClear:!0,showSearch:!0,placeholder:i.vehicle_card_type,filterOption:!0,getPopupContainer:A=>A.parentNode,children:Be==null?void 0:Be.map(({label:A,value:I})=>e(oe.Option,{value:I,children:A},I))})})}),e(F,{span:"12",children:e(w.Item,{rules:[{required:!0}],label:i.registration_type,name:"action",children:e(oe,{fluid:"true",allowClear:!0,showSearch:!0,placeholder:i.registration_type,filterOption:!0,getPopupContainer:A=>A.parentNode,children:Ve==null?void 0:Ve.map(({label:A,value:I})=>e(oe.Option,{value:I,children:A},I))})})}),e(F,{span:"12",children:e(w.Item,{label:`${i.deposit_value} (${i.vnd})`,name:"depositValue",children:e(qe,{placeholder:i.deposit_value,formatter:A=>me(A),fluid:"true",min:0})})}),e(F,{span:"12",children:e(w.Item,{name:"relationshipWithOwner",label:i.relationship_with_the_head_of_household,rules:[{required:!0}],children:e(re,{placeholder:i.relationship_with_the_head_of_household,fluid:"true"})})})]}),v?f(j,{gutter:[12,12],children:[e(F,{span:"12",children:e(w.Item,{rules:[{required:!0}],label:i.label.parking_type,name:"vehicleType",children:e(re,{placeholder:i.label.parking_type,fluid:"true"})})}),e(F,{span:"12",children:e(w.Item,{rules:[{required:!0}],label:i.color,name:"vehicleColor",children:e(re,{placeholder:i.color,fluid:"true"})})}),e(F,{span:"12",children:e(w.Item,{rules:[{required:!0}],label:i.license_plates,name:"registrationPlate",children:e(re,{placeholder:i.license_plates,fluid:"true"})})}),e(F,{span:"12",children:e(w.Item,{rules:[{required:!0}],label:i.vehicle_generation,name:"vehicleGeneration",children:e(re,{placeholder:i.vehicle_generation,fluid:"true"})})}),e(F,{span:"24",children:e(w.Item,{name:"isRegisterCharging",valuePropName:"checked",children:e(At,{children:e(V.Text,{strong:i.register_for_a_charging_card,style:{color:l.color.primary,margin:"0 5px"},children:i.register_for_a_charging_card})})})}),f(F,{span:"24",children:[e(w.Item,{name:"vehicleFiles",label:i.file_info,rules:[{required:!0}],children:e(gt,{multiple:!0,css:Ki,limitSizeFile:_t,onPreview:m,isCheckLimitSizeFile:!1,isUploadAllFile:!0,fileList:u,onChange:_,showUploadList:!1,children:e(ve,{icon:e(Q,{name:"icon-attachment-outlined",css:te({fontsize:l.iconSize},"","")}),type:"primary",ghost:!0,block:!0,size:"default",children:i.attachments})})}),u==null?void 0:u.map(A=>e(Ze,{file:A,handlePreviewAttachment:m,handleRemoveFile:y})),f("i",{css:te({fontSize:l.fontSize.sm,color:l.labelColor},"",""),children:["* ",i.file_format]}),e("div",{children:f("i",{css:te({fontSize:l.fontSize.sm,color:l.labelColor},"",""),children:["* ",i.upload_file_info_note]})})]})]}):null,b?f(we,{children:[e(j,{gutter:16,children:e(F,{span:"24",children:e(w.Item,{label:i.lease_or_authorization_term,name:"periodOfAuthorization",children:e(re,{placeholder:i.lease_or_authorization_term,fluid:"true"})})})}),e(j,{gutter:[12,12],children:f(F,{span:"24",children:[e(w.Item,{name:"residentFiles",label:i.file_info,rules:[{required:!0}],children:e(gt,{multiple:!0,css:Ji,limitSizeFile:_t,onPreview:m,isCheckLimitSizeFile:!1,isUploadAllFile:!0,fileList:g,onChange:s,showUploadList:!1,children:e(ve,{icon:e(Q,{name:"icon-attachment-outlined",css:te({fontsize:l.iconSize},"","")}),type:"primary",ghost:!0,block:!0,size:"default",children:i.attachments})})}),g==null?void 0:g.map(A=>e(Ze,{file:A,handlePreviewAttachment:m,handleRemoveFile:y})),f("i",{css:te({fontSize:l.fontSize.sm,color:l.labelColor},"",""),children:["* ",i.file_format]}),e("div",{children:f("i",{css:te({fontSize:l.fontSize.sm,color:l.labelColor},"",""),children:["* ",i.file_info_resident]})})]})})]}):null]})})},Ie=async({id:a,body:o={},type:t,idBuilding:r})=>{try{let n=null;switch(t){case De:n=await Xt(a,o,r);break;case Ci:n=await Kt(a,o,r);break;case Ge:n=await Jt(a,o,r);break;case Me:n=await qt(a,o,r);break;case Ye:n=await Qt(a,o,r);break;case He:n=await jt(a,o,r);break;case We:n=await $t(a,o,r);break;default:break}return n}catch(n){return n}},Zi=()=>{var I,M,P;const{tableData:a,formUpdateStatusCardRegistration:o,hideFormUpdateStatus:t,filter:r,status:n,tablePagination:d,idBuilding:m}=R.useContext(X),{setQueryParamsCardRegistration:u}=xe(),{getCardRegistrationBadges:g}=st(),[_,y]=R.useState({code:void 0,codeLanguage:void 0,isFetching:!1}),[S]=w.useForm(),{changeDataTable:p}=at(),c={id:(M=(I=o==null?void 0:o.data)==null?void 0:I.cardRegistration)==null?void 0:M.id,idBuilding:m};lt(_.code,_.codeLanguage,{message:i.success,description:i.update_data_success});const v=T=>{var O,U;Xe.open({url:(U=(O=T==null?void 0:T.response)==null?void 0:O.data)==null?void 0:U.url})},b=async()=>{if(await S.validateFields())return c.type=De,c.body={depositValue:S.getFieldValue("depositValue")??0,employeeNote:S.getFieldValue("employeeNote")??null},await Ie(c)},x=async()=>{if(await S.validateFields())return c.type=He,c.body={depositCollection:S.getFieldValue("depositCollection")},await Ie(c)},h=async()=>(c.type=We,c.body={refundValue:S.getFieldValue("refundValue")},await Ie(c)),s=async()=>{var U;const T=S.getFieldValue("vehicleFiles")??[],O=((U=T.map(H=>{var Z,ee;return((ee=(Z=H==null?void 0:H.response)==null?void 0:Z.data)==null?void 0:ee.url)??void 0}))==null?void 0:U.filter(Boolean))??[];if(T.length===0||O.length>0&&O.length===T.length)return c.type=Ge,c.body={employeeNote:S.getFieldValue("employeeNote")??null},await Ie(c)},l=async()=>{var U;const T=S.getFieldValue("vehicleFiles")??[],O=((U=T.map(H=>{var Z,ee;return((ee=(Z=H==null?void 0:H.response)==null?void 0:Z.data)==null?void 0:ee.url)??void 0}))==null?void 0:U.filter(Boolean))??[];if(T.length===0||O.length>0&&O.length===T.length)return c.type=Me,c.body={employeeNote:S.getFieldValue("employeeNote")??null},await Ie(c)},k=async()=>{if(await S.validateFields())return c.type=Ye,c.body={reason:S.getFieldValue("reason")},await Ie(c)},E={[De]:b,[He]:x,[We]:h,[Ge]:s,[Me]:l,[Ye]:k};return{handleConfirmUpdate:async()=>{if(await S.validateFields()){y({code:void 0,codeLanguage:void 0,isFetching:!0});const O=await E[o.data.type]();if(y({code:O.code,codeLanguage:O.codeLanguage,isFetching:!1}),bt.includes(O.code)){const U=ui(a.totalRecord-1,d.limit,d.current),H=d.current===U;H&&await p({limit:d.limit,page:d.current,filter:{...r,status:n}}),H||u({limit:d.limit,page:U,status:n,filter:{...r}}),await g(m),t()}}},formUpdate:S,isFetching:_.isFetching,type:o.data.type,cardRegistration:(P=o==null?void 0:o.data)==null?void 0:P.cardRegistration,handlePreviewAttachment:v}},en=()=>{var u,g;const{handleConfirmUpdate:a,formUpdate:o,isFetching:t,type:r,cardRegistration:n}=Zi(),{hideFormUpdateStatus:d}=R.useContext(X),m=_=>{/[0-9]/.test(_.key)||_.preventDefault()};return f(ke,{title:i.confirm,open:!0,loading:t,okText:i.confirm,cancelText:i.cancel,onOk:a,onCancel:d,okButtonProps:{disabled:t,loading:t},children:[r===De&&f(w,{initialValues:{depositValue:void 0},form:o,name:"formUpdate",layout:"vertical",children:[e("div",{style:{marginBottom:12},children:f(V,{children:[i.do_you_want_to_approve_this_registration_form,"?"]})}),e(w.Item,{name:"depositValue",label:`${i.deposit_type} (${i.vnd})`,children:e(qe,{placeholder:`${i.deposit_value} ${i.vnd}`,min:0,onKeyPress:m,formatter:_=>me(_)})}),e(w.Item,{name:"employeeNote",label:i.note,children:e(re.TextArea,{maxLength:"255",placeholder:i.note,rows:"4"})})]}),r===Ge&&e(w,{form:o,name:"formUpdate",layout:"vertical",children:f("div",{style:{marginBottom:12},children:[f(V,{css:_=>({marginBottom:_.margin.sm}),children:[i.in_progress,"?"]}),e(w.Item,{name:"employeeNote",label:i.note,children:e(re.TextArea,{maxLength:"255",placeholder:i.note,rows:"4"})})]})}),r===Me&&e(w,{form:o,name:"formUpdate",layout:"vertical",children:f("div",{style:{marginBottom:12},children:[((u=n==null?void 0:n.depositStatus)==null?void 0:u.value)===dt&&((g=n==null?void 0:n.status)==null?void 0:g.value)===se?f("div",{children:[e(V.Text,{children:i.the_vehicle_card_registration_has_an_outstanding_deposit_do_you_want_to_terminate_the_contract_without_refunding_the_deposit}),f(V.Text,{strong:!0,children:[" ",i.finish_vehicle_card_registration.toLowerCase()," "]}),e(V.Text,{children:i.but.toLowerCase()}),f(V.Text,{strong:!0,children:[" ",i.not_refund.toLowerCase(),"? "]})]}):f(V.Text,{children:[i.completed,"?"]}),e(w.Item,{name:"employeeNote",label:i.note,style:{marginTop:10},children:e(re.TextArea,{maxLength:"255",placeholder:i.note,rows:"4"})})]})}),r===He&&f(w,{form:o,name:"formUpdate",layout:"vertical",children:[e("div",{style:{marginBottom:12},children:f(V,{children:[i.collect_deposit,"?"]})}),(n==null?void 0:n.depositValue)>0?f(V,{children:[i.deposit_value,": ",e("strong",{style:{margin:"0 5px"},children:me(`${n==null?void 0:n.depositValue}`)}),i.vnd]}):e(F,{span:"24",children:e(w.Item,{name:"depositCollection",label:`${i.deposit_type} (${i.vnd})`,children:e(qe,{placeholder:i.deposit_type,min:0,onKeyPress:m,formatter:_=>me(_)})})})]}),r===We&&f(w,{initialValues:{refundValue:n==null?void 0:n.depositValue},form:o,name:"formUpdate",layout:"vertical",children:[e("div",{style:{marginBottom:12},children:f(V,{children:[i.refund_confirm_deposit,"?"]})}),f(F,{span:"24",children:[f(V,{style:{marginBottom:"15px"},children:[i.deposit_value,": ",e("strong",{style:{margin:"0 5px"},children:me(`${n==null?void 0:n.depositValue}`)}),i.vnd]}),e(w.Item,{name:"refundValue",rules:[{required:!0},{validator:async(_,y)=>n!=null&&n.depositValue&&y>(n==null?void 0:n.depositValue)?Promise.reject(i.refund_amount_must_be_less_than_deposit_amount):Promise.resolve()}],label:`${i.refund_type} (${i.vnd})`,children:e(qe,{placeholder:i.refund_type,min:0,onKeyPress:m,formatter:_=>me(_)})}),e(F,{span:"24",children:e(Rt,{message:i.refund_amount_must_be_less_than_deposit_amount,type:"warning",showIcon:!0,closable:!0})})]})]}),r===Ye&&f(w,{form:o,name:"formUpdate",layout:"vertical",children:[e("div",{style:{marginBottom:12},children:e(V,{children:i.do_you_want_to_cancel_this_registration_form})}),e(w.Item,{rules:[{required:!0}],name:"reason",label:i.reason,children:e(re.TextArea,{maxLength:"255",placeholder:i.reason,rows:"4"})})]})]})},rt=100,Oe=["#",i.registration_code,i.vehicle_card_type,i.register_type,i.registration_date,i.deposit_status,i.deposit_value,i.refund_value,i.apartment,i.resident,i.role],tn=()=>{const{hideFormExportCardRegistration:a,idBuilding:o,tableData:t,filter:r,status:n}=R.useContext(X),[d,m]=R.useState({isFetching:!1}),[u,g]=R.useState(0),_=async()=>{var A,I,M,P,T,O,U,H,Z,ee,ue,ge,fe,_e,N,L,Y,B,z,D,ye,Re,Te;m({isFetching:!0}),g(0);const y=[];let S=1;const p=t.totalRecord,c=Math.floor(p/rt)+1;let v=0;const{unitName:b,code:x,types:h,actions:s,createdAt:l}=r,k={unitName:b??void 0,code:x??void 0,types:h??void 0,actions:s??void 0,createdFrom:l!=null&&l[0]?G(l[0]).startOf("day").toISOString():void 0,createdTo:l!=null&&l[1]?G(l[1]).endOf("day").toISOString():void 0,status:n===he?void 0:n};for(await Zt({idBuilding:o,filter:{...k}});S<=c;){const ot=(await Tt({filter:{...k},limit:rt,page:S,idBuilding:o})).data;if(ot.length>0){const Pt=y.length;for(let je=0;je<ot.length;je+=1){const C=ot[je];let ne="",Fe="";[W,se,q].includes(n)&&(ne=(I=(A=C==null?void 0:C.changeStatusBy)==null?void 0:A[n])==null?void 0:I.time),n===ce&&((M=C==null?void 0:C.changeStatusBy)!=null&&M[W])&&(ne=(T=(P=C==null?void 0:C.changeStatusBy)==null?void 0:P[W])==null?void 0:T.time),[q].includes(n)&&(Fe=(U=(O=C==null?void 0:C.changeStatusBy)==null?void 0:O[n])==null?void 0:U.time,ne=(Z=(H=C==null?void 0:C.changeStatusBy)==null?void 0:H[W])==null?void 0:Z.time),[he].includes(n)&&(ne=(ue=(ee=C==null?void 0:C.changeStatusBy)==null?void 0:ee[W])==null?void 0:ue.time,Fe=(fe=(ge=C==null?void 0:C.changeStatusBy)==null?void 0:ge[q])==null?void 0:fe.time),n===he&&(ne=(N=(_e=C==null?void 0:C.changeStatusBy)==null?void 0:_e[W])==null?void 0:N.time,Fe=(Y=(L=C==null?void 0:C.changeStatusBy)==null?void 0:L[q])==null?void 0:Y.time);const $=[Pt+je+1];$.push((C==null?void 0:C.code)??""),$.push(((B=nt[C==null?void 0:C.type])==null?void 0:B.label)??""),$.push(((z=ze[C==null?void 0:C.action])==null?void 0:z.label)??""),$.push(C!=null&&C.createdAt?G(C==null?void 0:C.registrationDate).format(J):""),$.push(((D=Pe[C==null?void 0:C.depositStatus])==null?void 0:D.label)??""),$.push((C==null?void 0:C.depositValue)??""),$.push((C==null?void 0:C.refundValue)??""),$.push(((ye=C==null?void 0:C.unit)==null?void 0:ye.name)??""),$.push(((Re=C==null?void 0:C.resident)==null?void 0:Re.fullName)??""),$.push(((Te=C==null?void 0:C.requiredInfo)==null?void 0:Te.relationshipWithOwner)??""),n===ce&&($.push(ne?G(ne).format(le):""),$.push((C==null?void 0:C.reason)??"")),n===q&&($.push(ne?G(ne).format(le):""),$.push(Fe?G(Fe).format(le):"")),n===he&&($.push(ne?G(ne).format(le):""),$.push(Fe?G(Fe).format(le):""),$.push((C==null?void 0:C.reason)??"")),[W,se].includes(n)&&$.push(ne?G(ne).format(le):""),n===de&&$.push(""),y.push($)}S+=1;const Nt=rt/p*100;v+=Nt,g(Math.round(v))}else{S=0;break}}let E=[...Oe];n===ce&&(E=[...Oe,i.start_time,i.cancel_reason]),n===q&&(E=[...Oe,i.start_time,i.complete_at]),[W,se].includes(n)&&(E=[...Oe,i.start_time]),n===de&&(E=[...Oe]),n===he&&(E=[...Oe,i.start_time,i.complete_at,i.cancel_reason]),y.unshift(E),pi(y,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8",i.vehicle_card_registration_info,".xlsx"),m({isFetching:!1}),xt.success({message:i.success,description:i.export_data_success}),a()};return R.useEffect(()=>{_()},[]),{isFetchingExport:d.isFetching,percent:u}},nn=()=>{const{isFetchingExport:a,percent:o}=tn();return e(ke,{open:!0,okText:i.export,cancelText:i.cancel,okButtonProps:{isFetchingExport:a,disabled:a},footer:null,closable:!1,children:e(ci,{strokeColor:{from:"#108ee9",to:"#87d068"},percent:o,status:"active"})})},an=a=>{var u,g,_,y,S;const{id:o,employee:t,action:r,currentData:n,actionDate:d}=a;return{...a,id:o??"",creator:t!=null&&t.fullName?t==null?void 0:t.fullName:i.resident,cardType:n!=null&&n.type?(u=nt[n==null?void 0:n.type])==null?void 0:u.label:"",registerTypeColor:n!=null&&n.action?(g=ze[n==null?void 0:n.action])==null?void 0:g.color:"",registerType:n!=null&&n.action?(_=ze[n==null?void 0:n.action])==null?void 0:_.label:"",actionName:r!=null&&r.toLowerCase()?(y=Ei[r==null?void 0:r.toLowerCase()])==null?void 0:y.label:"",time:d?(S=G(d))==null?void 0:S.format(le):""}},on=async({idBuilding:a,cardRegistrationId:o,filter:t,limit:r,page:n})=>{try{const{code:d,data:m,codeLanguage:u}=await ei({idBuilding:a,cardRegistrationId:o,filter:t,limit:r,page:n});return{code:d,codeLanguage:u,data:m==null?void 0:m.map(g=>an(g))}}catch({code:d,codeLanguage:m}){return{code:d,codeLanguage:m,data:[]}}},rn=()=>{var p;const{formHistoryCardRegistration:a,hideFormHistoryCardRegistration:o,filter:t,idBuilding:r,dataHistory:n,setDataHistory:d}=R.useContext(X),[m,u]=R.useState({current:K,limit:ie}),[g,_]=R.useState({code:void 0,codeLanguage:void 0,isFetching:!1}),y=(p=a==null?void 0:a.data)==null?void 0:p.cardRegistration;R.useEffect(()=>{(async()=>{_({code:void 0,codeLanguage:void 0,isFetching:!0});const c=await on({idBuilding:r,cardRegistrationId:y==null?void 0:y.id,filter:t,limit:m.limit,page:m.current});d((c==null?void 0:c.data)??[]),u({current:K,limit:ie}),_({code:c.code,codeLanguage:c.codeLanguage,isFetching:!1})})()},[]);const S={scrollToFirstRowOnChange:!0};return{dataSource:n,totalRecord:n==null?void 0:n.length,hideFormHistoryCardRegistration:o,loading:g.isFetching,scroll:S}},vt=tt("div",{target:"e11ldddr0"})({name:"l8l8b8",styles:"white-space:nowrap;overflow:hidden;text-overflow:ellipsis"}),sn=()=>{const{hideFormHistoryCardRegistration:a,dataSource:o,loading:t,totalRecord:r,scroll:n}=rn(),d=[{title:i.the_operator,key:"creator",dataIndex:"creator",width:180,align:"left",fixed:"left",render:(m,u)=>(m==null?void 0:m.length)>20?e(be,{title:m,placement:"topLeft",children:e(vt,{children:m})}):e(vt,{children:m})},{title:i.operation,key:"actionName",dataIndex:"actionName",width:100,align:"left"},{title:i.time,key:"time",dataIndex:"time",width:150,align:"left"},{title:i.card_type,key:"cardType",dataIndex:"cardType",width:180,align:"left"},{title:i.register_type,key:"registerType",dataIndex:"registerType",width:170,align:"left",render:(m,u)=>u!=null&&u.registerType?e(Ke,{color:u==null?void 0:u.registerTypeColor,children:u==null?void 0:u.registerType}):null}];return f(ke,{title:i.history_card_registration,footer:null,open:!0,onCancel:a,width:"80%",children:[e(Ce.ActionBox,{total:r}),e(Vt,{loading:t,columns:d,dataSource:o,bordered:!0,pagination:!1,scroll:{...n,x:d.reduce((m,u)=>m+ +((u==null?void 0:u.width)??0),0)}})]})},ln=async a=>(await ai(a,{type:Ae})).data,cn=async a=>{const o={type:Ae,status:it},{data:t,code:r,codeLanguage:n}=await mi(o,a);return[t,r,n]},dn=()=>{const{idBuilding:a,cardRegistrationSetting:o,setSettingRegistrationForm:t}=R.useContext(X);return{changeDataFormSetting:async()=>{const n={...o},d=await ln(a);if(d!=null&&d.length){const m=d[0];n.status=m.status===Je,t(n)}else{const[m]=await cn(a);n.status=m.status===Je,t(n)}return t(d),d}}},un=()=>{const{setTitlePage:a,setVisibleFilterBox:o,setVisibleSearchBox:t}=R.useContext(wt),{formUpdateStatusData:r,formDetailCardRegistration:n,formAddCardRegistration:d,formConfigData:m,formUpdateData:u,idBuilding:g,cardRegistrationSetting:_,formUpdateStatusCardRegistration:y,formExportCardRegistration:S,formHistoryCardRegistration:p}=R.useContext(X),{changeDataTable:c}=at(),{changeDataFormSetting:v}=dn(),{getQueryParamsCardRegistration:b}=xe(),{search:x}=ii();return R.useEffect(()=>(a(i.card_registration_management),t(!0),()=>{a(""),o(!1),t(!1)}),[]),R.useEffect(()=>{(async()=>{if(g){let h={..._};if(!h.id){const E=await v();h=(E==null?void 0:E.find(I=>I.type===Ae))??{status:!1}}const{pagination:s,filter:l,status:k}=b();x&&await c({filter:{...l,status:k},limit:s.limit,page:s.page})}})()},[x]),{formConfigData:m,formUpdateData:u,formUpdateStatusData:r,isShowFormDetailCardRegistration:n.isShow,isShowFormAddCardRegistration:d.isShow,isShowFormUpdateStatusCardRegistration:y.isShow,isShowFormExportCardRegistration:S.isShow,isShowFormHistoryCardRegistration:p.isShow}},pn=()=>{const{isShowFormAddCardRegistration:a,isShowFormDetailCardRegistration:o,isShowFormUpdateStatusCardRegistration:t,isShowFormExportCardRegistration:r,isShowFormHistoryCardRegistration:n}=un();return f(we,{children:[f(Ce.Wrapper,{children:[e(Bi,{}),f(Ce.Container,{children:[e(Ce.Header,{children:e(Ni,{})}),f(Ce.Content,{children:[e(zi,{}),e(Gi,{})]})]})]}),a&&e(Xi,{}),o&&e(Wi,{}),t&&e(en,{}),r?e(nn,{}):null,n&&e(sn,{})]})},eo=()=>e(Ii,{children:e(pn,{})});export{eo as default};
