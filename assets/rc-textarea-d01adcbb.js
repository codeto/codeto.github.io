import{b as te,c as y,_ as ae,a as H,e as j,d as re,h as ne,i as ie,j as oe,k as le}from"./@babel-b64fd0f9.js";import{r as d}from"./react-4fd50329.js";import{R as ue}from"./rc-resize-observer-b9ad4e29.js";import{i as se,a as N,e as $}from"./rc-util-0bc219f3.js";import{c as de}from"./classnames-4ba1ba1a.js";var fe=`
  min-height:0 !important;
  max-height:none !important;
  height:0 !important;
  visibility:hidden !important;
  overflow:hidden !important;
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
  pointer-events: none !important;
`,ce=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing","word-break"],w={},s;function ve(t){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=t.getAttribute("id")||t.getAttribute("data-reactid")||t.getAttribute("name");if(g&&w[n])return w[n];var a=window.getComputedStyle(t),e=a.getPropertyValue("box-sizing")||a.getPropertyValue("-moz-box-sizing")||a.getPropertyValue("-webkit-box-sizing"),l=parseFloat(a.getPropertyValue("padding-bottom"))+parseFloat(a.getPropertyValue("padding-top")),r=parseFloat(a.getPropertyValue("border-bottom-width"))+parseFloat(a.getPropertyValue("border-top-width")),i=ce.map(function(o){return"".concat(o,":").concat(a.getPropertyValue(o))}).join(";"),v={sizingStyle:i,paddingSize:l,borderSize:r,boxSizing:e};return g&&n&&(w[n]=v),v}function ge(t){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;s||(s=document.createElement("textarea"),s.setAttribute("tab-index","-1"),s.setAttribute("aria-hidden","true"),document.body.appendChild(s)),t.getAttribute("wrap")?s.setAttribute("wrap",t.getAttribute("wrap")):s.removeAttribute("wrap");var e=ve(t,g),l=e.paddingSize,r=e.borderSize,i=e.boxSizing,v=e.sizingStyle;s.setAttribute("style","".concat(v,";").concat(fe)),s.value=t.value||t.placeholder||"";var o=void 0,f=void 0,S,c=s.scrollHeight;if(i==="border-box"?c+=r:i==="content-box"&&(c-=l),n!==null||a!==null){s.value=" ";var z=s.scrollHeight-l;n!==null&&(o=z*n,i==="border-box"&&(o=o+l+r),c=Math.max(o,c)),a!==null&&(f=z*a,i==="border-box"&&(f=f+l+r),S=c>f?"":"hidden",c=Math.min(f,c))}var b={height:c,overflowY:S,resize:"none"};return o&&(b.minHeight=o),f&&(b.maxHeight=f),b}var me=["prefixCls","onPressEnter","defaultValue","value","autoSize","onResize","className","style","disabled","onChange","onInternalAutoSize"],_=0,E=1,C=2,he=d.forwardRef(function(t,g){var n=t.prefixCls,a=n===void 0?"rc-textarea":n;t.onPressEnter;var e=t.defaultValue,l=t.value,r=t.autoSize,i=t.onResize,v=t.className,o=t.style,f=t.disabled,S=t.onChange;t.onInternalAutoSize;var c=te(t,me),z=se(e,{value:l,postState:function(u){return u??""}}),b=y(z,2),K=b[0],Y=b[1],L=function(u){Y(u.target.value),S==null||S(u)},m=d.useRef();d.useImperativeHandle(g,function(){return{textArea:m.current}});var Z=d.useMemo(function(){return r&&ae(r)==="object"?[r.minRows,r.maxRows]:[]},[r]),T=y(Z,2),V=T[0],P=T[1],x=!!r,G=function(){try{if(document.activeElement===m.current){var u=m.current,J=u.selectionStart,Q=u.selectionEnd,ee=u.scrollTop;m.current.setSelectionRange(J,Q),m.current.scrollTop=ee}}catch{}},X=d.useState(C),I=y(X,2),p=I[0],R=I[1],B=d.useState(),M=y(B,2),O=M[0],U=M[1],k=function(){R(_)};N(function(){x&&k()},[l,V,P,x]),N(function(){if(p===_)R(E);else if(p===E){var h=ge(m.current,!1,V,P);R(C),U(h)}else G()},[p]);var D=d.useRef(),F=function(){$.cancel(D.current)},W=function(u){p===C&&(i==null||i(u),r&&(F(),D.current=$(function(){k()})))};d.useEffect(function(){return F},[]);var q=x?O:null,A=H(H({},o),q);return(p===_||p===E)&&(A.overflowY="hidden",A.overflowX="hidden"),d.createElement(ue,{onResize:W,disabled:!(r||i)},d.createElement("textarea",j({},c,{ref:m,style:A,className:de(a,v,re({},"".concat(a,"-disabled"),f)),disabled:f,value:K,onChange:L})))}),Re=function(t){ne(n,t);var g=ie(n);function n(a){var e;oe(this,n),e=g.call(this,a),e.resizableTextArea=void 0,e.focus=function(){e.resizableTextArea.textArea.focus()},e.saveTextArea=function(r){e.resizableTextArea=r},e.handleChange=function(r){var i=e.props.onChange;e.setValue(r.target.value),i&&i(r)},e.handleKeyDown=function(r){var i=e.props,v=i.onPressEnter,o=i.onKeyDown;r.keyCode===13&&v&&v(r),o&&o(r)};var l=typeof a.value>"u"||a.value===null?a.defaultValue:a.value;return e.state={value:l},e}return le(n,[{key:"setValue",value:function(e,l){"value"in this.props||this.setState({value:e},l)}},{key:"blur",value:function(){this.resizableTextArea.textArea.blur()}},{key:"render",value:function(){return d.createElement(he,j({},this.props,{value:this.state.value,onKeyDown:this.handleKeyDown,onChange:this.handleChange,ref:this.saveTextArea}))}}],[{key:"getDerivedStateFromProps",value:function(e){return"value"in e?{value:e.value}:null}}]),n}(d.Component);export{Re as T};
