import{a as L,j as b}from"./@emotion-63839449.js";import{r as O}from"./react-4fd50329.js";import{P as l}from"./prop-types-1172f4d5.js";import{E as P}from"./@tinymce-4731cc9d.js";import"./lodash-88fe09e6.js";import"./moment-a468e1f9.js";import{l as m,c as $,e as w,g as f,t as h,L as d,j as S}from"./index-c2ded735.js";import"./file-saver-40cf32a9.js";const C=`${S}/upload`;function x(_){const{onChange:a,status:y,disabled:A,height:T,initialContent:p}=_,[E,n]=O.useState(p),v=(s,u)=>new Promise((e,i)=>{var g;const o=$.get(w),t=new XMLHttpRequest;t.withCredentials=!1,t.open("POST",C),t.setRequestHeader("Authorization",((g=o==null?void 0:o.user)==null?void 0:g.accessToken)??""),t.upload.onprogress=r=>{u(r.loaded/r.total*100)},t.onload=()=>{if(t.status===403&&i({message:`HTTP Error: ${t.status}`,remove:!0}),t.status<200||t.status>=300){i(`HTTP Error: ${t.status}`);return}const r=JSON.parse(t.responseText);if(!r||typeof r.data.url!="string"){i(`Invalid JSON: ${t.responseText}`);return}e(r.data.url)},t.onerror=()=>{i(`Image upload failed due to a XHR Transport error. Code: ${t.status}`)};const c=new FormData;c.append("file",s.blob(),s.filename()),t.send(c)}),k=(s,u)=>{let e=s;e=e.replaceAll("<tr>",'<tr style="border: 1px solid rgb(0, 0, 0);">'),e=e.replaceAll("<td>",'<td style="border: 1px solid rgb(0, 0, 0);">'),e=e.replaceAll('<tr style="','<tr style="border: 1px solid rgb(0, 0, 0); '),e=e.replaceAll('<td style="','<td style="border: 1px solid rgb(0, 0, 0); '),e=e.replaceAll('style="width','style="border: 1px solid rgb(0, 0, 0); width'),e=e.replaceAll("border-left: none;",""),e=e.replaceAll("border-top: none;",""),e=e==null?void 0:e.replaceAll("border: 1px solid rgb(0, 0, 0); border: 1px solid rgb(0, 0, 0);","border: 1px solid rgb(0, 0, 0);"),e=e==null?void 0:e.replaceAll(/margin:\s*-?(\d*\.?\d+)(?:pt|cm|in|px)\s*-?(\d*\.?\d+)(?:pt|cm|in|px)\s*-?(\d*\.?\d+)(?:pt|cm|in|px)\s*-?(\d*\.?\d+)(?:pt|cm|in|px);/g,""),e=e==null?void 0:e.replaceAll(/text-indent:\s*-?\d*\.?\d+(?:pt|cm|in|px);/g,""),e=e==null?void 0:e.replaceAll(/-[\d.]+(?:pt|cm|in|px);/g,"0px"),e=e.replace(/(<table[^>]*?\bstyle="[^"]*?)(width:\s*\d+(?:\.?\d*)?(?:pt|cm|in|px)\s*;[^"]*?")/g,"$1width: 100%"),e=e.replace(/(<table[^>]*?\bwidth\s*=\s*")([^"]*?)(")/g,"$1100%$3"),e?(n(e),a==null||a(e)):(n("<p></p>"),a==null||a("<p></p>"))};return L("div",{style:{position:"relative"},children:[b(P,{disabled:A,textareaName:"cyhome-editor",initialValue:p,value:E,init:{height:T,menubar:!1,plugins:["advlist","autolink","link","image","charmap","anchor","searchreplace","visualblocks","code","fullscreen","insertdatetime","media","help","wordcount","table","pagebreak","lists","preview"],toolbar:`preview | 
                    undo redo | styles | fontsize |
                    bold italic underline strikethrough | 
                    fontfamily fontsizeselect formatselect | 
                    forecolor backcolor | 
                    alignleft aligncenter alignright alignjustify | 
                    outdent indent | 
                    numlist bullist |
                    link image paste | 
                    table`,file_picker_types:"image media",block_unsupported_drop:!1,images_upload_handler:v,language:(()=>f()===h?h:f()===d?d:d)(),placeholder:m.label.editor_placeholder,statusbar:!0,branding:!1,paste_data_images:!0,table_use_colgroups:!0,table_default_attributes:{cellpadding:"0",cellspacing:"0"},table_default_styles:{"border-collapse":"collapse",width:"100%"}},onEditorChange:k}),y&&b("span",{className:"form-group__status",children:m.status.data_require},"labelStatus")]})}x.propTypes={onChange:l.func,status:l.string,disabled:l.bool,height:l.string,initialContent:l.string};x.defaultProps={onChange:()=>{},status:void 0,disabled:!1,height:void 0,initialContent:void 0};export{x as T};
